var le=Object.defineProperty;var de=(r,t,s)=>t in r?le(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;var S=(r,t,s)=>de(r,typeof t!="symbol"?t+"":t,s);import{r as h,j as e,a as ue,E as me,R as he}from"./codemirror-D8uxbU7w.js";import{r as fe,c as ge}from"./react-vendor-DHDEqpUy.js";import{A as re}from"./anthropic-DOVQwx1S.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();var q={},J=fe;q.createRoot=J.createRoot,q.hydrateRoot=J.hydrateRoot;const X="shaderlm-conversation",V=r=>{try{const t={messages:r.messages,currentShader:r.currentShader,vertexShader:r.vertexShader,shaderHistory:r.shaderHistory,lastUpdated:Date.now()};localStorage.setItem(X,JSON.stringify(t))}catch(t){console.error("Failed to save conversation to localStorage:",t)}},xe=()=>{try{const r=localStorage.getItem(X);if(!r)return null;const t=JSON.parse(r);return!t.messages||!Array.isArray(t.messages)?null:t}catch(r){return console.error("Failed to load conversation from localStorage:",r),null}},pe=()=>{try{localStorage.removeItem(X)}catch(r){console.error("Failed to clear conversation from localStorage:",r)}};let K=null;async function se(){if(K)return K;if(!navigator.gpu)throw new Error("WebGPU is not supported in this browser");const r=await navigator.gpu.requestAdapter();if(!r)throw new Error("Failed to get GPU adapter");const t=await r.requestDevice();return K=t,t}async function ye(r){try{const a=await(await se()).createShaderModule({code:r,label:"Validation Shader"}).getCompilationInfo(),n=a.messages.filter(l=>l.type==="error"),o=a.messages.filter(l=>l.type==="warning").map(l=>`Line ${l.lineNum}: ${l.message}`);if(n.length>0)return{success:!1,error:n.map(f=>`Line ${f.lineNum}: ${f.message}`).join(`
`),warnings:o.length>0?o:void 0};const i=ve(r);return{success:!0,warnings:o.length>0?o:void 0,metadata:i}}catch(t){return{success:!1,error:t instanceof Error?t.message:"Unknown validation error"}}}function ve(r){const t=r.match(/@(?:vertex|fragment|compute)\s+fn\s+(\w+)/),s=t?t[1]:"main",n=r.includes("@compute")?"compute":"render",o=/@group\((\d+)\)\s+@binding\((\d+)\)\s+var(?:<([^>]+)>)?\s+(\w+):\s*(\w+)/g,i=[];let l;for(;(l=o.exec(r))!==null;){const[,d,u,x,,j]=l;let v="uniform";x!=null&&x.includes("storage")?v="storage":j.includes("texture")?v="texture":j.includes("sampler")&&(v="sampler"),i.push({group:parseInt(d),binding:parseInt(u),type:v,visibility:"all"})}const f=/@location\((\d+)\)\s+(\w+):\s*([^,\)]+)/g,c=[];for(;(l=f.exec(r))!==null;)c.push({location:parseInt(l[1]),name:l[2],type:l[3].trim()});return{entryPoint:s,bindingLayout:i,usage:n,inputs:c.length>0?c:void 0}}function Q(){return{supported:"gpu"in navigator}}function ne(r){const t=[],s=r.match(/struct\s+Uniforms\s*\{([^}]+)\}/);if(!s)return t;const a=s[1],n=/(\w+):\s*(f32|i32|u32|vec2<f32>|vec3<f32>|vec4<f32>)\s*,?/g;let o;for(;(o=n.exec(a))!==null;){const i=o[1],l=o[2];if(i==="time"||i==="resolution")continue;const f=be(i,l);t.push(f)}return t}function be(r,t){const s=r.toLowerCase();if(t==="f32"||t==="i32"||t==="u32"){let a=1,n=0,o=10,i=.1;return s.includes("count")||s.includes("num")||s.includes("rows")||s.includes("columns")?(a=5,n=1,o=20,i=1):s.includes("speed")?(a=1,n=0,o=5,i=.1):s.includes("scale")?(a=1,n=.1,o=5,i=.1):s.includes("radius")||s.includes("size")?(a=.5,n=0,o=2,i=.05):(s.includes("intensity")||s.includes("strength"))&&(a=1,n=0,o=2,i=.1),{name:r,type:t,defaultValue:a,min:n,max:o,step:i}}return t==="vec2<f32>"?{name:r,type:t,defaultValue:[.5,.5],min:-2,max:2,step:.05}:t==="vec3<f32>"?{name:r,type:t,defaultValue:[1,1,1],min:0,max:1,step:.01}:t==="vec4<f32>"?{name:r,type:t,defaultValue:[1,1,1,1],min:0,max:1,step:.01}:{name:r,type:t,defaultValue:1,min:0,max:10,step:.1}}function we(r){const t=new Map;let s=0;t.set("time",0),s+=4,s=$(s,8),t.set("resolution",s),s+=8;for(const n of r){const{size:o,alignment:i}=je(n.type);s=$(s,i),t.set(n.name,s),s+=o}return{size:$(s,16),offsets:t}}function je(r){switch(r){case"f32":case"i32":case"u32":return{size:4,alignment:4};case"vec2<f32>":return{size:8,alignment:8};case"vec3<f32>":return{size:12,alignment:16};case"vec4<f32>":return{size:16,alignment:16};default:return{size:4,alignment:4}}}function $(r,t){return Math.ceil(r/t)*t}function Ne(r,t,s,a,n){const o=new Float32Array(n.size/4),i=n.offsets.get("time")/4;o[i]=r;const l=n.offsets.get("resolution")/4;o[l]=t[0],o[l+1]=t[1];for(const f of a){const c=n.offsets.get(f.name)/4,d=s[f.name]??f.defaultValue;if(Array.isArray(d))for(let u=0;u<d.length;u++)o[c+u]=d[u];else o[c]=d}return o}class Se{constructor(){S(this,"device",null);S(this,"context",null);S(this,"pipeline",null);S(this,"uniformBuffer",null);S(this,"bindGroup",null);S(this,"animationId",null);S(this,"startTime",0);S(this,"uniformFields",[]);S(this,"uniformLayout",null);S(this,"customUniformValues",{})}async initialize(t){this.device=await se();const s=t.getContext("webgpu");if(!s)throw new Error("Failed to get WebGPU context");this.context=s;const a=navigator.gpu.getPreferredCanvasFormat();s.configure({device:this.device,format:a,alphaMode:"premultiplied"})}async renderShader(t,s,a){if(!this.device||!this.context)throw new Error("Renderer not initialized");this.cleanup(),this.uniformFields=ne(s),this.uniformLayout=we(this.uniformFields),this.customUniformValues={},this.uniformFields.forEach(f=>{this.customUniformValues[f.name]=f.defaultValue});const n=this.device.createShaderModule({code:t,label:"Vertex Shader"}),o=this.device.createShaderModule({code:s,label:"Fragment Shader"});this.uniformBuffer=this.device.createBuffer({size:this.uniformLayout.size,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});const i=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}}]});this.bindGroup=this.device.createBindGroup({layout:i,entries:[{binding:0,resource:{buffer:this.uniformBuffer}}]});const l=this.device.createPipelineLayout({bindGroupLayouts:[i]});this.pipeline=this.device.createRenderPipeline({layout:l,vertex:{module:n,entryPoint:(a==null?void 0:a.entryPoint)||"vs_main"},fragment:{module:o,entryPoint:"fs_main",targets:[{format:navigator.gpu.getPreferredCanvasFormat()}]},primitive:{topology:"triangle-list"}}),this.startTime=Date.now(),this.startAnimation()}startAnimation(){const t=()=>{this.frame(),this.animationId=requestAnimationFrame(t)};t()}updateCustomUniforms(t){this.customUniformValues={...this.customUniformValues,...t}}frame(){if(!this.device||!this.context||!this.pipeline||!this.uniformBuffer||!this.bindGroup||!this.uniformLayout)return;const t=this.context.canvas,s=(Date.now()-this.startTime)/1e3,a=Ne(s,[t.width,t.height],this.customUniformValues,this.uniformFields,this.uniformLayout);this.device.queue.writeBuffer(this.uniformBuffer,0,a.buffer,a.byteOffset,a.byteLength);const n=this.device.createCommandEncoder(),o=this.context.getCurrentTexture().createView(),i=n.beginRenderPass({colorAttachments:[{view:o,clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});i.setPipeline(this.pipeline),i.setBindGroup(0,this.bindGroup),i.draw(3),i.end(),this.device.queue.submit([n.finish()])}cleanup(){this.animationId!==null&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.uniformBuffer&&(this.uniformBuffer.destroy(),this.uniformBuffer=null),this.pipeline=null,this.bindGroup=null}destroy(){this.cleanup(),this.device=null,this.context=null}}const Ce=`
@vertex
fn vs_main(@builtin(vertex_index) vertexIndex: u32) -> @builtin(position) vec4<f32> {
    // Full-screen triangle
    var pos = array<vec2<f32>, 3>(
        vec2<f32>(-1.0, -1.0),
        vec2<f32>(3.0, -1.0),
        vec2<f32>(-1.0, 3.0)
    );
    return vec4<f32>(pos[vertexIndex], 0.0, 1.0);
}
`,ke=()=>`${Date.now()}-${Math.random().toString(36).substring(2,9)}`,Z={messages:[],currentShader:"",vertexShader:Ce,isGenerating:!1,error:null,shaderHistory:[]},ae=ge(r=>({...Z,addMessage:t=>{const s={...t,id:ke(),timestamp:Date.now()};r(a=>{const n=[...a.messages,s];return V({messages:n,currentShader:a.currentShader,vertexShader:a.vertexShader,shaderHistory:a.shaderHistory}),{messages:n}})},updateLastMessage:t=>{r(s=>{const a=[...s.messages];return a.length>0&&(a[a.length-1]={...a[a.length-1],content:t}),V({messages:a,currentShader:s.currentShader,vertexShader:s.vertexShader,shaderHistory:s.shaderHistory}),{messages:a}})},setCurrentShader:(t,s)=>{r(a=>{const n=s?[...a.shaderHistory,{code:t,timestamp:Date.now(),messageId:s}]:a.shaderHistory;return V({messages:a.messages,currentShader:t,vertexShader:a.vertexShader,shaderHistory:n}),{currentShader:t,shaderHistory:n}})},setVertexShader:t=>{r(s=>(V({messages:s.messages,currentShader:s.currentShader,vertexShader:t,shaderHistory:s.shaderHistory}),{vertexShader:t}))},setIsGenerating:t=>{r({isGenerating:t})},setError:t=>{r({error:t})},clearConversation:()=>{pe(),r(Z)},loadFromStorage:()=>{const t=xe();t&&r({messages:t.messages,currentShader:t.currentShader,vertexShader:t.vertexShader,shaderHistory:t.shaderHistory})}})),Ee=["A colorful animated gradient","A pulsing circle with glow effect","Wavy water effect","Fractal noise pattern","Rotating rainbow spiral"];function Pe({onSendMessage:r,onOpenApiKeyDialog:t}){const[s,a]=h.useState(""),n=h.useRef(null),o=h.useRef(null),{messages:i,isGenerating:l,clearConversation:f}=ae(),c=()=>{var g;(g=n.current)==null||g.scrollIntoView({behavior:"smooth"})};h.useEffect(()=>{c()},[i]);const d=g=>{g.preventDefault(),s.trim()&&!l&&(r(s.trim()),a(""))},u=g=>{g.key==="Enter"&&(g.ctrlKey||g.metaKey)&&(g.preventDefault(),d(g))},x=g=>{var b;l||(a(g),(b=o.current)==null||b.focus())},j=g=>{navigator.clipboard.writeText(g)},v=g=>new Date(g).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),C=()=>{window.confirm("Are you sure you want to clear the conversation? This cannot be undone.")&&f()};return e.jsxs("div",{className:"flex flex-col h-full bg-gray-800 border-r border-gray-700",children:[e.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Shader Chat"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:t,className:"p-1.5 text-gray-400 hover:text-white hover:bg-gray-700 rounded transition-colors",title:"Edit API Key",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),i.length>0&&e.jsx("button",{onClick:C,className:"text-xs px-2 py-1 text-gray-400 hover:text-white hover:bg-gray-700 rounded transition-colors",title:"Clear conversation",children:"Clear"})]})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Describe shaders and refine them iteratively"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i.length===0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center text-gray-400 py-8",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),e.jsx("p",{className:"text-sm mb-2",children:"Start a conversation to generate a shader"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Try one of these examples:"})]}),e.jsx("div",{className:"space-y-2",children:Ee.map((g,b)=>e.jsx("button",{onClick:()=>x(g),disabled:l,className:"w-full text-left px-4 py-3 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed rounded-lg transition-colors text-sm",children:g},b))})]}):e.jsxs(e.Fragment,{children:[i.map(g=>{var b;return e.jsx("div",{className:`flex ${g.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[85%] rounded-lg px-4 py-2 ${g.role==="user"?"bg-blue-600 text-white":g.role==="system"?"bg-red-900 text-red-100":"bg-gray-700 text-gray-100"}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("div",{className:"flex-1 whitespace-pre-wrap break-words text-sm",children:g.content}),g.role==="assistant"&&e.jsx("button",{onClick:()=>j(g.content),className:"flex-shrink-0 text-gray-400 hover:text-white transition-colors",title:"Copy message",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),e.jsx("div",{className:"text-xs mt-1 opacity-70",children:v(g.timestamp)}),((b=g.metadata)==null?void 0:b.validationError)&&e.jsx("div",{className:"mt-2 p-2 bg-red-900/50 rounded text-xs font-mono",children:g.metadata.validationError})]})},g.id)}),l&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-gray-700 text-gray-100 rounded-lg px-4 py-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("span",{className:"text-sm text-gray-400",children:"Generating..."})]})})})]}),e.jsx("div",{ref:n})]}),e.jsx("div",{className:"flex-shrink-0 p-4 border-t border-gray-700",children:e.jsxs("form",{onSubmit:d,className:"space-y-2",children:[e.jsx("textarea",{ref:o,value:s,onChange:g=>a(g.target.value),onKeyDown:u,placeholder:i.length===0?"Describe the shader you want to create...":"Describe how to refine the shader...",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none text-white placeholder-gray-400 text-sm",rows:3,disabled:l}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Ctrl+Enter to send"}),e.jsx("button",{type:"submit",disabled:!s.trim()||l,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg font-medium transition-colors text-sm",children:l?"Generating...":"Send"})]})]})})]})}function Ae({shader:r,onChange:t,readOnly:s}){return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"bg-gray-800 px-4 py-2 border-b border-gray-700 flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-semibold",children:"Fragment Shader (WGSL)"}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(r)},className:"text-xs px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded transition-colors",disabled:!r,children:"Copy"})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx(ue,{value:r,height:"100%",theme:"dark",extensions:[me.lineWrapping],onChange:t,readOnly:s,basicSetup:{lineNumbers:!0,highlightActiveLineGutter:!0,highlightActiveLine:!0,foldGutter:!0,dropCursor:!0,indentOnInput:!0,syntaxHighlighting:!0,bracketMatching:!0,autocompletion:!0},placeholder:"Your generated shader will appear here...",className:"code-editor"})})]})}function Le({shader:r,vertexShader:t,customUniforms:s}){const a=h.useRef(null),n=h.useRef(null),[o,i]=h.useState(null),[l,f]=h.useState(!1);return h.useEffect(()=>{const c=a.current;return c?((async()=>{try{n.current||(n.current=new Se,await n.current.initialize(c))}catch(u){i(u instanceof Error?u.message:"Failed to initialize WebGPU")}})(),()=>{n.current&&(n.current.destroy(),n.current=null)}):void 0},[]),h.useEffect(()=>{if(!r||!n.current)return;(async()=>{i(null),f(!0);try{await n.current.renderShader(t,r)}catch(d){i(d instanceof Error?d.message:"Failed to render shader")}finally{f(!1)}})()},[r,t]),h.useEffect(()=>{s&&n.current&&n.current.updateCustomUniforms(s)},[s]),h.useEffect(()=>{const c=a.current;if(!c)return;const d=new ResizeObserver(u=>{for(const x of u){const{width:j,height:v}=x.contentRect;c.width=j*devicePixelRatio,c.height=v*devicePixelRatio}});return d.observe(c),()=>{d.disconnect()}},[]),e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("canvas",{ref:a,className:"w-full h-full",style:{imageRendering:"pixelated"}}),!r&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:e.jsx("p",{className:"text-gray-400",children:"Generate a shader to see preview"})}),l&&e.jsx("div",{className:"absolute top-4 right-4 bg-blue-600 text-white text-xs px-3 py-1 rounded-full",children:"Rendering..."}),o&&e.jsxs("div",{className:"absolute bottom-4 left-4 right-4 bg-red-900/90 border border-red-500 text-red-200 text-sm p-3 rounded",children:[e.jsx("strong",{children:"Render Error:"})," ",o]})]})}function Ie({shader:r,onValuesChange:t}){const[s,a]=h.useState([]),[n,o]=h.useState({});h.useEffect(()=>{const c=ne(r);a(c);const d={};c.forEach(u=>{d[u.name]=u.defaultValue}),o(d),c.length>0&&t(d)},[r,t]);const i=(c,d)=>{const u={...n,[c]:d};o(u),t(u)},l=(c,d)=>{const u=parseFloat(d);isNaN(u)||i(c,u)},f=(c,d,u)=>{const x=parseFloat(u);if(!isNaN(x)){const v=[...n[c]];v[d]=x,i(c,v)}};return s.length===0?null:e.jsxs("div",{className:"p-4 bg-gray-800 border-b border-gray-700",children:[e.jsx("h3",{className:"text-sm font-semibold mb-3 text-gray-200",children:"Shader Uniforms"}),e.jsx("div",{className:"space-y-3 max-h-48 overflow-y-auto",children:s.map(c=>e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-xs font-medium text-gray-300 capitalize",children:c.name.replace(/([A-Z])/g," $1").trim()}),(c.type==="f32"||c.type==="i32"||c.type==="u32")&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"range",min:c.min,max:c.max,step:c.step,value:n[c.name],onChange:d=>l(c.name,d.target.value),className:"flex-1 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500"}),e.jsx("input",{type:"number",min:c.min,max:c.max,step:c.step,value:n[c.name],onChange:d=>l(c.name,d.target.value),className:"w-16 px-2 py-1 text-xs bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),c.type==="vec2<f32>"&&e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["x","y"].map((d,u)=>e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:d}),e.jsx("input",{type:"number",min:c.min,max:c.max,step:c.step,value:n[c.name][u],onChange:x=>f(c.name,u,x.target.value),className:"w-full px-2 py-1 text-xs bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]},d))}),c.type==="vec3<f32>"&&e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["x","y","z"].map((d,u)=>e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:d}),e.jsx("input",{type:"number",min:c.min,max:c.max,step:c.step,value:n[c.name][u],onChange:x=>f(c.name,u,x.target.value),className:"w-full px-2 py-1 text-xs bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]},d))}),c.type==="vec4<f32>"&&e.jsx("div",{className:"grid grid-cols-4 gap-2",children:["x","y","z","w"].map((d,u)=>e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:d}),e.jsx("input",{type:"number",min:c.min,max:c.max,step:c.step,value:n[c.name][u],onChange:x=>f(c.name,u,x.target.value),className:"w-full px-2 py-1 text-xs bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]},d))})]},c.name))})]})}const Me="ShaderLM",De=1,N="projects";let O=null;async function F(){return O||new Promise((r,t)=>{const s=indexedDB.open(Me,De);s.onerror=()=>{t(new Error("Failed to open IndexedDB"))},s.onsuccess=()=>{O=s.result,r(O)},s.onupgradeneeded=a=>{const n=a.target.result;if(!n.objectStoreNames.contains(N)){const o=n.createObjectStore(N,{keyPath:"id",autoIncrement:!0});o.createIndex("name","name",{unique:!1}),o.createIndex("createdAt","createdAt",{unique:!1}),o.createIndex("updatedAt","updatedAt",{unique:!1})}}})}async function ee(r){const t=await F();return new Promise((s,a)=>{const o=t.transaction([N],"readwrite").objectStore(N),i={...r,updatedAt:Date.now()},l=o.add(i);l.onsuccess=()=>{s(l.result)},l.onerror=()=>{a(new Error("Failed to save project"))}})}async function Re(r){if(!r.id)throw new Error("Project ID is required for update");const t=await F();return new Promise((s,a)=>{const o=t.transaction([N],"readwrite").objectStore(N),i={...r,updatedAt:Date.now()},l=o.put(i);l.onsuccess=()=>{s()},l.onerror=()=>{a(new Error("Failed to update project"))}})}async function Ue(r){const t=await F();return new Promise((s,a)=>{const i=t.transaction([N],"readonly").objectStore(N).get(r);i.onsuccess=()=>{s(i.result||null)},i.onerror=()=>{a(new Error("Failed to load project"))}})}async function Fe(){const r=await F();return new Promise((t,s)=>{const o=r.transaction([N],"readonly").objectStore(N).getAll();o.onsuccess=()=>{const i=o.result||[];i.sort((l,f)=>f.updatedAt-l.updatedAt),t(i)},o.onerror=()=>{s(new Error("Failed to load projects"))}})}async function Ge(r){const t=await F();return new Promise((s,a)=>{const i=t.transaction([N],"readwrite").objectStore(N).delete(r);i.onsuccess=()=>{s()},i.onerror=()=>{a(new Error("Failed to delete project"))}})}function ze(r){return JSON.stringify(r,null,2)}function Ve(r){const t=JSON.parse(r),{id:s,...a}=t;if(!t.name||!t.shader||!t.messages)throw new Error("Invalid project format");return{...a,createdAt:Date.now(),updatedAt:Date.now()}}function Oe({isOpen:r,onClose:t,currentShader:s,currentVertexShader:a,currentMessages:n,currentUniforms:o,onLoadProject:i,currentProjectId:l}){const[f,c]=h.useState([]),[d,u]=h.useState(!1),[x,j]=h.useState(!1),[v,C]=h.useState(!1),[g,b]=h.useState(""),[M,P]=h.useState(""),[E,D]=h.useState("");h.useEffect(()=>{r&&k()},[r]);const k=async()=>{u(!0);try{const m=await Fe();c(m)}catch(m){console.error("Failed to load projects:",m)}finally{u(!1)}},W=async()=>{if(!g.trim()){alert("Please enter a project name");return}j(!0);try{const m={name:g.trim(),description:M.trim()||void 0,shader:s,vertexShader:a,messages:n,customUniforms:o,createdAt:Date.now(),updatedAt:Date.now()};l?await Re({...m,id:l}):await ee(m),C(!1),b(""),P(""),await k()}catch(m){console.error("Failed to save project:",m),alert("Failed to save project")}finally{j(!1)}},R=async m=>{try{const w=await Ue(m);w&&(i(w),t())}catch(w){console.error("Failed to load project:",w),alert("Failed to load project")}},_=async m=>{if(window.confirm("Are you sure you want to delete this project?"))try{await Ge(m),await k()}catch(w){console.error("Failed to delete project:",w),alert("Failed to delete project")}},B=m=>{const w=ze(m),U=new Blob([w],{type:"application/json"}),p=URL.createObjectURL(U),y=document.createElement("a");y.href=p,y.download=`${m.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.json`,y.click(),URL.revokeObjectURL(p)},T=()=>{const m=document.createElement("input");m.type="file",m.accept=".json",m.onchange=async w=>{var p;const U=(p=w.target.files)==null?void 0:p[0];if(U)try{const y=await U.text(),A=Ve(y);await ee(A),await k()}catch(y){console.error("Failed to import project:",y),alert("Failed to import project. Please check the file format.")}},m.click()},G=E?f.filter(m=>{var w;return m.name.toLowerCase().includes(E.toLowerCase())||((w=m.description)==null?void 0:w.toLowerCase().includes(E.toLowerCase()))}):f;return r?e.jsxs("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Project Manager"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-4 border-b border-gray-700 space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>C(!0),disabled:!s,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded font-medium transition-colors",children:"Save Current Project"}),e.jsx("button",{onClick:T,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded font-medium transition-colors",children:"Import"})]}),e.jsx("input",{type:"text",placeholder:"Search projects...",value:E,onChange:m=>D(m.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 text-white placeholder-gray-400"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:d?e.jsx("div",{className:"text-center text-gray-400 py-8",children:"Loading projects..."}):G.length===0?e.jsx("div",{className:"text-center text-gray-400 py-8",children:E?"No projects found":"No saved projects yet"}):e.jsx("div",{className:"space-y-3",children:G.map(m=>e.jsx("div",{className:"bg-gray-700 rounded-lg p-4 hover:bg-gray-600 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-white",children:m.name}),m.description&&e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:m.description}),e.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["Created: ",new Date(m.createdAt).toLocaleDateString()]}),e.jsxs("span",{children:["Updated: ",new Date(m.updatedAt).toLocaleDateString()]}),e.jsxs("span",{children:[m.messages.length," messages"]})]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("button",{onClick:()=>R(m.id),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-sm transition-colors",children:"Load"}),e.jsx("button",{onClick:()=>B(m),className:"px-3 py-1 bg-gray-800 hover:bg-gray-900 rounded text-sm transition-colors",title:"Export as JSON",children:"Export"}),e.jsx("button",{onClick:()=>_(m.id),className:"px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-sm transition-colors",children:"Delete"})]})]})},m.id))})})]}),v&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Save Project"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Project Name *"}),e.jsx("input",{type:"text",value:g,onChange:m=>b(m.target.value),placeholder:"My Awesome Shader",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 text-white placeholder-gray-400",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description (optional)"}),e.jsx("textarea",{value:M,onChange:m=>P(m.target.value),placeholder:"A beautiful animated gradient shader...",rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 text-white placeholder-gray-400 resize-none"})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{onClick:()=>{C(!1),b(""),P("")},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded font-medium transition-colors",children:"Cancel"}),e.jsx("button",{onClick:W,disabled:!g.trim()||x,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded font-medium transition-colors",children:x?"Saving...":"Save"})]})]})]})})]}):null}function te({onResize:r}){const t=h.useRef(!1),s=h.useRef(0);h.useEffect(()=>{const n=i=>{if(!t.current)return;const l=i.clientX-s.current;s.current=i.clientX,r(l)},o=()=>{t.current=!1,document.body.style.cursor="",document.body.style.userSelect=""};return document.addEventListener("mousemove",n),document.addEventListener("mouseup",o),()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",o)}},[r]);const a=n=>{t.current=!0,s.current=n.clientX,document.body.style.cursor="col-resize",document.body.style.userSelect="none",n.preventDefault()};return e.jsx("div",{onMouseDown:a,className:"w-1 bg-gray-700 hover:bg-blue-500 cursor-col-resize transition-colors flex-shrink-0 group relative",children:e.jsx("div",{className:"absolute inset-y-0 -left-1 -right-1"})})}const We=`You are an expert WebGPU shader developer specializing in WGSL (WebGPU Shading Language).

Key WGSL Rules:
- WGSL has STRICT typing with NO implicit conversions
- All functions must have explicit return types
- Entry points must use @vertex, @fragment, or @compute attributes
- Bindings use @group(N) @binding(M) decorations
- Built-in values use @builtin() attribute
- Workgroup size for compute: @workgroup_size(X, Y, Z)

Common WGSL Functions:
- Math: sin, cos, tan, sqrt, pow, abs, floor, ceil, round, clamp, mix, smoothstep
- Vector: dot, cross, length, normalize, distance, reflect
- Texture: textureSample, textureLoad, textureDimensions
- No function overloading - functions must have unique names

Type Syntax:
- Scalars: f32, i32, u32, bool
- Vectors: vec2<f32>, vec3<f32>, vec4<f32>
- Matrices: mat2x2<f32>, mat3x3<f32>, mat4x4<f32>
- Arrays: array<f32, 10> or array<f32>

IMPORTANT: Always use f32 literals with decimal point (e.g., 1.0, not 1)`,_e=`
Example 1: Simple Triangle Vertex + Fragment Shader
\`\`\`wgsl
@vertex
fn vs_main(@builtin(vertex_index) vertexIndex: u32) -> @builtin(position) vec4<f32> {
    var pos = array<vec2<f32>, 3>(
        vec2<f32>(0.0, 0.5),
        vec2<f32>(-0.5, -0.5),
        vec2<f32>(0.5, -0.5)
    );
    return vec4<f32>(pos[vertexIndex], 0.0, 1.0);
}

@fragment
fn fs_main() -> @location(0) vec4<f32> {
    return vec4<f32>(1.0, 0.0, 0.0, 1.0); // Red
}
\`\`\`

Example 2: Shader with Uniforms
\`\`\`wgsl
struct Uniforms {
    time: f32,
    resolution: vec2<f32>,
}

@group(0) @binding(0) var<uniform> uniforms: Uniforms;

@fragment
fn fs_main(@builtin(position) fragCoord: vec4<f32>) -> @location(0) vec4<f32> {
    let uv = fragCoord.xy / uniforms.resolution;
    let col = 0.5 + 0.5 * cos(uniforms.time + uv.xyx + vec3<f32>(0.0, 2.0, 4.0));
    return vec4<f32>(col, 1.0);
}
\`\`\`

Example 3: Compute Shader
\`\`\`wgsl
@group(0) @binding(0) var<storage, read_write> data: array<f32>;

@compute @workgroup_size(256)
fn cs_main(@builtin(global_invocation_id) global_id: vec3<u32>) {
    let index = global_id.x;
    data[index] = data[index] * 2.0;
}
\`\`\``;function Be(){return`${We}

${_e}

You are helping users create and iteratively refine WebGPU shaders through conversation.

When users request a shader:
1. Generate complete WGSL shader code in a \`\`\`wgsl code block
2. Provide a brief explanation of how it works
3. Include any JavaScript setup code needed (in a \`\`\`javascript block)

When users request refinements or modifications:
1. Understand what they want to change
2. Modify the existing shader accordingly
3. Provide the complete updated shader code
4. Explain what you changed and why

If a shader has validation errors:
- The user will share the error message with you
- Fix the issue and provide the corrected shader
- Explain what was wrong and how you fixed it

Available uniforms (automatically provided):
- time: f32 - current time in seconds
- resolution: vec2<f32> - canvas resolution (width, height)

You can add custom uniforms to the Uniforms struct for user-controllable parameters:
- The UI will automatically detect and create sliders for custom uniform fields
- Good examples: rows, columns, speed, scale, radius, intensity, etc.
- Users can adjust these values in real-time via the UI

Default context:
- A full-screen triangle vertex shader is provided automatically
- You typically only need to write fragment shaders
- Fragment shaders receive @builtin(position) fragCoord which is screen coordinates

Remember:
- Use explicit f32 types (1.0 not 1)
- No implicit type conversions
- Always provide complete, working shader code
- Be conversational and helpful in your explanations`}const oe="shaderlm_api_key",Te=365;function He(r,t,s){const a=new Date;a.setTime(a.getTime()+s*24*60*60*1e3);const n=`expires=${a.toUTCString()}`;document.cookie=`${r}=${t};${n};path=/;SameSite=Strict`}function Ke(r){const t=`${r}=`,s=document.cookie.split(";");for(let a of s){let n=a.trim();if(n.indexOf(t)===0)return n.substring(t.length)}return null}function Y(){return Ke(oe)}function $e(r){He(oe,r,Te)}let ie;function ce(r){const t=r||Y();if(!t)throw new Error("No API key available. Please set your Claude API key.");ie=new re({apiKey:t,dangerouslyAllowBrowser:!0})}function qe(r){ce(r)}async function Ye(r){try{return await new re({apiKey:r,dangerouslyAllowBrowser:!0}).messages.create({model:"claude-sonnet-4-20250514",max_tokens:10,messages:[{role:"user",content:"Hi"}]}),{valid:!0}}catch(t){return console.error("API key validation failed:",t),t instanceof Error?{valid:!1,error:t.message}:{valid:!1,error:"Unknown error occurred"}}}try{ce()}catch{console.warn("Claude client not initialized - API key required")}async function*Xe(r,t){try{const s=await ie.messages.create({model:"claude-sonnet-4-20250514",max_tokens:4e3,system:r,messages:t,stream:!0});for await(const a of s)a.type==="content_block_delta"&&a.delta.type==="text_delta"&&(yield a.delta.text)}catch(s){throw console.error("Error in conversational shader generation:",s),new Error(`Failed to generate shader: ${s instanceof Error?s.message:"Unknown error"}`)}}function Je({isOpen:r,onClose:t,allowCancel:s=!1}){const[a,n]=h.useState(""),[o,i]=h.useState(!1),[l,f]=h.useState(null),c=async()=>{if(!a.trim()){f("Please enter an API key");return}i(!0),f(null);try{const x=await Ye(a.trim());x.valid?($e(a.trim()),qe(a.trim()),n(""),t()):f(x.error||"Invalid API key. Please check and try again.")}catch(x){f("Failed to validate API key. Please try again."),console.error("API key validation error:",x)}finally{i(!1)}},d=()=>{s&&(n(""),f(null),t())},u=x=>{x.key==="Enter"&&!o&&c()};return r?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Enter Claude API Key"}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Your API key will be stored securely in your browser cookies. Get your key from"," ",e.jsx("a",{href:"https://console.anthropic.com/settings/keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:"Anthropic Console"}),"."]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"apiKey",className:"block text-sm font-medium text-gray-300 mb-2",children:"API Key"}),e.jsx("input",{id:"apiKey",type:"password",value:a,onChange:x=>n(x.target.value),onKeyPress:u,placeholder:"sk-ant-...",disabled:o,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed"})]}),l&&e.jsx("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-700 rounded-md",children:e.jsx("p",{className:"text-red-200 text-sm",children:l})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[s&&e.jsx("button",{onClick:d,disabled:o,className:"px-4 py-2 bg-gray-700 text-white rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Cancel"}),e.jsx("button",{onClick:c,disabled:o||!a.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{children:"Validating..."})]}):"Save"})]})]})}):null}async function Qe(r){const t=r.match(/```wgsl\n([\s\S]*?)```/),s=t?t[1].trim():"",a=r.replace(/```[\s\S]*?```/g,"").trim();if(!s)return{shader:"",isValid:!1,error:"No shader code found in response",explanation:a};const n=await ye(s);return{shader:s,isValid:n.success,error:n.error,explanation:a}}function Ze(){const{currentShader:r,vertexShader:t,isGenerating:s,messages:a,setCurrentShader:n,setVertexShader:o,setIsGenerating:i,setError:l,addMessage:f,updateLastMessage:c,loadFromStorage:d,clearConversation:u}=ae(),[x,j]=h.useState({}),[v,C]=h.useState(!1),[g,b]=h.useState(),[M,P]=h.useState(),[E,D]=h.useState(!1),[k,W]=h.useState(()=>{const p=localStorage.getItem("chatWidth");return p?parseInt(p,10):384}),[R,_]=h.useState(()=>{const p=localStorage.getItem("editorWidth");return p?parseInt(p,10):500});h.useEffect(()=>{Y()||D(!0)},[]),h.useEffect(()=>{d()},[d]),h.useEffect(()=>{localStorage.setItem("chatWidth",k.toString())},[k]),h.useEffect(()=>{localStorage.setItem("editorWidth",R.toString())},[R]),h.useEffect(()=>{Q().supported||l("WebGPU is not supported in your browser")},[l]);const B=h.useCallback(p=>{u(),n(p.shader),p.vertexShader&&o(p.vertexShader),p.messages.forEach(y=>{f({role:y.role,content:y.content,metadata:y.metadata})}),p.customUniforms&&j(p.customUniforms),b(p.id),P(p.name)},[u,n,o,f]),T=()=>{r&&!window.confirm("Starting a new project will clear the current conversation. Are you sure?")||(u(),b(void 0),P(void 0),j({}))},G=p=>{W(y=>Math.max(250,Math.min(800,y+p)))},m=p=>{_(y=>Math.max(300,Math.min(1e3,y+p)))},w=async p=>{var y;f({role:"user",content:p}),i(!0),l(null);try{const A=[...a.filter(I=>I.role!=="system").map(I=>({role:I.role,content:I.content})),{role:"user",content:p}],z=Be();f({role:"assistant",content:""});let H="";for await(const I of Xe(z,A))H+=I,c(H);const L=await Qe(H);L.shader&&(n(L.shader,(y=a[a.length-1])==null?void 0:y.id),!L.isValid&&L.error&&f({role:"system",content:`Validation Error: ${L.error}`,metadata:{validationError:L.error}}))}catch(A){const z=A instanceof Error?A.message:"Unknown error";l(z),f({role:"system",content:`Error: ${z}`})}finally{i(!1)}};return Q().supported?e.jsxs("div",{className:"h-screen flex flex-col bg-gray-900 text-white",children:[e.jsx("header",{className:"bg-gray-800 border-b border-gray-700 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"WebGPU Shader Generator"}),e.jsxs("p",{className:"text-sm text-gray-400",children:["AI-powered iterative WGSL shader creation",M&&e.jsxs("span",{className:"ml-2 text-blue-400",children:["â€¢ ",M]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:T,className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded text-sm font-medium transition-colors",title:"New Project",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),e.jsxs("button",{onClick:()=>C(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded text-sm font-medium transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"})}),"Projects"]})]})]})}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx("div",{style:{width:`${k}px`},className:"flex-shrink-0 flex flex-col",children:e.jsx(Pe,{onSendMessage:w,onOpenApiKeyDialog:()=>D(!0)})}),e.jsx(te,{onResize:G}),e.jsx("div",{style:{width:`${R}px`},className:"flex-shrink-0 flex flex-col",children:e.jsx(Ae,{shader:r,onChange:n,readOnly:s})}),e.jsx(te,{onResize:m}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(Ie,{shader:r,onValuesChange:j}),e.jsx("div",{className:"flex-1 p-4 overflow-hidden",children:e.jsx("div",{className:"h-full bg-black rounded-lg overflow-hidden",children:e.jsx(Le,{shader:r,vertexShader:t,customUniforms:x})})})]})]}),e.jsx("footer",{className:"bg-gray-800 border-t border-gray-700 p-2 text-center text-xs text-gray-400",children:"Powered by Claude & WebGPU | Chat to iteratively refine your shader"}),e.jsx(Oe,{isOpen:v,onClose:()=>C(!1),currentShader:r,currentVertexShader:t,currentMessages:a,currentUniforms:x,onLoadProject:B,currentProjectId:g}),e.jsx(Je,{isOpen:E,onClose:()=>D(!1),allowCancel:Y()!==null})]}):e.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-900",children:e.jsxs("div",{className:"text-center p-8 bg-red-900/20 border border-red-500 rounded-lg max-w-md",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-400 mb-4",children:"WebGPU Not Supported"}),e.jsx("p",{className:"text-gray-300",children:"Your browser doesn't support WebGPU. Please use Chrome 113+ or Edge 113+."})]})})}q.createRoot(document.getElementById("root")).render(e.jsx(he.StrictMode,{children:e.jsx(Ze,{})}));
