var jS=Object.defineProperty;var FS=(t,e,n)=>e in t?jS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Kt=(t,e,n)=>FS(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Z0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ey={exports:{}},mu={},ty={exports:{}},Q={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lo=Symbol.for("react.element"),zS=Symbol.for("react.portal"),WS=Symbol.for("react.fragment"),VS=Symbol.for("react.strict_mode"),HS=Symbol.for("react.profiler"),US=Symbol.for("react.provider"),$S=Symbol.for("react.context"),KS=Symbol.for("react.forward_ref"),qS=Symbol.for("react.suspense"),GS=Symbol.for("react.memo"),XS=Symbol.for("react.lazy"),Op=Symbol.iterator;function YS(t){return t===null||typeof t!="object"?null:(t=Op&&t[Op]||t["@@iterator"],typeof t=="function"?t:null)}var ny={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ry=Object.assign,iy={};function es(t,e,n){this.props=t,this.context=e,this.refs=iy,this.updater=n||ny}es.prototype.isReactComponent={};es.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};es.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function sy(){}sy.prototype=es.prototype;function sd(t,e,n){this.props=t,this.context=e,this.refs=iy,this.updater=n||ny}var od=sd.prototype=new sy;od.constructor=sd;ry(od,es.prototype);od.isPureReactComponent=!0;var Rp=Array.isArray,oy=Object.prototype.hasOwnProperty,ld={current:null},ly={key:!0,ref:!0,__self:!0,__source:!0};function ay(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)oy.call(e,r)&&!ly.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Lo,type:t,key:s,ref:o,props:i,_owner:ld.current}}function QS(t,e){return{$$typeof:Lo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ad(t){return typeof t=="object"&&t!==null&&t.$$typeof===Lo}function JS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Np=/\/+/g;function Gu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?JS(""+t.key):e.toString(36)}function Gl(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Lo:case zS:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Gu(o,0):r,Rp(i)?(n="",t!=null&&(n=t.replace(Np,"$&/")+"/"),Gl(i,e,n,"",function(u){return u})):i!=null&&(ad(i)&&(i=QS(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Np,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Rp(t))for(var l=0;l<t.length;l++){s=t[l];var a=r+Gu(s,l);o+=Gl(s,e,n,a,i)}else if(a=YS(t),typeof a=="function")for(t=a.call(t),l=0;!(s=t.next()).done;)s=s.value,a=r+Gu(s,l++),o+=Gl(s,e,n,a,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Yo(t,e,n){if(t==null)return t;var r=[],i=0;return Gl(t,r,"","",function(s){return e.call(n,s,i++)}),r}function ZS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ot={current:null},Xl={transition:null},ek={ReactCurrentDispatcher:ot,ReactCurrentBatchConfig:Xl,ReactCurrentOwner:ld};function uy(){throw Error("act(...) is not supported in production builds of React.")}Q.Children={map:Yo,forEach:function(t,e,n){Yo(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Yo(t,function(){e++}),e},toArray:function(t){return Yo(t,function(e){return e})||[]},only:function(t){if(!ad(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Q.Component=es;Q.Fragment=WS;Q.Profiler=HS;Q.PureComponent=sd;Q.StrictMode=VS;Q.Suspense=qS;Q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ek;Q.act=uy;Q.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=ry({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=ld.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(a in e)oy.call(e,a)&&!ly.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Lo,type:t.type,key:i,ref:s,props:r,_owner:o}};Q.createContext=function(t){return t={$$typeof:$S,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:US,_context:t},t.Consumer=t};Q.createElement=ay;Q.createFactory=function(t){var e=ay.bind(null,t);return e.type=t,e};Q.createRef=function(){return{current:null}};Q.forwardRef=function(t){return{$$typeof:KS,render:t}};Q.isValidElement=ad;Q.lazy=function(t){return{$$typeof:XS,_payload:{_status:-1,_result:t},_init:ZS}};Q.memo=function(t,e){return{$$typeof:GS,type:t,compare:e===void 0?null:e}};Q.startTransition=function(t){var e=Xl.transition;Xl.transition={};try{t()}finally{Xl.transition=e}};Q.unstable_act=uy;Q.useCallback=function(t,e){return ot.current.useCallback(t,e)};Q.useContext=function(t){return ot.current.useContext(t)};Q.useDebugValue=function(){};Q.useDeferredValue=function(t){return ot.current.useDeferredValue(t)};Q.useEffect=function(t,e){return ot.current.useEffect(t,e)};Q.useId=function(){return ot.current.useId()};Q.useImperativeHandle=function(t,e,n){return ot.current.useImperativeHandle(t,e,n)};Q.useInsertionEffect=function(t,e){return ot.current.useInsertionEffect(t,e)};Q.useLayoutEffect=function(t,e){return ot.current.useLayoutEffect(t,e)};Q.useMemo=function(t,e){return ot.current.useMemo(t,e)};Q.useReducer=function(t,e,n){return ot.current.useReducer(t,e,n)};Q.useRef=function(t){return ot.current.useRef(t)};Q.useState=function(t){return ot.current.useState(t)};Q.useSyncExternalStore=function(t,e,n){return ot.current.useSyncExternalStore(t,e,n)};Q.useTransition=function(){return ot.current.useTransition()};Q.version="18.3.1";ty.exports=Q;var W=ty.exports;const cy=Z0(W);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tk=W,nk=Symbol.for("react.element"),rk=Symbol.for("react.fragment"),ik=Object.prototype.hasOwnProperty,sk=tk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ok={key:!0,ref:!0,__self:!0,__source:!0};function hy(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)ik.call(e,r)&&!ok.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:nk,type:t,key:s,ref:o,props:i,_owner:sk.current}}mu.Fragment=rk;mu.jsx=hy;mu.jsxs=hy;ey.exports=mu;var S=ey.exports,ch={},fy={exports:{}},At={},dy={exports:{}},py={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(T,L){var z=T.length;T.push(L);e:for(;0<z;){var K=z-1>>>1,q=T[K];if(0<i(q,L))T[K]=L,T[z]=q,z=K;else break e}}function n(T){return T.length===0?null:T[0]}function r(T){if(T.length===0)return null;var L=T[0],z=T.pop();if(z!==L){T[0]=z;e:for(var K=0,q=T.length,Je=q>>>1;K<Je;){var Ze=2*(K+1)-1,on=T[Ze],Pt=Ze+1,Er=T[Pt];if(0>i(on,z))Pt<q&&0>i(Er,on)?(T[K]=Er,T[Pt]=z,K=Pt):(T[K]=on,T[Ze]=z,K=Ze);else if(Pt<q&&0>i(Er,z))T[K]=Er,T[Pt]=z,K=Pt;else break e}}return L}function i(T,L){var z=T.sortIndex-L.sortIndex;return z!==0?z:T.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var a=[],u=[],c=1,h=null,f=3,d=!1,p=!1,y=!1,w=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(T){for(var L=n(u);L!==null;){if(L.callback===null)r(u);else if(L.startTime<=T)r(u),L.sortIndex=L.expirationTime,e(a,L);else break;L=n(u)}}function x(T){if(y=!1,v(T),!p)if(n(a)!==null)p=!0,U(k);else{var L=n(u);L!==null&&X(x,L.startTime-T)}}function k(T,L){p=!1,y&&(y=!1,m(E),E=-1),d=!0;var z=f;try{for(v(L),h=n(a);h!==null&&(!(h.expirationTime>L)||T&&!V());){var K=h.callback;if(typeof K=="function"){h.callback=null,f=h.priorityLevel;var q=K(h.expirationTime<=L);L=t.unstable_now(),typeof q=="function"?h.callback=q:h===n(a)&&r(a),v(L)}else r(a);h=n(a)}if(h!==null)var Je=!0;else{var Ze=n(u);Ze!==null&&X(x,Ze.startTime-L),Je=!1}return Je}finally{h=null,f=z,d=!1}}var b=!1,C=null,E=-1,O=5,N=-1;function V(){return!(t.unstable_now()-N<O)}function j(){if(C!==null){var T=t.unstable_now();N=T;var L=!0;try{L=C(!0,T)}finally{L?D():(b=!1,C=null)}}else b=!1}var D;if(typeof g=="function")D=function(){g(j)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,Y=H.port2;H.port1.onmessage=j,D=function(){Y.postMessage(null)}}else D=function(){w(j,0)};function U(T){C=T,b||(b=!0,D())}function X(T,L){E=w(function(){T(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(T){T.callback=null},t.unstable_continueExecution=function(){p||d||(p=!0,U(k))},t.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<T?Math.floor(1e3/T):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(a)},t.unstable_next=function(T){switch(f){case 1:case 2:case 3:var L=3;break;default:L=f}var z=f;f=L;try{return T()}finally{f=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(T,L){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var z=f;f=T;try{return L()}finally{f=z}},t.unstable_scheduleCallback=function(T,L,z){var K=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?K+z:K):z=K,T){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=z+q,T={id:c++,callback:L,priorityLevel:T,startTime:z,expirationTime:q,sortIndex:-1},z>K?(T.sortIndex=z,e(u,T),n(a)===null&&T===n(u)&&(y?(m(E),E=-1):y=!0,X(x,z-K))):(T.sortIndex=q,e(a,T),p||d||(p=!0,U(k))),T},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(T){var L=f;return function(){var z=f;f=L;try{return T.apply(this,arguments)}finally{f=z}}}})(py);dy.exports=py;var lk=dy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ak=W,Mt=lk;function P(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var my=new Set,eo={};function ei(t,e){ji(t,e),ji(t+"Capture",e)}function ji(t,e){for(eo[t]=e,t=0;t<e.length;t++)my.add(e[t])}var _n=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hh=Object.prototype.hasOwnProperty,uk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Lp={},Bp={};function ck(t){return hh.call(Bp,t)?!0:hh.call(Lp,t)?!1:uk.test(t)?Bp[t]=!0:(Lp[t]=!0,!1)}function hk(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function fk(t,e,n,r){if(e===null||typeof e>"u"||hk(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function lt(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var ze={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ze[t]=new lt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ze[e]=new lt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ze[t]=new lt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ze[t]=new lt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ze[t]=new lt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ze[t]=new lt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ze[t]=new lt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ze[t]=new lt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ze[t]=new lt(t,5,!1,t.toLowerCase(),null,!1,!1)});var ud=/[\-:]([a-z])/g;function cd(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ud,cd);ze[e]=new lt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ud,cd);ze[e]=new lt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ud,cd);ze[e]=new lt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ze[t]=new lt(t,1,!1,t.toLowerCase(),null,!1,!1)});ze.xlinkHref=new lt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ze[t]=new lt(t,1,!1,t.toLowerCase(),null,!0,!0)});function hd(t,e,n,r){var i=ze.hasOwnProperty(e)?ze[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(fk(e,n,i,r)&&(n=null),r||i===null?ck(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Hn=ak.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qo=Symbol.for("react.element"),ci=Symbol.for("react.portal"),hi=Symbol.for("react.fragment"),fd=Symbol.for("react.strict_mode"),fh=Symbol.for("react.profiler"),gy=Symbol.for("react.provider"),yy=Symbol.for("react.context"),dd=Symbol.for("react.forward_ref"),dh=Symbol.for("react.suspense"),ph=Symbol.for("react.suspense_list"),pd=Symbol.for("react.memo"),Gn=Symbol.for("react.lazy"),vy=Symbol.for("react.offscreen"),_p=Symbol.iterator;function os(t){return t===null||typeof t!="object"?null:(t=_p&&t[_p]||t["@@iterator"],typeof t=="function"?t:null)}var xe=Object.assign,Xu;function Ps(t){if(Xu===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Xu=e&&e[1]||""}return`
`+Xu+t}var Yu=!1;function Qu(t,e){if(!t||Yu)return"";Yu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var a=`
`+i[o].replace(" at new "," at ");return t.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",t.displayName)),a}while(1<=o&&0<=l);break}}}finally{Yu=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ps(t):""}function dk(t){switch(t.tag){case 5:return Ps(t.type);case 16:return Ps("Lazy");case 13:return Ps("Suspense");case 19:return Ps("SuspenseList");case 0:case 2:case 15:return t=Qu(t.type,!1),t;case 11:return t=Qu(t.type.render,!1),t;case 1:return t=Qu(t.type,!0),t;default:return""}}function mh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case hi:return"Fragment";case ci:return"Portal";case fh:return"Profiler";case fd:return"StrictMode";case dh:return"Suspense";case ph:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case yy:return(t.displayName||"Context")+".Consumer";case gy:return(t._context.displayName||"Context")+".Provider";case dd:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case pd:return e=t.displayName||null,e!==null?e:mh(t.type)||"Memo";case Gn:e=t._payload,t=t._init;try{return mh(t(e))}catch{}}return null}function pk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mh(e);case 8:return e===fd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function gr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function wy(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function mk(t){var e=wy(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Jo(t){t._valueTracker||(t._valueTracker=mk(t))}function xy(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=wy(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ga(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gh(t,e){var n=e.checked;return xe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ip(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=gr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Sy(t,e){e=e.checked,e!=null&&hd(t,"checked",e,!1)}function yh(t,e){Sy(t,e);var n=gr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?vh(t,e.type,n):e.hasOwnProperty("defaultValue")&&vh(t,e.type,gr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function jp(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function vh(t,e,n){(e!=="number"||ga(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ds=Array.isArray;function Mi(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+gr(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function wh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(P(91));return xe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Fp(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(P(92));if(Ds(n)){if(1<n.length)throw Error(P(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:gr(n)}}function ky(t,e){var n=gr(e.value),r=gr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function zp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function by(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?by(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Zo,Cy=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Zo=Zo||document.createElement("div"),Zo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Zo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function to(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Is={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gk=["Webkit","ms","Moz","O"];Object.keys(Is).forEach(function(t){gk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Is[e]=Is[t]})});function My(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Is.hasOwnProperty(t)&&Is[t]?(""+e).trim():e+"px"}function Ay(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=My(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var yk=xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sh(t,e){if(e){if(yk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(P(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(P(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(P(61))}if(e.style!=null&&typeof e.style!="object")throw Error(P(62))}}function kh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bh=null;function md(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ch=null,Ai=null,Ei=null;function Wp(t){if(t=Io(t)){if(typeof Ch!="function")throw Error(P(280));var e=t.stateNode;e&&(e=xu(e),Ch(t.stateNode,t.type,e))}}function Ey(t){Ai?Ei?Ei.push(t):Ei=[t]:Ai=t}function Py(){if(Ai){var t=Ai,e=Ei;if(Ei=Ai=null,Wp(t),e)for(t=0;t<e.length;t++)Wp(e[t])}}function Dy(t,e){return t(e)}function Ty(){}var Ju=!1;function Oy(t,e,n){if(Ju)return t(e,n);Ju=!0;try{return Dy(t,e,n)}finally{Ju=!1,(Ai!==null||Ei!==null)&&(Ty(),Py())}}function no(t,e){var n=t.stateNode;if(n===null)return null;var r=xu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(P(231,e,typeof n));return n}var Mh=!1;if(_n)try{var ls={};Object.defineProperty(ls,"passive",{get:function(){Mh=!0}}),window.addEventListener("test",ls,ls),window.removeEventListener("test",ls,ls)}catch{Mh=!1}function vk(t,e,n,r,i,s,o,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var js=!1,ya=null,va=!1,Ah=null,wk={onError:function(t){js=!0,ya=t}};function xk(t,e,n,r,i,s,o,l,a){js=!1,ya=null,vk.apply(wk,arguments)}function Sk(t,e,n,r,i,s,o,l,a){if(xk.apply(this,arguments),js){if(js){var u=ya;js=!1,ya=null}else throw Error(P(198));va||(va=!0,Ah=u)}}function ti(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ry(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Vp(t){if(ti(t)!==t)throw Error(P(188))}function kk(t){var e=t.alternate;if(!e){if(e=ti(t),e===null)throw Error(P(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Vp(i),t;if(s===r)return Vp(i),e;s=s.sibling}throw Error(P(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(P(189))}}if(n.alternate!==r)throw Error(P(190))}if(n.tag!==3)throw Error(P(188));return n.stateNode.current===n?t:e}function Ny(t){return t=kk(t),t!==null?Ly(t):null}function Ly(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Ly(t);if(e!==null)return e;t=t.sibling}return null}var By=Mt.unstable_scheduleCallback,Hp=Mt.unstable_cancelCallback,bk=Mt.unstable_shouldYield,Ck=Mt.unstable_requestPaint,be=Mt.unstable_now,Mk=Mt.unstable_getCurrentPriorityLevel,gd=Mt.unstable_ImmediatePriority,_y=Mt.unstable_UserBlockingPriority,wa=Mt.unstable_NormalPriority,Ak=Mt.unstable_LowPriority,Iy=Mt.unstable_IdlePriority,gu=null,Sn=null;function Ek(t){if(Sn&&typeof Sn.onCommitFiberRoot=="function")try{Sn.onCommitFiberRoot(gu,t,void 0,(t.current.flags&128)===128)}catch{}}var Jt=Math.clz32?Math.clz32:Tk,Pk=Math.log,Dk=Math.LN2;function Tk(t){return t>>>=0,t===0?32:31-(Pk(t)/Dk|0)|0}var el=64,tl=4194304;function Ts(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function xa(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=Ts(l):(s&=o,s!==0&&(r=Ts(s)))}else o=n&~i,o!==0?r=Ts(o):s!==0&&(r=Ts(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Jt(e),i=1<<n,r|=t[n],e&=~i;return r}function Ok(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rk(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Jt(s),l=1<<o,a=i[o];a===-1?(!(l&n)||l&r)&&(i[o]=Ok(l,e)):a<=e&&(t.expiredLanes|=l),s&=~l}}function Eh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function jy(){var t=el;return el<<=1,!(el&4194240)&&(el=64),t}function Zu(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Bo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Jt(e),t[e]=n}function Nk(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Jt(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function yd(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Jt(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var oe=0;function Fy(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var zy,vd,Wy,Vy,Hy,Ph=!1,nl=[],lr=null,ar=null,ur=null,ro=new Map,io=new Map,Jn=[],Lk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Up(t,e){switch(t){case"focusin":case"focusout":lr=null;break;case"dragenter":case"dragleave":ar=null;break;case"mouseover":case"mouseout":ur=null;break;case"pointerover":case"pointerout":ro.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":io.delete(e.pointerId)}}function as(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Io(e),e!==null&&vd(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Bk(t,e,n,r,i){switch(e){case"focusin":return lr=as(lr,t,e,n,r,i),!0;case"dragenter":return ar=as(ar,t,e,n,r,i),!0;case"mouseover":return ur=as(ur,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return ro.set(s,as(ro.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,io.set(s,as(io.get(s)||null,t,e,n,r,i)),!0}return!1}function Uy(t){var e=Lr(t.target);if(e!==null){var n=ti(e);if(n!==null){if(e=n.tag,e===13){if(e=Ry(n),e!==null){t.blockedOn=e,Hy(t.priority,function(){Wy(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Yl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Dh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);bh=r,n.target.dispatchEvent(r),bh=null}else return e=Io(n),e!==null&&vd(e),t.blockedOn=n,!1;e.shift()}return!0}function $p(t,e,n){Yl(t)&&n.delete(e)}function _k(){Ph=!1,lr!==null&&Yl(lr)&&(lr=null),ar!==null&&Yl(ar)&&(ar=null),ur!==null&&Yl(ur)&&(ur=null),ro.forEach($p),io.forEach($p)}function us(t,e){t.blockedOn===e&&(t.blockedOn=null,Ph||(Ph=!0,Mt.unstable_scheduleCallback(Mt.unstable_NormalPriority,_k)))}function so(t){function e(i){return us(i,t)}if(0<nl.length){us(nl[0],t);for(var n=1;n<nl.length;n++){var r=nl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(lr!==null&&us(lr,t),ar!==null&&us(ar,t),ur!==null&&us(ur,t),ro.forEach(e),io.forEach(e),n=0;n<Jn.length;n++)r=Jn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Jn.length&&(n=Jn[0],n.blockedOn===null);)Uy(n),n.blockedOn===null&&Jn.shift()}var Pi=Hn.ReactCurrentBatchConfig,Sa=!0;function Ik(t,e,n,r){var i=oe,s=Pi.transition;Pi.transition=null;try{oe=1,wd(t,e,n,r)}finally{oe=i,Pi.transition=s}}function jk(t,e,n,r){var i=oe,s=Pi.transition;Pi.transition=null;try{oe=4,wd(t,e,n,r)}finally{oe=i,Pi.transition=s}}function wd(t,e,n,r){if(Sa){var i=Dh(t,e,n,r);if(i===null)uc(t,e,r,ka,n),Up(t,r);else if(Bk(i,t,e,n,r))r.stopPropagation();else if(Up(t,r),e&4&&-1<Lk.indexOf(t)){for(;i!==null;){var s=Io(i);if(s!==null&&zy(s),s=Dh(t,e,n,r),s===null&&uc(t,e,r,ka,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else uc(t,e,r,null,n)}}var ka=null;function Dh(t,e,n,r){if(ka=null,t=md(r),t=Lr(t),t!==null)if(e=ti(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ry(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ka=t,null}function $y(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Mk()){case gd:return 1;case _y:return 4;case wa:case Ak:return 16;case Iy:return 536870912;default:return 16}default:return 16}}var tr=null,xd=null,Ql=null;function Ky(){if(Ql)return Ql;var t,e=xd,n=e.length,r,i="value"in tr?tr.value:tr.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Ql=i.slice(t,1<r?1-r:void 0)}function Jl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function rl(){return!0}function Kp(){return!1}function Et(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?rl:Kp,this.isPropagationStopped=Kp,this}return xe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=rl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=rl)},persist:function(){},isPersistent:rl}),e}var ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sd=Et(ts),_o=xe({},ts,{view:0,detail:0}),Fk=Et(_o),ec,tc,cs,yu=xe({},_o,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==cs&&(cs&&t.type==="mousemove"?(ec=t.screenX-cs.screenX,tc=t.screenY-cs.screenY):tc=ec=0,cs=t),ec)},movementY:function(t){return"movementY"in t?t.movementY:tc}}),qp=Et(yu),zk=xe({},yu,{dataTransfer:0}),Wk=Et(zk),Vk=xe({},_o,{relatedTarget:0}),nc=Et(Vk),Hk=xe({},ts,{animationName:0,elapsedTime:0,pseudoElement:0}),Uk=Et(Hk),$k=xe({},ts,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Kk=Et($k),qk=xe({},ts,{data:0}),Gp=Et(qk),Gk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qk(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Yk[t])?!!e[t]:!1}function kd(){return Qk}var Jk=xe({},_o,{key:function(t){if(t.key){var e=Gk[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Jl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Xk[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kd,charCode:function(t){return t.type==="keypress"?Jl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Jl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Zk=Et(Jk),eb=xe({},yu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xp=Et(eb),tb=xe({},_o,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kd}),nb=Et(tb),rb=xe({},ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),ib=Et(rb),sb=xe({},yu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ob=Et(sb),lb=[9,13,27,32],bd=_n&&"CompositionEvent"in window,Fs=null;_n&&"documentMode"in document&&(Fs=document.documentMode);var ab=_n&&"TextEvent"in window&&!Fs,qy=_n&&(!bd||Fs&&8<Fs&&11>=Fs),Yp=" ",Qp=!1;function Gy(t,e){switch(t){case"keyup":return lb.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xy(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var fi=!1;function ub(t,e){switch(t){case"compositionend":return Xy(e);case"keypress":return e.which!==32?null:(Qp=!0,Yp);case"textInput":return t=e.data,t===Yp&&Qp?null:t;default:return null}}function cb(t,e){if(fi)return t==="compositionend"||!bd&&Gy(t,e)?(t=Ky(),Ql=xd=tr=null,fi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return qy&&e.locale!=="ko"?null:e.data;default:return null}}var hb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!hb[t.type]:e==="textarea"}function Yy(t,e,n,r){Ey(r),e=ba(e,"onChange"),0<e.length&&(n=new Sd("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var zs=null,oo=null;function fb(t){lv(t,0)}function vu(t){var e=mi(t);if(xy(e))return t}function db(t,e){if(t==="change")return e}var Qy=!1;if(_n){var rc;if(_n){var ic="oninput"in document;if(!ic){var Zp=document.createElement("div");Zp.setAttribute("oninput","return;"),ic=typeof Zp.oninput=="function"}rc=ic}else rc=!1;Qy=rc&&(!document.documentMode||9<document.documentMode)}function em(){zs&&(zs.detachEvent("onpropertychange",Jy),oo=zs=null)}function Jy(t){if(t.propertyName==="value"&&vu(oo)){var e=[];Yy(e,oo,t,md(t)),Oy(fb,e)}}function pb(t,e,n){t==="focusin"?(em(),zs=e,oo=n,zs.attachEvent("onpropertychange",Jy)):t==="focusout"&&em()}function mb(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return vu(oo)}function gb(t,e){if(t==="click")return vu(e)}function yb(t,e){if(t==="input"||t==="change")return vu(e)}function vb(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var en=typeof Object.is=="function"?Object.is:vb;function lo(t,e){if(en(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!hh.call(e,i)||!en(t[i],e[i]))return!1}return!0}function tm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function nm(t,e){var n=tm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=tm(n)}}function Zy(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Zy(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ev(){for(var t=window,e=ga();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ga(t.document)}return e}function Cd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function wb(t){var e=ev(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Zy(n.ownerDocument.documentElement,n)){if(r!==null&&Cd(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=nm(n,s);var o=nm(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var xb=_n&&"documentMode"in document&&11>=document.documentMode,di=null,Th=null,Ws=null,Oh=!1;function rm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Oh||di==null||di!==ga(r)||(r=di,"selectionStart"in r&&Cd(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ws&&lo(Ws,r)||(Ws=r,r=ba(Th,"onSelect"),0<r.length&&(e=new Sd("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=di)))}function il(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var pi={animationend:il("Animation","AnimationEnd"),animationiteration:il("Animation","AnimationIteration"),animationstart:il("Animation","AnimationStart"),transitionend:il("Transition","TransitionEnd")},sc={},tv={};_n&&(tv=document.createElement("div").style,"AnimationEvent"in window||(delete pi.animationend.animation,delete pi.animationiteration.animation,delete pi.animationstart.animation),"TransitionEvent"in window||delete pi.transitionend.transition);function wu(t){if(sc[t])return sc[t];if(!pi[t])return t;var e=pi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in tv)return sc[t]=e[n];return t}var nv=wu("animationend"),rv=wu("animationiteration"),iv=wu("animationstart"),sv=wu("transitionend"),ov=new Map,im="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function br(t,e){ov.set(t,e),ei(e,[t])}for(var oc=0;oc<im.length;oc++){var lc=im[oc],Sb=lc.toLowerCase(),kb=lc[0].toUpperCase()+lc.slice(1);br(Sb,"on"+kb)}br(nv,"onAnimationEnd");br(rv,"onAnimationIteration");br(iv,"onAnimationStart");br("dblclick","onDoubleClick");br("focusin","onFocus");br("focusout","onBlur");br(sv,"onTransitionEnd");ji("onMouseEnter",["mouseout","mouseover"]);ji("onMouseLeave",["mouseout","mouseover"]);ji("onPointerEnter",["pointerout","pointerover"]);ji("onPointerLeave",["pointerout","pointerover"]);ei("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ei("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ei("onBeforeInput",["compositionend","keypress","textInput","paste"]);ei("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ei("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ei("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Os="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Os));function sm(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Sk(r,e,void 0,t),t.currentTarget=null}function lv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==s&&i.isPropagationStopped())break e;sm(i,l,u),s=a}else for(o=0;o<r.length;o++){if(l=r[o],a=l.instance,u=l.currentTarget,l=l.listener,a!==s&&i.isPropagationStopped())break e;sm(i,l,u),s=a}}}if(va)throw t=Ah,va=!1,Ah=null,t}function he(t,e){var n=e[_h];n===void 0&&(n=e[_h]=new Set);var r=t+"__bubble";n.has(r)||(av(e,t,2,!1),n.add(r))}function ac(t,e,n){var r=0;e&&(r|=4),av(n,t,r,e)}var sl="_reactListening"+Math.random().toString(36).slice(2);function ao(t){if(!t[sl]){t[sl]=!0,my.forEach(function(n){n!=="selectionchange"&&(bb.has(n)||ac(n,!1,t),ac(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[sl]||(e[sl]=!0,ac("selectionchange",!1,e))}}function av(t,e,n,r){switch($y(e)){case 1:var i=Ik;break;case 4:i=jk;break;default:i=wd}n=i.bind(null,e,n,t),i=void 0,!Mh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function uc(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var a=o.tag;if((a===3||a===4)&&(a=o.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Lr(l),o===null)return;if(a=o.tag,a===5||a===6){r=s=o;continue e}l=l.parentNode}}r=r.return}Oy(function(){var u=s,c=md(n),h=[];e:{var f=ov.get(t);if(f!==void 0){var d=Sd,p=t;switch(t){case"keypress":if(Jl(n)===0)break e;case"keydown":case"keyup":d=Zk;break;case"focusin":p="focus",d=nc;break;case"focusout":p="blur",d=nc;break;case"beforeblur":case"afterblur":d=nc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=qp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=Wk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=nb;break;case nv:case rv:case iv:d=Uk;break;case sv:d=ib;break;case"scroll":d=Fk;break;case"wheel":d=ob;break;case"copy":case"cut":case"paste":d=Kk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=Xp}var y=(e&4)!==0,w=!y&&t==="scroll",m=y?f!==null?f+"Capture":null:f;y=[];for(var g=u,v;g!==null;){v=g;var x=v.stateNode;if(v.tag===5&&x!==null&&(v=x,m!==null&&(x=no(g,m),x!=null&&y.push(uo(g,x,v)))),w)break;g=g.return}0<y.length&&(f=new d(f,p,null,n,c),h.push({event:f,listeners:y}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",d=t==="mouseout"||t==="pointerout",f&&n!==bh&&(p=n.relatedTarget||n.fromElement)&&(Lr(p)||p[In]))break e;if((d||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,d?(p=n.relatedTarget||n.toElement,d=u,p=p?Lr(p):null,p!==null&&(w=ti(p),p!==w||p.tag!==5&&p.tag!==6)&&(p=null)):(d=null,p=u),d!==p)){if(y=qp,x="onMouseLeave",m="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(y=Xp,x="onPointerLeave",m="onPointerEnter",g="pointer"),w=d==null?f:mi(d),v=p==null?f:mi(p),f=new y(x,g+"leave",d,n,c),f.target=w,f.relatedTarget=v,x=null,Lr(c)===u&&(y=new y(m,g+"enter",p,n,c),y.target=v,y.relatedTarget=w,x=y),w=x,d&&p)t:{for(y=d,m=p,g=0,v=y;v;v=ri(v))g++;for(v=0,x=m;x;x=ri(x))v++;for(;0<g-v;)y=ri(y),g--;for(;0<v-g;)m=ri(m),v--;for(;g--;){if(y===m||m!==null&&y===m.alternate)break t;y=ri(y),m=ri(m)}y=null}else y=null;d!==null&&om(h,f,d,y,!1),p!==null&&w!==null&&om(h,w,p,y,!0)}}e:{if(f=u?mi(u):window,d=f.nodeName&&f.nodeName.toLowerCase(),d==="select"||d==="input"&&f.type==="file")var k=db;else if(Jp(f))if(Qy)k=yb;else{k=mb;var b=pb}else(d=f.nodeName)&&d.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=gb);if(k&&(k=k(t,u))){Yy(h,k,n,c);break e}b&&b(t,f,u),t==="focusout"&&(b=f._wrapperState)&&b.controlled&&f.type==="number"&&vh(f,"number",f.value)}switch(b=u?mi(u):window,t){case"focusin":(Jp(b)||b.contentEditable==="true")&&(di=b,Th=u,Ws=null);break;case"focusout":Ws=Th=di=null;break;case"mousedown":Oh=!0;break;case"contextmenu":case"mouseup":case"dragend":Oh=!1,rm(h,n,c);break;case"selectionchange":if(xb)break;case"keydown":case"keyup":rm(h,n,c)}var C;if(bd)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else fi?Gy(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(qy&&n.locale!=="ko"&&(fi||E!=="onCompositionStart"?E==="onCompositionEnd"&&fi&&(C=Ky()):(tr=c,xd="value"in tr?tr.value:tr.textContent,fi=!0)),b=ba(u,E),0<b.length&&(E=new Gp(E,t,null,n,c),h.push({event:E,listeners:b}),C?E.data=C:(C=Xy(n),C!==null&&(E.data=C)))),(C=ab?ub(t,n):cb(t,n))&&(u=ba(u,"onBeforeInput"),0<u.length&&(c=new Gp("onBeforeInput","beforeinput",null,n,c),h.push({event:c,listeners:u}),c.data=C))}lv(h,e)})}function uo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ba(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=no(t,n),s!=null&&r.unshift(uo(t,s,i)),s=no(t,e),s!=null&&r.push(uo(t,s,i))),t=t.return}return r}function ri(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function om(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var l=n,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,i?(a=no(n,s),a!=null&&o.unshift(uo(n,a,l))):i||(a=no(n,s),a!=null&&o.push(uo(n,a,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Cb=/\r\n?/g,Mb=/\u0000|\uFFFD/g;function lm(t){return(typeof t=="string"?t:""+t).replace(Cb,`
`).replace(Mb,"")}function ol(t,e,n){if(e=lm(e),lm(t)!==e&&n)throw Error(P(425))}function Ca(){}var Rh=null,Nh=null;function Lh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Bh=typeof setTimeout=="function"?setTimeout:void 0,Ab=typeof clearTimeout=="function"?clearTimeout:void 0,am=typeof Promise=="function"?Promise:void 0,Eb=typeof queueMicrotask=="function"?queueMicrotask:typeof am<"u"?function(t){return am.resolve(null).then(t).catch(Pb)}:Bh;function Pb(t){setTimeout(function(){throw t})}function cc(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),so(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);so(e)}function cr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function um(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ns=Math.random().toString(36).slice(2),dn="__reactFiber$"+ns,co="__reactProps$"+ns,In="__reactContainer$"+ns,_h="__reactEvents$"+ns,Db="__reactListeners$"+ns,Tb="__reactHandles$"+ns;function Lr(t){var e=t[dn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[In]||n[dn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=um(t);t!==null;){if(n=t[dn])return n;t=um(t)}return e}t=n,n=t.parentNode}return null}function Io(t){return t=t[dn]||t[In],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function mi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(P(33))}function xu(t){return t[co]||null}var Ih=[],gi=-1;function Cr(t){return{current:t}}function de(t){0>gi||(t.current=Ih[gi],Ih[gi]=null,gi--)}function ce(t,e){gi++,Ih[gi]=t.current,t.current=e}var yr={},Ge=Cr(yr),gt=Cr(!1),Hr=yr;function Fi(t,e){var n=t.type.contextTypes;if(!n)return yr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function yt(t){return t=t.childContextTypes,t!=null}function Ma(){de(gt),de(Ge)}function cm(t,e,n){if(Ge.current!==yr)throw Error(P(168));ce(Ge,e),ce(gt,n)}function uv(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(P(108,pk(t)||"Unknown",i));return xe({},n,r)}function Aa(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||yr,Hr=Ge.current,ce(Ge,t),ce(gt,gt.current),!0}function hm(t,e,n){var r=t.stateNode;if(!r)throw Error(P(169));n?(t=uv(t,e,Hr),r.__reactInternalMemoizedMergedChildContext=t,de(gt),de(Ge),ce(Ge,t)):de(gt),ce(gt,n)}var Tn=null,Su=!1,hc=!1;function cv(t){Tn===null?Tn=[t]:Tn.push(t)}function Ob(t){Su=!0,cv(t)}function Mr(){if(!hc&&Tn!==null){hc=!0;var t=0,e=oe;try{var n=Tn;for(oe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Tn=null,Su=!1}catch(i){throw Tn!==null&&(Tn=Tn.slice(t+1)),By(gd,Mr),i}finally{oe=e,hc=!1}}return null}var yi=[],vi=0,Ea=null,Pa=0,Ot=[],Rt=0,Ur=null,Rn=1,Nn="";function Dr(t,e){yi[vi++]=Pa,yi[vi++]=Ea,Ea=t,Pa=e}function hv(t,e,n){Ot[Rt++]=Rn,Ot[Rt++]=Nn,Ot[Rt++]=Ur,Ur=t;var r=Rn;t=Nn;var i=32-Jt(r)-1;r&=~(1<<i),n+=1;var s=32-Jt(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Rn=1<<32-Jt(e)+i|n<<i|r,Nn=s+t}else Rn=1<<s|n<<i|r,Nn=t}function Md(t){t.return!==null&&(Dr(t,1),hv(t,1,0))}function Ad(t){for(;t===Ea;)Ea=yi[--vi],yi[vi]=null,Pa=yi[--vi],yi[vi]=null;for(;t===Ur;)Ur=Ot[--Rt],Ot[Rt]=null,Nn=Ot[--Rt],Ot[Rt]=null,Rn=Ot[--Rt],Ot[Rt]=null}var Ct=null,kt=null,ge=!1,Yt=null;function fv(t,e){var n=Lt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function fm(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ct=t,kt=cr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ct=t,kt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ur!==null?{id:Rn,overflow:Nn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Lt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ct=t,kt=null,!0):!1;default:return!1}}function jh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Fh(t){if(ge){var e=kt;if(e){var n=e;if(!fm(t,e)){if(jh(t))throw Error(P(418));e=cr(n.nextSibling);var r=Ct;e&&fm(t,e)?fv(r,n):(t.flags=t.flags&-4097|2,ge=!1,Ct=t)}}else{if(jh(t))throw Error(P(418));t.flags=t.flags&-4097|2,ge=!1,Ct=t}}}function dm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ct=t}function ll(t){if(t!==Ct)return!1;if(!ge)return dm(t),ge=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Lh(t.type,t.memoizedProps)),e&&(e=kt)){if(jh(t))throw dv(),Error(P(418));for(;e;)fv(t,e),e=cr(e.nextSibling)}if(dm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(P(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){kt=cr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}kt=null}}else kt=Ct?cr(t.stateNode.nextSibling):null;return!0}function dv(){for(var t=kt;t;)t=cr(t.nextSibling)}function zi(){kt=Ct=null,ge=!1}function Ed(t){Yt===null?Yt=[t]:Yt.push(t)}var Rb=Hn.ReactCurrentBatchConfig;function hs(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(P(309));var r=n.stateNode}if(!r)throw Error(P(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(P(284));if(!n._owner)throw Error(P(290,t))}return t}function al(t,e){throw t=Object.prototype.toString.call(e),Error(P(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function pm(t){var e=t._init;return e(t._payload)}function pv(t){function e(m,g){if(t){var v=m.deletions;v===null?(m.deletions=[g],m.flags|=16):v.push(g)}}function n(m,g){if(!t)return null;for(;g!==null;)e(m,g),g=g.sibling;return null}function r(m,g){for(m=new Map;g!==null;)g.key!==null?m.set(g.key,g):m.set(g.index,g),g=g.sibling;return m}function i(m,g){return m=pr(m,g),m.index=0,m.sibling=null,m}function s(m,g,v){return m.index=v,t?(v=m.alternate,v!==null?(v=v.index,v<g?(m.flags|=2,g):v):(m.flags|=2,g)):(m.flags|=1048576,g)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function l(m,g,v,x){return g===null||g.tag!==6?(g=vc(v,m.mode,x),g.return=m,g):(g=i(g,v),g.return=m,g)}function a(m,g,v,x){var k=v.type;return k===hi?c(m,g,v.props.children,x,v.key):g!==null&&(g.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Gn&&pm(k)===g.type)?(x=i(g,v.props),x.ref=hs(m,g,v),x.return=m,x):(x=sa(v.type,v.key,v.props,null,m.mode,x),x.ref=hs(m,g,v),x.return=m,x)}function u(m,g,v,x){return g===null||g.tag!==4||g.stateNode.containerInfo!==v.containerInfo||g.stateNode.implementation!==v.implementation?(g=wc(v,m.mode,x),g.return=m,g):(g=i(g,v.children||[]),g.return=m,g)}function c(m,g,v,x,k){return g===null||g.tag!==7?(g=zr(v,m.mode,x,k),g.return=m,g):(g=i(g,v),g.return=m,g)}function h(m,g,v){if(typeof g=="string"&&g!==""||typeof g=="number")return g=vc(""+g,m.mode,v),g.return=m,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Qo:return v=sa(g.type,g.key,g.props,null,m.mode,v),v.ref=hs(m,null,g),v.return=m,v;case ci:return g=wc(g,m.mode,v),g.return=m,g;case Gn:var x=g._init;return h(m,x(g._payload),v)}if(Ds(g)||os(g))return g=zr(g,m.mode,v,null),g.return=m,g;al(m,g)}return null}function f(m,g,v,x){var k=g!==null?g.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return k!==null?null:l(m,g,""+v,x);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Qo:return v.key===k?a(m,g,v,x):null;case ci:return v.key===k?u(m,g,v,x):null;case Gn:return k=v._init,f(m,g,k(v._payload),x)}if(Ds(v)||os(v))return k!==null?null:c(m,g,v,x,null);al(m,v)}return null}function d(m,g,v,x,k){if(typeof x=="string"&&x!==""||typeof x=="number")return m=m.get(v)||null,l(g,m,""+x,k);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Qo:return m=m.get(x.key===null?v:x.key)||null,a(g,m,x,k);case ci:return m=m.get(x.key===null?v:x.key)||null,u(g,m,x,k);case Gn:var b=x._init;return d(m,g,v,b(x._payload),k)}if(Ds(x)||os(x))return m=m.get(v)||null,c(g,m,x,k,null);al(g,x)}return null}function p(m,g,v,x){for(var k=null,b=null,C=g,E=g=0,O=null;C!==null&&E<v.length;E++){C.index>E?(O=C,C=null):O=C.sibling;var N=f(m,C,v[E],x);if(N===null){C===null&&(C=O);break}t&&C&&N.alternate===null&&e(m,C),g=s(N,g,E),b===null?k=N:b.sibling=N,b=N,C=O}if(E===v.length)return n(m,C),ge&&Dr(m,E),k;if(C===null){for(;E<v.length;E++)C=h(m,v[E],x),C!==null&&(g=s(C,g,E),b===null?k=C:b.sibling=C,b=C);return ge&&Dr(m,E),k}for(C=r(m,C);E<v.length;E++)O=d(C,m,E,v[E],x),O!==null&&(t&&O.alternate!==null&&C.delete(O.key===null?E:O.key),g=s(O,g,E),b===null?k=O:b.sibling=O,b=O);return t&&C.forEach(function(V){return e(m,V)}),ge&&Dr(m,E),k}function y(m,g,v,x){var k=os(v);if(typeof k!="function")throw Error(P(150));if(v=k.call(v),v==null)throw Error(P(151));for(var b=k=null,C=g,E=g=0,O=null,N=v.next();C!==null&&!N.done;E++,N=v.next()){C.index>E?(O=C,C=null):O=C.sibling;var V=f(m,C,N.value,x);if(V===null){C===null&&(C=O);break}t&&C&&V.alternate===null&&e(m,C),g=s(V,g,E),b===null?k=V:b.sibling=V,b=V,C=O}if(N.done)return n(m,C),ge&&Dr(m,E),k;if(C===null){for(;!N.done;E++,N=v.next())N=h(m,N.value,x),N!==null&&(g=s(N,g,E),b===null?k=N:b.sibling=N,b=N);return ge&&Dr(m,E),k}for(C=r(m,C);!N.done;E++,N=v.next())N=d(C,m,E,N.value,x),N!==null&&(t&&N.alternate!==null&&C.delete(N.key===null?E:N.key),g=s(N,g,E),b===null?k=N:b.sibling=N,b=N);return t&&C.forEach(function(j){return e(m,j)}),ge&&Dr(m,E),k}function w(m,g,v,x){if(typeof v=="object"&&v!==null&&v.type===hi&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Qo:e:{for(var k=v.key,b=g;b!==null;){if(b.key===k){if(k=v.type,k===hi){if(b.tag===7){n(m,b.sibling),g=i(b,v.props.children),g.return=m,m=g;break e}}else if(b.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Gn&&pm(k)===b.type){n(m,b.sibling),g=i(b,v.props),g.ref=hs(m,b,v),g.return=m,m=g;break e}n(m,b);break}else e(m,b);b=b.sibling}v.type===hi?(g=zr(v.props.children,m.mode,x,v.key),g.return=m,m=g):(x=sa(v.type,v.key,v.props,null,m.mode,x),x.ref=hs(m,g,v),x.return=m,m=x)}return o(m);case ci:e:{for(b=v.key;g!==null;){if(g.key===b)if(g.tag===4&&g.stateNode.containerInfo===v.containerInfo&&g.stateNode.implementation===v.implementation){n(m,g.sibling),g=i(g,v.children||[]),g.return=m,m=g;break e}else{n(m,g);break}else e(m,g);g=g.sibling}g=wc(v,m.mode,x),g.return=m,m=g}return o(m);case Gn:return b=v._init,w(m,g,b(v._payload),x)}if(Ds(v))return p(m,g,v,x);if(os(v))return y(m,g,v,x);al(m,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,g!==null&&g.tag===6?(n(m,g.sibling),g=i(g,v),g.return=m,m=g):(n(m,g),g=vc(v,m.mode,x),g.return=m,m=g),o(m)):n(m,g)}return w}var Wi=pv(!0),mv=pv(!1),Da=Cr(null),Ta=null,wi=null,Pd=null;function Dd(){Pd=wi=Ta=null}function Td(t){var e=Da.current;de(Da),t._currentValue=e}function zh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Di(t,e){Ta=t,Pd=wi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(dt=!0),t.firstContext=null)}function zt(t){var e=t._currentValue;if(Pd!==t)if(t={context:t,memoizedValue:e,next:null},wi===null){if(Ta===null)throw Error(P(308));wi=t,Ta.dependencies={lanes:0,firstContext:t}}else wi=wi.next=t;return e}var Br=null;function Od(t){Br===null?Br=[t]:Br.push(t)}function gv(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Od(e)):(n.next=i.next,i.next=n),e.interleaved=n,jn(t,r)}function jn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Xn=!1;function Rd(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ln(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function hr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ie&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,jn(t,n)}return i=r.interleaved,i===null?(e.next=e,Od(r)):(e.next=i.next,i.next=e),r.interleaved=e,jn(t,n)}function Zl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yd(t,n)}}function mm(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Oa(t,e,n,r){var i=t.updateQueue;Xn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,u=a.next;a.next=null,o===null?s=u:o.next=u,o=a;var c=t.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==o&&(l===null?c.firstBaseUpdate=u:l.next=u,c.lastBaseUpdate=a))}if(s!==null){var h=i.baseState;o=0,c=u=a=null,l=s;do{var f=l.lane,d=l.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:d,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var p=t,y=l;switch(f=e,d=n,y.tag){case 1:if(p=y.payload,typeof p=="function"){h=p.call(d,h,f);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=y.payload,f=typeof p=="function"?p.call(d,h,f):p,f==null)break e;h=xe({},h,f);break e;case 2:Xn=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[l]:f.push(l))}else d={eventTime:d,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(u=c=d,a=h):c=c.next=d,o|=f;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;f=l,l=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(c===null&&(a=h),i.baseState=a,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Kr|=o,t.lanes=o,t.memoizedState=h}}function gm(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(P(191,i));i.call(r)}}}var jo={},kn=Cr(jo),ho=Cr(jo),fo=Cr(jo);function _r(t){if(t===jo)throw Error(P(174));return t}function Nd(t,e){switch(ce(fo,e),ce(ho,t),ce(kn,jo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:xh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=xh(e,t)}de(kn),ce(kn,e)}function Vi(){de(kn),de(ho),de(fo)}function vv(t){_r(fo.current);var e=_r(kn.current),n=xh(e,t.type);e!==n&&(ce(ho,t),ce(kn,n))}function Ld(t){ho.current===t&&(de(kn),de(ho))}var ve=Cr(0);function Ra(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var fc=[];function Bd(){for(var t=0;t<fc.length;t++)fc[t]._workInProgressVersionPrimary=null;fc.length=0}var ea=Hn.ReactCurrentDispatcher,dc=Hn.ReactCurrentBatchConfig,$r=0,we=null,Ee=null,Oe=null,Na=!1,Vs=!1,po=0,Nb=0;function Ve(){throw Error(P(321))}function _d(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!en(t[n],e[n]))return!1;return!0}function Id(t,e,n,r,i,s){if($r=s,we=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ea.current=t===null||t.memoizedState===null?Ib:jb,t=n(r,i),Vs){s=0;do{if(Vs=!1,po=0,25<=s)throw Error(P(301));s+=1,Oe=Ee=null,e.updateQueue=null,ea.current=Fb,t=n(r,i)}while(Vs)}if(ea.current=La,e=Ee!==null&&Ee.next!==null,$r=0,Oe=Ee=we=null,Na=!1,e)throw Error(P(300));return t}function jd(){var t=po!==0;return po=0,t}function fn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Oe===null?we.memoizedState=Oe=t:Oe=Oe.next=t,Oe}function Wt(){if(Ee===null){var t=we.alternate;t=t!==null?t.memoizedState:null}else t=Ee.next;var e=Oe===null?we.memoizedState:Oe.next;if(e!==null)Oe=e,Ee=t;else{if(t===null)throw Error(P(310));Ee=t,t={memoizedState:Ee.memoizedState,baseState:Ee.baseState,baseQueue:Ee.baseQueue,queue:Ee.queue,next:null},Oe===null?we.memoizedState=Oe=t:Oe=Oe.next=t}return Oe}function mo(t,e){return typeof e=="function"?e(t):e}function pc(t){var e=Wt(),n=e.queue;if(n===null)throw Error(P(311));n.lastRenderedReducer=t;var r=Ee,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,a=null,u=s;do{var c=u.lane;if(($r&c)===c)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=h,o=r):a=a.next=h,we.lanes|=c,Kr|=c}u=u.next}while(u!==null&&u!==s);a===null?o=r:a.next=l,en(r,e.memoizedState)||(dt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=a,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,we.lanes|=s,Kr|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function mc(t){var e=Wt(),n=e.queue;if(n===null)throw Error(P(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);en(s,e.memoizedState)||(dt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function wv(){}function xv(t,e){var n=we,r=Wt(),i=e(),s=!en(r.memoizedState,i);if(s&&(r.memoizedState=i,dt=!0),r=r.queue,Fd(bv.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Oe!==null&&Oe.memoizedState.tag&1){if(n.flags|=2048,go(9,kv.bind(null,n,r,i,e),void 0,null),Ne===null)throw Error(P(349));$r&30||Sv(n,e,i)}return i}function Sv(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=we.updateQueue,e===null?(e={lastEffect:null,stores:null},we.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function kv(t,e,n,r){e.value=n,e.getSnapshot=r,Cv(e)&&Mv(t)}function bv(t,e,n){return n(function(){Cv(e)&&Mv(t)})}function Cv(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!en(t,n)}catch{return!0}}function Mv(t){var e=jn(t,1);e!==null&&Zt(e,t,1,-1)}function ym(t){var e=fn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:t},e.queue=t,t=t.dispatch=_b.bind(null,we,t),[e.memoizedState,t]}function go(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=we.updateQueue,e===null?(e={lastEffect:null,stores:null},we.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Av(){return Wt().memoizedState}function ta(t,e,n,r){var i=fn();we.flags|=t,i.memoizedState=go(1|e,n,void 0,r===void 0?null:r)}function ku(t,e,n,r){var i=Wt();r=r===void 0?null:r;var s=void 0;if(Ee!==null){var o=Ee.memoizedState;if(s=o.destroy,r!==null&&_d(r,o.deps)){i.memoizedState=go(e,n,s,r);return}}we.flags|=t,i.memoizedState=go(1|e,n,s,r)}function vm(t,e){return ta(8390656,8,t,e)}function Fd(t,e){return ku(2048,8,t,e)}function Ev(t,e){return ku(4,2,t,e)}function Pv(t,e){return ku(4,4,t,e)}function Dv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Tv(t,e,n){return n=n!=null?n.concat([t]):null,ku(4,4,Dv.bind(null,e,t),n)}function zd(){}function Ov(t,e){var n=Wt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_d(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Rv(t,e){var n=Wt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_d(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Nv(t,e,n){return $r&21?(en(n,e)||(n=jy(),we.lanes|=n,Kr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,dt=!0),t.memoizedState=n)}function Lb(t,e){var n=oe;oe=n!==0&&4>n?n:4,t(!0);var r=dc.transition;dc.transition={};try{t(!1),e()}finally{oe=n,dc.transition=r}}function Lv(){return Wt().memoizedState}function Bb(t,e,n){var r=dr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Bv(t))_v(e,n);else if(n=gv(t,e,n,r),n!==null){var i=rt();Zt(n,t,r,i),Iv(n,e,r)}}function _b(t,e,n){var r=dr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Bv(t))_v(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,en(l,o)){var a=e.interleaved;a===null?(i.next=i,Od(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}n=gv(t,e,i,r),n!==null&&(i=rt(),Zt(n,t,r,i),Iv(n,e,r))}}function Bv(t){var e=t.alternate;return t===we||e!==null&&e===we}function _v(t,e){Vs=Na=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Iv(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yd(t,n)}}var La={readContext:zt,useCallback:Ve,useContext:Ve,useEffect:Ve,useImperativeHandle:Ve,useInsertionEffect:Ve,useLayoutEffect:Ve,useMemo:Ve,useReducer:Ve,useRef:Ve,useState:Ve,useDebugValue:Ve,useDeferredValue:Ve,useTransition:Ve,useMutableSource:Ve,useSyncExternalStore:Ve,useId:Ve,unstable_isNewReconciler:!1},Ib={readContext:zt,useCallback:function(t,e){return fn().memoizedState=[t,e===void 0?null:e],t},useContext:zt,useEffect:vm,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ta(4194308,4,Dv.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ta(4194308,4,t,e)},useInsertionEffect:function(t,e){return ta(4,2,t,e)},useMemo:function(t,e){var n=fn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=fn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Bb.bind(null,we,t),[r.memoizedState,t]},useRef:function(t){var e=fn();return t={current:t},e.memoizedState=t},useState:ym,useDebugValue:zd,useDeferredValue:function(t){return fn().memoizedState=t},useTransition:function(){var t=ym(!1),e=t[0];return t=Lb.bind(null,t[1]),fn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=we,i=fn();if(ge){if(n===void 0)throw Error(P(407));n=n()}else{if(n=e(),Ne===null)throw Error(P(349));$r&30||Sv(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,vm(bv.bind(null,r,s,t),[t]),r.flags|=2048,go(9,kv.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=fn(),e=Ne.identifierPrefix;if(ge){var n=Nn,r=Rn;n=(r&~(1<<32-Jt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=po++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Nb++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},jb={readContext:zt,useCallback:Ov,useContext:zt,useEffect:Fd,useImperativeHandle:Tv,useInsertionEffect:Ev,useLayoutEffect:Pv,useMemo:Rv,useReducer:pc,useRef:Av,useState:function(){return pc(mo)},useDebugValue:zd,useDeferredValue:function(t){var e=Wt();return Nv(e,Ee.memoizedState,t)},useTransition:function(){var t=pc(mo)[0],e=Wt().memoizedState;return[t,e]},useMutableSource:wv,useSyncExternalStore:xv,useId:Lv,unstable_isNewReconciler:!1},Fb={readContext:zt,useCallback:Ov,useContext:zt,useEffect:Fd,useImperativeHandle:Tv,useInsertionEffect:Ev,useLayoutEffect:Pv,useMemo:Rv,useReducer:mc,useRef:Av,useState:function(){return mc(mo)},useDebugValue:zd,useDeferredValue:function(t){var e=Wt();return Ee===null?e.memoizedState=t:Nv(e,Ee.memoizedState,t)},useTransition:function(){var t=mc(mo)[0],e=Wt().memoizedState;return[t,e]},useMutableSource:wv,useSyncExternalStore:xv,useId:Lv,unstable_isNewReconciler:!1};function Gt(t,e){if(t&&t.defaultProps){e=xe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Wh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:xe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var bu={isMounted:function(t){return(t=t._reactInternals)?ti(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=rt(),i=dr(t),s=Ln(r,i);s.payload=e,n!=null&&(s.callback=n),e=hr(t,s,i),e!==null&&(Zt(e,t,i,r),Zl(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=rt(),i=dr(t),s=Ln(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=hr(t,s,i),e!==null&&(Zt(e,t,i,r),Zl(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=rt(),r=dr(t),i=Ln(n,r);i.tag=2,e!=null&&(i.callback=e),e=hr(t,i,r),e!==null&&(Zt(e,t,r,n),Zl(e,t,r))}};function wm(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!lo(n,r)||!lo(i,s):!0}function jv(t,e,n){var r=!1,i=yr,s=e.contextType;return typeof s=="object"&&s!==null?s=zt(s):(i=yt(e)?Hr:Ge.current,r=e.contextTypes,s=(r=r!=null)?Fi(t,i):yr),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=bu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function xm(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&bu.enqueueReplaceState(e,e.state,null)}function Vh(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Rd(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=zt(s):(s=yt(e)?Hr:Ge.current,i.context=Fi(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Wh(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&bu.enqueueReplaceState(i,i.state,null),Oa(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Hi(t,e){try{var n="",r=e;do n+=dk(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function gc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Hh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var zb=typeof WeakMap=="function"?WeakMap:Map;function Fv(t,e,n){n=Ln(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){_a||(_a=!0,Zh=r),Hh(t,e)},n}function zv(t,e,n){n=Ln(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Hh(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Hh(t,e),typeof r!="function"&&(fr===null?fr=new Set([this]):fr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Sm(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new zb;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=eC.bind(null,t,e,n),e.then(t,t))}function km(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function bm(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ln(-1,1),e.tag=2,hr(n,e,1))),n.lanes|=1),t)}var Wb=Hn.ReactCurrentOwner,dt=!1;function et(t,e,n,r){e.child=t===null?mv(e,null,n,r):Wi(e,t.child,n,r)}function Cm(t,e,n,r,i){n=n.render;var s=e.ref;return Di(e,i),r=Id(t,e,n,r,s,i),n=jd(),t!==null&&!dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Fn(t,e,i)):(ge&&n&&Md(e),e.flags|=1,et(t,e,r,i),e.child)}function Mm(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Gd(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Wv(t,e,s,r,i)):(t=sa(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:lo,n(o,r)&&t.ref===e.ref)return Fn(t,e,i)}return e.flags|=1,t=pr(s,r),t.ref=e.ref,t.return=e,e.child=t}function Wv(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(lo(s,r)&&t.ref===e.ref)if(dt=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(dt=!0);else return e.lanes=t.lanes,Fn(t,e,i)}return Uh(t,e,n,r,i)}function Vv(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ce(Si,xt),xt|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ce(Si,xt),xt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ce(Si,xt),xt|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ce(Si,xt),xt|=r;return et(t,e,i,n),e.child}function Hv(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Uh(t,e,n,r,i){var s=yt(n)?Hr:Ge.current;return s=Fi(e,s),Di(e,i),n=Id(t,e,n,r,s,i),r=jd(),t!==null&&!dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Fn(t,e,i)):(ge&&r&&Md(e),e.flags|=1,et(t,e,n,i),e.child)}function Am(t,e,n,r,i){if(yt(n)){var s=!0;Aa(e)}else s=!1;if(Di(e,i),e.stateNode===null)na(t,e),jv(e,n,r),Vh(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var a=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=zt(u):(u=yt(n)?Hr:Ge.current,u=Fi(e,u));var c=n.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||a!==u)&&xm(e,o,r,u),Xn=!1;var f=e.memoizedState;o.state=f,Oa(e,r,o,i),a=e.memoizedState,l!==r||f!==a||gt.current||Xn?(typeof c=="function"&&(Wh(e,n,c,r),a=e.memoizedState),(l=Xn||wm(e,n,l,r,f,a,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),o.props=r,o.state=a,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,yv(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Gt(e.type,l),o.props=u,h=e.pendingProps,f=o.context,a=n.contextType,typeof a=="object"&&a!==null?a=zt(a):(a=yt(n)?Hr:Ge.current,a=Fi(e,a));var d=n.getDerivedStateFromProps;(c=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==a)&&xm(e,o,r,a),Xn=!1,f=e.memoizedState,o.state=f,Oa(e,r,o,i);var p=e.memoizedState;l!==h||f!==p||gt.current||Xn?(typeof d=="function"&&(Wh(e,n,d,r),p=e.memoizedState),(u=Xn||wm(e,n,u,r,f,p,a)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,a),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,a)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=a,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return $h(t,e,n,r,s,i)}function $h(t,e,n,r,i,s){Hv(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&hm(e,n,!1),Fn(t,e,s);r=e.stateNode,Wb.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Wi(e,t.child,null,s),e.child=Wi(e,null,l,s)):et(t,e,l,s),e.memoizedState=r.state,i&&hm(e,n,!0),e.child}function Uv(t){var e=t.stateNode;e.pendingContext?cm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&cm(t,e.context,!1),Nd(t,e.containerInfo)}function Em(t,e,n,r,i){return zi(),Ed(i),e.flags|=256,et(t,e,n,r),e.child}var Kh={dehydrated:null,treeContext:null,retryLane:0};function qh(t){return{baseLanes:t,cachePool:null,transitions:null}}function $v(t,e,n){var r=e.pendingProps,i=ve.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ce(ve,i&1),t===null)return Fh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Au(o,r,0,null),t=zr(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=qh(n),e.memoizedState=Kh,t):Wd(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return Vb(t,e,o,r,l,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=pr(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=pr(l,s):(s=zr(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?qh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Kh,r}return s=t.child,t=s.sibling,r=pr(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Wd(t,e){return e=Au({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ul(t,e,n,r){return r!==null&&Ed(r),Wi(e,t.child,null,n),t=Wd(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Vb(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=gc(Error(P(422))),ul(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Au({mode:"visible",children:r.children},i,0,null),s=zr(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Wi(e,t.child,null,o),e.child.memoizedState=qh(o),e.memoizedState=Kh,s);if(!(e.mode&1))return ul(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(P(419)),r=gc(s,r,void 0),ul(t,e,o,r)}if(l=(o&t.childLanes)!==0,dt||l){if(r=Ne,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,jn(t,i),Zt(r,t,i,-1))}return qd(),r=gc(Error(P(421))),ul(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=tC.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,kt=cr(i.nextSibling),Ct=e,ge=!0,Yt=null,t!==null&&(Ot[Rt++]=Rn,Ot[Rt++]=Nn,Ot[Rt++]=Ur,Rn=t.id,Nn=t.overflow,Ur=e),e=Wd(e,r.children),e.flags|=4096,e)}function Pm(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),zh(t.return,e,n)}function yc(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Kv(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(et(t,e,r.children,n),r=ve.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Pm(t,n,e);else if(t.tag===19)Pm(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ce(ve,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ra(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),yc(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ra(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}yc(e,!0,n,null,s);break;case"together":yc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function na(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Fn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Kr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(P(153));if(e.child!==null){for(t=e.child,n=pr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=pr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Hb(t,e,n){switch(e.tag){case 3:Uv(e),zi();break;case 5:vv(e);break;case 1:yt(e.type)&&Aa(e);break;case 4:Nd(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ce(Da,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ce(ve,ve.current&1),e.flags|=128,null):n&e.child.childLanes?$v(t,e,n):(ce(ve,ve.current&1),t=Fn(t,e,n),t!==null?t.sibling:null);ce(ve,ve.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Kv(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ce(ve,ve.current),r)break;return null;case 22:case 23:return e.lanes=0,Vv(t,e,n)}return Fn(t,e,n)}var qv,Gh,Gv,Xv;qv=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Gh=function(){};Gv=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,_r(kn.current);var s=null;switch(n){case"input":i=gh(t,i),r=gh(t,r),s=[];break;case"select":i=xe({},i,{value:void 0}),r=xe({},r,{value:void 0}),s=[];break;case"textarea":i=wh(t,i),r=wh(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ca)}Sh(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(eo.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var a=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||a&&a.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in a)a.hasOwnProperty(o)&&l[o]!==a[o]&&(n||(n={}),n[o]=a[o])}else n||(s||(s=[]),s.push(u,n)),n=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(s=s||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(eo.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&he("scroll",t),s||l===a||(s=[])):(s=s||[]).push(u,a))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Xv=function(t,e,n,r){n!==r&&(e.flags|=4)};function fs(t,e){if(!ge)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function He(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Ub(t,e,n){var r=e.pendingProps;switch(Ad(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return He(e),null;case 1:return yt(e.type)&&Ma(),He(e),null;case 3:return r=e.stateNode,Vi(),de(gt),de(Ge),Bd(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ll(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Yt!==null&&(nf(Yt),Yt=null))),Gh(t,e),He(e),null;case 5:Ld(e);var i=_r(fo.current);if(n=e.type,t!==null&&e.stateNode!=null)Gv(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(P(166));return He(e),null}if(t=_r(kn.current),ll(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[dn]=e,r[co]=s,t=(e.mode&1)!==0,n){case"dialog":he("cancel",r),he("close",r);break;case"iframe":case"object":case"embed":he("load",r);break;case"video":case"audio":for(i=0;i<Os.length;i++)he(Os[i],r);break;case"source":he("error",r);break;case"img":case"image":case"link":he("error",r),he("load",r);break;case"details":he("toggle",r);break;case"input":Ip(r,s),he("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},he("invalid",r);break;case"textarea":Fp(r,s),he("invalid",r)}Sh(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&ol(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&ol(r.textContent,l,t),i=["children",""+l]):eo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&he("scroll",r)}switch(n){case"input":Jo(r),jp(r,s,!0);break;case"textarea":Jo(r),zp(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Ca)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=by(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[dn]=e,t[co]=r,qv(t,e,!1,!1),e.stateNode=t;e:{switch(o=kh(n,r),n){case"dialog":he("cancel",t),he("close",t),i=r;break;case"iframe":case"object":case"embed":he("load",t),i=r;break;case"video":case"audio":for(i=0;i<Os.length;i++)he(Os[i],t);i=r;break;case"source":he("error",t),i=r;break;case"img":case"image":case"link":he("error",t),he("load",t),i=r;break;case"details":he("toggle",t),i=r;break;case"input":Ip(t,r),i=gh(t,r),he("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=xe({},r,{value:void 0}),he("invalid",t);break;case"textarea":Fp(t,r),i=wh(t,r),he("invalid",t);break;default:i=r}Sh(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var a=l[s];s==="style"?Ay(t,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&Cy(t,a)):s==="children"?typeof a=="string"?(n!=="textarea"||a!=="")&&to(t,a):typeof a=="number"&&to(t,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(eo.hasOwnProperty(s)?a!=null&&s==="onScroll"&&he("scroll",t):a!=null&&hd(t,s,a,o))}switch(n){case"input":Jo(t),jp(t,r,!1);break;case"textarea":Jo(t),zp(t);break;case"option":r.value!=null&&t.setAttribute("value",""+gr(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Mi(t,!!r.multiple,s,!1):r.defaultValue!=null&&Mi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Ca)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return He(e),null;case 6:if(t&&e.stateNode!=null)Xv(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(P(166));if(n=_r(fo.current),_r(kn.current),ll(e)){if(r=e.stateNode,n=e.memoizedProps,r[dn]=e,(s=r.nodeValue!==n)&&(t=Ct,t!==null))switch(t.tag){case 3:ol(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ol(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[dn]=e,e.stateNode=r}return He(e),null;case 13:if(de(ve),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ge&&kt!==null&&e.mode&1&&!(e.flags&128))dv(),zi(),e.flags|=98560,s=!1;else if(s=ll(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(P(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(P(317));s[dn]=e}else zi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;He(e),s=!1}else Yt!==null&&(nf(Yt),Yt=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ve.current&1?De===0&&(De=3):qd())),e.updateQueue!==null&&(e.flags|=4),He(e),null);case 4:return Vi(),Gh(t,e),t===null&&ao(e.stateNode.containerInfo),He(e),null;case 10:return Td(e.type._context),He(e),null;case 17:return yt(e.type)&&Ma(),He(e),null;case 19:if(de(ve),s=e.memoizedState,s===null)return He(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)fs(s,!1);else{if(De!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ra(t),o!==null){for(e.flags|=128,fs(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ce(ve,ve.current&1|2),e.child}t=t.sibling}s.tail!==null&&be()>Ui&&(e.flags|=128,r=!0,fs(s,!1),e.lanes=4194304)}else{if(!r)if(t=Ra(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),fs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ge)return He(e),null}else 2*be()-s.renderingStartTime>Ui&&n!==1073741824&&(e.flags|=128,r=!0,fs(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=be(),e.sibling=null,n=ve.current,ce(ve,r?n&1|2:n&1),e):(He(e),null);case 22:case 23:return Kd(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?xt&1073741824&&(He(e),e.subtreeFlags&6&&(e.flags|=8192)):He(e),null;case 24:return null;case 25:return null}throw Error(P(156,e.tag))}function $b(t,e){switch(Ad(e),e.tag){case 1:return yt(e.type)&&Ma(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Vi(),de(gt),de(Ge),Bd(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Ld(e),null;case 13:if(de(ve),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(P(340));zi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return de(ve),null;case 4:return Vi(),null;case 10:return Td(e.type._context),null;case 22:case 23:return Kd(),null;case 24:return null;default:return null}}var cl=!1,$e=!1,Kb=typeof WeakSet=="function"?WeakSet:Set,F=null;function xi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Se(t,e,r)}else n.current=null}function Xh(t,e,n){try{n()}catch(r){Se(t,e,r)}}var Dm=!1;function qb(t,e){if(Rh=Sa,t=ev(),Cd(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,a=-1,u=0,c=0,h=t,f=null;t:for(;;){for(var d;h!==n||i!==0&&h.nodeType!==3||(l=o+i),h!==s||r!==0&&h.nodeType!==3||(a=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(d=h.firstChild)!==null;)f=h,h=d;for(;;){if(h===t)break t;if(f===n&&++u===i&&(l=o),f===s&&++c===r&&(a=o),(d=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=d}n=l===-1||a===-1?null:{start:l,end:a}}else n=null}n=n||{start:0,end:0}}else n=null;for(Nh={focusedElem:t,selectionRange:n},Sa=!1,F=e;F!==null;)if(e=F,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,F=t;else for(;F!==null;){e=F;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var y=p.memoizedProps,w=p.memoizedState,m=e.stateNode,g=m.getSnapshotBeforeUpdate(e.elementType===e.type?y:Gt(e.type,y),w);m.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(P(163))}}catch(x){Se(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,F=t;break}F=e.return}return p=Dm,Dm=!1,p}function Hs(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Xh(e,n,s)}i=i.next}while(i!==r)}}function Cu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Yh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Yv(t){var e=t.alternate;e!==null&&(t.alternate=null,Yv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[dn],delete e[co],delete e[_h],delete e[Db],delete e[Tb])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Qv(t){return t.tag===5||t.tag===3||t.tag===4}function Tm(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Qv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Qh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ca));else if(r!==4&&(t=t.child,t!==null))for(Qh(t,e,n),t=t.sibling;t!==null;)Qh(t,e,n),t=t.sibling}function Jh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Jh(t,e,n),t=t.sibling;t!==null;)Jh(t,e,n),t=t.sibling}var Le=null,Xt=!1;function $n(t,e,n){for(n=n.child;n!==null;)Jv(t,e,n),n=n.sibling}function Jv(t,e,n){if(Sn&&typeof Sn.onCommitFiberUnmount=="function")try{Sn.onCommitFiberUnmount(gu,n)}catch{}switch(n.tag){case 5:$e||xi(n,e);case 6:var r=Le,i=Xt;Le=null,$n(t,e,n),Le=r,Xt=i,Le!==null&&(Xt?(t=Le,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Le.removeChild(n.stateNode));break;case 18:Le!==null&&(Xt?(t=Le,n=n.stateNode,t.nodeType===8?cc(t.parentNode,n):t.nodeType===1&&cc(t,n),so(t)):cc(Le,n.stateNode));break;case 4:r=Le,i=Xt,Le=n.stateNode.containerInfo,Xt=!0,$n(t,e,n),Le=r,Xt=i;break;case 0:case 11:case 14:case 15:if(!$e&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Xh(n,e,o),i=i.next}while(i!==r)}$n(t,e,n);break;case 1:if(!$e&&(xi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Se(n,e,l)}$n(t,e,n);break;case 21:$n(t,e,n);break;case 22:n.mode&1?($e=(r=$e)||n.memoizedState!==null,$n(t,e,n),$e=r):$n(t,e,n);break;default:$n(t,e,n)}}function Om(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Kb),e.forEach(function(r){var i=nC.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function qt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Le=l.stateNode,Xt=!1;break e;case 3:Le=l.stateNode.containerInfo,Xt=!0;break e;case 4:Le=l.stateNode.containerInfo,Xt=!0;break e}l=l.return}if(Le===null)throw Error(P(160));Jv(s,o,i),Le=null,Xt=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(u){Se(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Zv(e,t),e=e.sibling}function Zv(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(qt(e,t),ln(t),r&4){try{Hs(3,t,t.return),Cu(3,t)}catch(y){Se(t,t.return,y)}try{Hs(5,t,t.return)}catch(y){Se(t,t.return,y)}}break;case 1:qt(e,t),ln(t),r&512&&n!==null&&xi(n,n.return);break;case 5:if(qt(e,t),ln(t),r&512&&n!==null&&xi(n,n.return),t.flags&32){var i=t.stateNode;try{to(i,"")}catch(y){Se(t,t.return,y)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,l=t.type,a=t.updateQueue;if(t.updateQueue=null,a!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Sy(i,s),kh(l,o);var u=kh(l,s);for(o=0;o<a.length;o+=2){var c=a[o],h=a[o+1];c==="style"?Ay(i,h):c==="dangerouslySetInnerHTML"?Cy(i,h):c==="children"?to(i,h):hd(i,c,h,u)}switch(l){case"input":yh(i,s);break;case"textarea":ky(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?Mi(i,!!s.multiple,d,!1):f!==!!s.multiple&&(s.defaultValue!=null?Mi(i,!!s.multiple,s.defaultValue,!0):Mi(i,!!s.multiple,s.multiple?[]:"",!1))}i[co]=s}catch(y){Se(t,t.return,y)}}break;case 6:if(qt(e,t),ln(t),r&4){if(t.stateNode===null)throw Error(P(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(y){Se(t,t.return,y)}}break;case 3:if(qt(e,t),ln(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{so(e.containerInfo)}catch(y){Se(t,t.return,y)}break;case 4:qt(e,t),ln(t);break;case 13:qt(e,t),ln(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Ud=be())),r&4&&Om(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?($e=(u=$e)||c,qt(e,t),$e=u):qt(e,t),ln(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(F=t,c=t.child;c!==null;){for(h=F=c;F!==null;){switch(f=F,d=f.child,f.tag){case 0:case 11:case 14:case 15:Hs(4,f,f.return);break;case 1:xi(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(y){Se(r,n,y)}}break;case 5:xi(f,f.return);break;case 22:if(f.memoizedState!==null){Nm(h);continue}}d!==null?(d.return=f,F=d):Nm(h)}c=c.sibling}e:for(c=null,h=t;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=h.stateNode,a=h.memoizedProps.style,o=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=My("display",o))}catch(y){Se(t,t.return,y)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(y){Se(t,t.return,y)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:qt(e,t),ln(t),r&4&&Om(t);break;case 21:break;default:qt(e,t),ln(t)}}function ln(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Qv(n)){var r=n;break e}n=n.return}throw Error(P(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(to(i,""),r.flags&=-33);var s=Tm(t);Jh(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Tm(t);Qh(t,l,o);break;default:throw Error(P(161))}}catch(a){Se(t,t.return,a)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Gb(t,e,n){F=t,e1(t)}function e1(t,e,n){for(var r=(t.mode&1)!==0;F!==null;){var i=F,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||cl;if(!o){var l=i.alternate,a=l!==null&&l.memoizedState!==null||$e;l=cl;var u=$e;if(cl=o,($e=a)&&!u)for(F=i;F!==null;)o=F,a=o.child,o.tag===22&&o.memoizedState!==null?Lm(i):a!==null?(a.return=o,F=a):Lm(i);for(;s!==null;)F=s,e1(s),s=s.sibling;F=i,cl=l,$e=u}Rm(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,F=s):Rm(t)}}function Rm(t){for(;F!==null;){var e=F;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$e||Cu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!$e)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Gt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&gm(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}gm(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break;case"img":a.src&&(n.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&so(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(P(163))}$e||e.flags&512&&Yh(e)}catch(f){Se(e,e.return,f)}}if(e===t){F=null;break}if(n=e.sibling,n!==null){n.return=e.return,F=n;break}F=e.return}}function Nm(t){for(;F!==null;){var e=F;if(e===t){F=null;break}var n=e.sibling;if(n!==null){n.return=e.return,F=n;break}F=e.return}}function Lm(t){for(;F!==null;){var e=F;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Cu(4,e)}catch(a){Se(e,n,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){Se(e,i,a)}}var s=e.return;try{Yh(e)}catch(a){Se(e,s,a)}break;case 5:var o=e.return;try{Yh(e)}catch(a){Se(e,o,a)}}}catch(a){Se(e,e.return,a)}if(e===t){F=null;break}var l=e.sibling;if(l!==null){l.return=e.return,F=l;break}F=e.return}}var Xb=Math.ceil,Ba=Hn.ReactCurrentDispatcher,Vd=Hn.ReactCurrentOwner,It=Hn.ReactCurrentBatchConfig,ie=0,Ne=null,Ae=null,Fe=0,xt=0,Si=Cr(0),De=0,yo=null,Kr=0,Mu=0,Hd=0,Us=null,ct=null,Ud=0,Ui=1/0,Dn=null,_a=!1,Zh=null,fr=null,hl=!1,nr=null,Ia=0,$s=0,ef=null,ra=-1,ia=0;function rt(){return ie&6?be():ra!==-1?ra:ra=be()}function dr(t){return t.mode&1?ie&2&&Fe!==0?Fe&-Fe:Rb.transition!==null?(ia===0&&(ia=jy()),ia):(t=oe,t!==0||(t=window.event,t=t===void 0?16:$y(t.type)),t):1}function Zt(t,e,n,r){if(50<$s)throw $s=0,ef=null,Error(P(185));Bo(t,n,r),(!(ie&2)||t!==Ne)&&(t===Ne&&(!(ie&2)&&(Mu|=n),De===4&&Zn(t,Fe)),vt(t,r),n===1&&ie===0&&!(e.mode&1)&&(Ui=be()+500,Su&&Mr()))}function vt(t,e){var n=t.callbackNode;Rk(t,e);var r=xa(t,t===Ne?Fe:0);if(r===0)n!==null&&Hp(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Hp(n),e===1)t.tag===0?Ob(Bm.bind(null,t)):cv(Bm.bind(null,t)),Eb(function(){!(ie&6)&&Mr()}),n=null;else{switch(Fy(r)){case 1:n=gd;break;case 4:n=_y;break;case 16:n=wa;break;case 536870912:n=Iy;break;default:n=wa}n=a1(n,t1.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function t1(t,e){if(ra=-1,ia=0,ie&6)throw Error(P(327));var n=t.callbackNode;if(Ti()&&t.callbackNode!==n)return null;var r=xa(t,t===Ne?Fe:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ja(t,r);else{e=r;var i=ie;ie|=2;var s=r1();(Ne!==t||Fe!==e)&&(Dn=null,Ui=be()+500,Fr(t,e));do try{Jb();break}catch(l){n1(t,l)}while(!0);Dd(),Ba.current=s,ie=i,Ae!==null?e=0:(Ne=null,Fe=0,e=De)}if(e!==0){if(e===2&&(i=Eh(t),i!==0&&(r=i,e=tf(t,i))),e===1)throw n=yo,Fr(t,0),Zn(t,r),vt(t,be()),n;if(e===6)Zn(t,r);else{if(i=t.current.alternate,!(r&30)&&!Yb(i)&&(e=ja(t,r),e===2&&(s=Eh(t),s!==0&&(r=s,e=tf(t,s))),e===1))throw n=yo,Fr(t,0),Zn(t,r),vt(t,be()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(P(345));case 2:Tr(t,ct,Dn);break;case 3:if(Zn(t,r),(r&130023424)===r&&(e=Ud+500-be(),10<e)){if(xa(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){rt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Bh(Tr.bind(null,t,ct,Dn),e);break}Tr(t,ct,Dn);break;case 4:if(Zn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Jt(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Xb(r/1960))-r,10<r){t.timeoutHandle=Bh(Tr.bind(null,t,ct,Dn),r);break}Tr(t,ct,Dn);break;case 5:Tr(t,ct,Dn);break;default:throw Error(P(329))}}}return vt(t,be()),t.callbackNode===n?t1.bind(null,t):null}function tf(t,e){var n=Us;return t.current.memoizedState.isDehydrated&&(Fr(t,e).flags|=256),t=ja(t,e),t!==2&&(e=ct,ct=n,e!==null&&nf(e)),t}function nf(t){ct===null?ct=t:ct.push.apply(ct,t)}function Yb(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!en(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zn(t,e){for(e&=~Hd,e&=~Mu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Jt(e),r=1<<n;t[n]=-1,e&=~r}}function Bm(t){if(ie&6)throw Error(P(327));Ti();var e=xa(t,0);if(!(e&1))return vt(t,be()),null;var n=ja(t,e);if(t.tag!==0&&n===2){var r=Eh(t);r!==0&&(e=r,n=tf(t,r))}if(n===1)throw n=yo,Fr(t,0),Zn(t,e),vt(t,be()),n;if(n===6)throw Error(P(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Tr(t,ct,Dn),vt(t,be()),null}function $d(t,e){var n=ie;ie|=1;try{return t(e)}finally{ie=n,ie===0&&(Ui=be()+500,Su&&Mr())}}function qr(t){nr!==null&&nr.tag===0&&!(ie&6)&&Ti();var e=ie;ie|=1;var n=It.transition,r=oe;try{if(It.transition=null,oe=1,t)return t()}finally{oe=r,It.transition=n,ie=e,!(ie&6)&&Mr()}}function Kd(){xt=Si.current,de(Si)}function Fr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Ab(n)),Ae!==null)for(n=Ae.return;n!==null;){var r=n;switch(Ad(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ma();break;case 3:Vi(),de(gt),de(Ge),Bd();break;case 5:Ld(r);break;case 4:Vi();break;case 13:de(ve);break;case 19:de(ve);break;case 10:Td(r.type._context);break;case 22:case 23:Kd()}n=n.return}if(Ne=t,Ae=t=pr(t.current,null),Fe=xt=e,De=0,yo=null,Hd=Mu=Kr=0,ct=Us=null,Br!==null){for(e=0;e<Br.length;e++)if(n=Br[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Br=null}return t}function n1(t,e){do{var n=Ae;try{if(Dd(),ea.current=La,Na){for(var r=we.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Na=!1}if($r=0,Oe=Ee=we=null,Vs=!1,po=0,Vd.current=null,n===null||n.return===null){De=1,yo=e,Ae=null;break}e:{var s=t,o=n.return,l=n,a=e;if(e=Fe,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,c=l,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var d=km(o);if(d!==null){d.flags&=-257,bm(d,o,l,s,e),d.mode&1&&Sm(s,u,e),e=d,a=u;var p=e.updateQueue;if(p===null){var y=new Set;y.add(a),e.updateQueue=y}else p.add(a);break e}else{if(!(e&1)){Sm(s,u,e),qd();break e}a=Error(P(426))}}else if(ge&&l.mode&1){var w=km(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),bm(w,o,l,s,e),Ed(Hi(a,l));break e}}s=a=Hi(a,l),De!==4&&(De=2),Us===null?Us=[s]:Us.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=Fv(s,a,e);mm(s,m);break e;case 1:l=a;var g=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof g.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(fr===null||!fr.has(v)))){s.flags|=65536,e&=-e,s.lanes|=e;var x=zv(s,l,e);mm(s,x);break e}}s=s.return}while(s!==null)}s1(n)}catch(k){e=k,Ae===n&&n!==null&&(Ae=n=n.return);continue}break}while(!0)}function r1(){var t=Ba.current;return Ba.current=La,t===null?La:t}function qd(){(De===0||De===3||De===2)&&(De=4),Ne===null||!(Kr&268435455)&&!(Mu&268435455)||Zn(Ne,Fe)}function ja(t,e){var n=ie;ie|=2;var r=r1();(Ne!==t||Fe!==e)&&(Dn=null,Fr(t,e));do try{Qb();break}catch(i){n1(t,i)}while(!0);if(Dd(),ie=n,Ba.current=r,Ae!==null)throw Error(P(261));return Ne=null,Fe=0,De}function Qb(){for(;Ae!==null;)i1(Ae)}function Jb(){for(;Ae!==null&&!bk();)i1(Ae)}function i1(t){var e=l1(t.alternate,t,xt);t.memoizedProps=t.pendingProps,e===null?s1(t):Ae=e,Vd.current=null}function s1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=$b(n,e),n!==null){n.flags&=32767,Ae=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{De=6,Ae=null;return}}else if(n=Ub(n,e,xt),n!==null){Ae=n;return}if(e=e.sibling,e!==null){Ae=e;return}Ae=e=t}while(e!==null);De===0&&(De=5)}function Tr(t,e,n){var r=oe,i=It.transition;try{It.transition=null,oe=1,Zb(t,e,n,r)}finally{It.transition=i,oe=r}return null}function Zb(t,e,n,r){do Ti();while(nr!==null);if(ie&6)throw Error(P(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(P(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(Nk(t,s),t===Ne&&(Ae=Ne=null,Fe=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||hl||(hl=!0,a1(wa,function(){return Ti(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=It.transition,It.transition=null;var o=oe;oe=1;var l=ie;ie|=4,Vd.current=null,qb(t,n),Zv(n,t),wb(Nh),Sa=!!Rh,Nh=Rh=null,t.current=n,Gb(n),Ck(),ie=l,oe=o,It.transition=s}else t.current=n;if(hl&&(hl=!1,nr=t,Ia=i),s=t.pendingLanes,s===0&&(fr=null),Ek(n.stateNode),vt(t,be()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(_a)throw _a=!1,t=Zh,Zh=null,t;return Ia&1&&t.tag!==0&&Ti(),s=t.pendingLanes,s&1?t===ef?$s++:($s=0,ef=t):$s=0,Mr(),null}function Ti(){if(nr!==null){var t=Fy(Ia),e=It.transition,n=oe;try{if(It.transition=null,oe=16>t?16:t,nr===null)var r=!1;else{if(t=nr,nr=null,Ia=0,ie&6)throw Error(P(331));var i=ie;for(ie|=4,F=t.current;F!==null;){var s=F,o=s.child;if(F.flags&16){var l=s.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(F=u;F!==null;){var c=F;switch(c.tag){case 0:case 11:case 15:Hs(8,c,s)}var h=c.child;if(h!==null)h.return=c,F=h;else for(;F!==null;){c=F;var f=c.sibling,d=c.return;if(Yv(c),c===u){F=null;break}if(f!==null){f.return=d,F=f;break}F=d}}}var p=s.alternate;if(p!==null){var y=p.child;if(y!==null){p.child=null;do{var w=y.sibling;y.sibling=null,y=w}while(y!==null)}}F=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,F=o;else e:for(;F!==null;){if(s=F,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Hs(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,F=m;break e}F=s.return}}var g=t.current;for(F=g;F!==null;){o=F;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,F=v;else e:for(o=g;F!==null;){if(l=F,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Cu(9,l)}}catch(k){Se(l,l.return,k)}if(l===o){F=null;break e}var x=l.sibling;if(x!==null){x.return=l.return,F=x;break e}F=l.return}}if(ie=i,Mr(),Sn&&typeof Sn.onPostCommitFiberRoot=="function")try{Sn.onPostCommitFiberRoot(gu,t)}catch{}r=!0}return r}finally{oe=n,It.transition=e}}return!1}function _m(t,e,n){e=Hi(n,e),e=Fv(t,e,1),t=hr(t,e,1),e=rt(),t!==null&&(Bo(t,1,e),vt(t,e))}function Se(t,e,n){if(t.tag===3)_m(t,t,n);else for(;e!==null;){if(e.tag===3){_m(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(fr===null||!fr.has(r))){t=Hi(n,t),t=zv(e,t,1),e=hr(e,t,1),t=rt(),e!==null&&(Bo(e,1,t),vt(e,t));break}}e=e.return}}function eC(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=rt(),t.pingedLanes|=t.suspendedLanes&n,Ne===t&&(Fe&n)===n&&(De===4||De===3&&(Fe&130023424)===Fe&&500>be()-Ud?Fr(t,0):Hd|=n),vt(t,e)}function o1(t,e){e===0&&(t.mode&1?(e=tl,tl<<=1,!(tl&130023424)&&(tl=4194304)):e=1);var n=rt();t=jn(t,e),t!==null&&(Bo(t,e,n),vt(t,n))}function tC(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),o1(t,n)}function nC(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(P(314))}r!==null&&r.delete(e),o1(t,n)}var l1;l1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||gt.current)dt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return dt=!1,Hb(t,e,n);dt=!!(t.flags&131072)}else dt=!1,ge&&e.flags&1048576&&hv(e,Pa,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;na(t,e),t=e.pendingProps;var i=Fi(e,Ge.current);Di(e,n),i=Id(null,e,r,t,i,n);var s=jd();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,yt(r)?(s=!0,Aa(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Rd(e),i.updater=bu,e.stateNode=i,i._reactInternals=e,Vh(e,r,t,n),e=$h(null,e,r,!0,s,n)):(e.tag=0,ge&&s&&Md(e),et(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(na(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=iC(r),t=Gt(r,t),i){case 0:e=Uh(null,e,r,t,n);break e;case 1:e=Am(null,e,r,t,n);break e;case 11:e=Cm(null,e,r,t,n);break e;case 14:e=Mm(null,e,r,Gt(r.type,t),n);break e}throw Error(P(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Gt(r,i),Uh(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Gt(r,i),Am(t,e,r,i,n);case 3:e:{if(Uv(e),t===null)throw Error(P(387));r=e.pendingProps,s=e.memoizedState,i=s.element,yv(t,e),Oa(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Hi(Error(P(423)),e),e=Em(t,e,r,n,i);break e}else if(r!==i){i=Hi(Error(P(424)),e),e=Em(t,e,r,n,i);break e}else for(kt=cr(e.stateNode.containerInfo.firstChild),Ct=e,ge=!0,Yt=null,n=mv(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(zi(),r===i){e=Fn(t,e,n);break e}et(t,e,r,n)}e=e.child}return e;case 5:return vv(e),t===null&&Fh(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Lh(r,i)?o=null:s!==null&&Lh(r,s)&&(e.flags|=32),Hv(t,e),et(t,e,o,n),e.child;case 6:return t===null&&Fh(e),null;case 13:return $v(t,e,n);case 4:return Nd(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Wi(e,null,r,n):et(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Gt(r,i),Cm(t,e,r,i,n);case 7:return et(t,e,e.pendingProps,n),e.child;case 8:return et(t,e,e.pendingProps.children,n),e.child;case 12:return et(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,ce(Da,r._currentValue),r._currentValue=o,s!==null)if(en(s.value,o)){if(s.children===i.children&&!gt.current){e=Fn(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(s.tag===1){a=Ln(-1,n&-n),a.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?a.next=a:(a.next=c.next,c.next=a),u.pending=a}}s.lanes|=n,a=s.alternate,a!==null&&(a.lanes|=n),zh(s.return,n,e),l.lanes|=n;break}a=a.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(P(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),zh(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}et(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Di(e,n),i=zt(i),r=r(i),e.flags|=1,et(t,e,r,n),e.child;case 14:return r=e.type,i=Gt(r,e.pendingProps),i=Gt(r.type,i),Mm(t,e,r,i,n);case 15:return Wv(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Gt(r,i),na(t,e),e.tag=1,yt(r)?(t=!0,Aa(e)):t=!1,Di(e,n),jv(e,r,i),Vh(e,r,i,n),$h(null,e,r,!0,t,n);case 19:return Kv(t,e,n);case 22:return Vv(t,e,n)}throw Error(P(156,e.tag))};function a1(t,e){return By(t,e)}function rC(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Lt(t,e,n,r){return new rC(t,e,n,r)}function Gd(t){return t=t.prototype,!(!t||!t.isReactComponent)}function iC(t){if(typeof t=="function")return Gd(t)?1:0;if(t!=null){if(t=t.$$typeof,t===dd)return 11;if(t===pd)return 14}return 2}function pr(t,e){var n=t.alternate;return n===null?(n=Lt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function sa(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Gd(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case hi:return zr(n.children,i,s,e);case fd:o=8,i|=8;break;case fh:return t=Lt(12,n,e,i|2),t.elementType=fh,t.lanes=s,t;case dh:return t=Lt(13,n,e,i),t.elementType=dh,t.lanes=s,t;case ph:return t=Lt(19,n,e,i),t.elementType=ph,t.lanes=s,t;case vy:return Au(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case gy:o=10;break e;case yy:o=9;break e;case dd:o=11;break e;case pd:o=14;break e;case Gn:o=16,r=null;break e}throw Error(P(130,t==null?t:typeof t,""))}return e=Lt(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function zr(t,e,n,r){return t=Lt(7,t,r,e),t.lanes=n,t}function Au(t,e,n,r){return t=Lt(22,t,r,e),t.elementType=vy,t.lanes=n,t.stateNode={isHidden:!1},t}function vc(t,e,n){return t=Lt(6,t,null,e),t.lanes=n,t}function wc(t,e,n){return e=Lt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function sC(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zu(0),this.expirationTimes=Zu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zu(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Xd(t,e,n,r,i,s,o,l,a){return t=new sC(t,e,n,l,a),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Lt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rd(s),t}function oC(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ci,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function u1(t){if(!t)return yr;t=t._reactInternals;e:{if(ti(t)!==t||t.tag!==1)throw Error(P(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(yt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(P(171))}if(t.tag===1){var n=t.type;if(yt(n))return uv(t,n,e)}return e}function c1(t,e,n,r,i,s,o,l,a){return t=Xd(n,r,!0,t,i,s,o,l,a),t.context=u1(null),n=t.current,r=rt(),i=dr(n),s=Ln(r,i),s.callback=e??null,hr(n,s,i),t.current.lanes=i,Bo(t,i,r),vt(t,r),t}function Eu(t,e,n,r){var i=e.current,s=rt(),o=dr(i);return n=u1(n),e.context===null?e.context=n:e.pendingContext=n,e=Ln(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=hr(i,e,o),t!==null&&(Zt(t,i,o,s),Zl(t,i,o)),o}function Fa(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Im(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Yd(t,e){Im(t,e),(t=t.alternate)&&Im(t,e)}function lC(){return null}var h1=typeof reportError=="function"?reportError:function(t){console.error(t)};function Qd(t){this._internalRoot=t}Pu.prototype.render=Qd.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(P(409));Eu(t,e,null,null)};Pu.prototype.unmount=Qd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;qr(function(){Eu(null,t,null,null)}),e[In]=null}};function Pu(t){this._internalRoot=t}Pu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Vy();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Jn.length&&e!==0&&e<Jn[n].priority;n++);Jn.splice(n,0,t),n===0&&Uy(t)}};function Jd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Du(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function jm(){}function aC(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Fa(o);s.call(u)}}var o=c1(e,r,t,0,null,!1,!1,"",jm);return t._reactRootContainer=o,t[In]=o.current,ao(t.nodeType===8?t.parentNode:t),qr(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=Fa(a);l.call(u)}}var a=Xd(t,0,!1,null,null,!1,!1,"",jm);return t._reactRootContainer=a,t[In]=a.current,ao(t.nodeType===8?t.parentNode:t),qr(function(){Eu(e,a,n,r)}),a}function Tu(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var a=Fa(o);l.call(a)}}Eu(e,o,t,i)}else o=aC(n,e,t,i,r);return Fa(o)}zy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ts(e.pendingLanes);n!==0&&(yd(e,n|1),vt(e,be()),!(ie&6)&&(Ui=be()+500,Mr()))}break;case 13:qr(function(){var r=jn(t,1);if(r!==null){var i=rt();Zt(r,t,1,i)}}),Yd(t,1)}};vd=function(t){if(t.tag===13){var e=jn(t,134217728);if(e!==null){var n=rt();Zt(e,t,134217728,n)}Yd(t,134217728)}};Wy=function(t){if(t.tag===13){var e=dr(t),n=jn(t,e);if(n!==null){var r=rt();Zt(n,t,e,r)}Yd(t,e)}};Vy=function(){return oe};Hy=function(t,e){var n=oe;try{return oe=t,e()}finally{oe=n}};Ch=function(t,e,n){switch(e){case"input":if(yh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=xu(r);if(!i)throw Error(P(90));xy(r),yh(r,i)}}}break;case"textarea":ky(t,n);break;case"select":e=n.value,e!=null&&Mi(t,!!n.multiple,e,!1)}};Dy=$d;Ty=qr;var uC={usingClientEntryPoint:!1,Events:[Io,mi,xu,Ey,Py,$d]},ds={findFiberByHostInstance:Lr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},cC={bundleType:ds.bundleType,version:ds.version,rendererPackageName:ds.rendererPackageName,rendererConfig:ds.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ny(t),t===null?null:t.stateNode},findFiberByHostInstance:ds.findFiberByHostInstance||lC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fl.isDisabled&&fl.supportsFiber)try{gu=fl.inject(cC),Sn=fl}catch{}}At.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uC;At.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jd(e))throw Error(P(200));return oC(t,e,null,n)};At.createRoot=function(t,e){if(!Jd(t))throw Error(P(299));var n=!1,r="",i=h1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Xd(t,1,!1,null,null,n,!1,r,i),t[In]=e.current,ao(t.nodeType===8?t.parentNode:t),new Qd(e)};At.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(P(188)):(t=Object.keys(t).join(","),Error(P(268,t)));return t=Ny(e),t=t===null?null:t.stateNode,t};At.flushSync=function(t){return qr(t)};At.hydrate=function(t,e,n){if(!Du(e))throw Error(P(200));return Tu(null,t,e,!0,n)};At.hydrateRoot=function(t,e,n){if(!Jd(t))throw Error(P(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=h1;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=c1(e,null,t,1,n??null,i,!1,s,o),t[In]=e.current,ao(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Pu(e)};At.render=function(t,e,n){if(!Du(e))throw Error(P(200));return Tu(null,t,e,!1,n)};At.unmountComponentAtNode=function(t){if(!Du(t))throw Error(P(40));return t._reactRootContainer?(qr(function(){Tu(null,null,t,!1,function(){t._reactRootContainer=null,t[In]=null})}),!0):!1};At.unstable_batchedUpdates=$d;At.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Du(n))throw Error(P(200));if(t==null||t._reactInternals===void 0)throw Error(P(38));return Tu(t,e,n,!1,r)};At.version="18.3.1-next-f1338f8080-20240426";function f1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(f1)}catch(t){console.error(t)}}f1(),fy.exports=At;var hC=fy.exports,Fm=hC;ch.createRoot=Fm.createRoot,ch.hydrateRoot=Fm.hydrateRoot;const fC={},zm=t=>{let e;const n=new Set,r=(c,h)=>{const f=typeof c=="function"?c(e):c;if(!Object.is(f,e)){const d=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(p=>p(e,d))}},i=()=>e,a={setState:r,getState:i,getInitialState:()=>u,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>{(fC?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=e=t(r,i,a);return a},dC=t=>t?zm(t):zm;var d1={exports:{}},p1={},m1={exports:{}},g1={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $i=W;function pC(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var mC=typeof Object.is=="function"?Object.is:pC,gC=$i.useState,yC=$i.useEffect,vC=$i.useLayoutEffect,wC=$i.useDebugValue;function xC(t,e){var n=e(),r=gC({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return vC(function(){i.value=n,i.getSnapshot=e,xc(i)&&s({inst:i})},[t,n,e]),yC(function(){return xc(i)&&s({inst:i}),t(function(){xc(i)&&s({inst:i})})},[t]),wC(n),n}function xc(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!mC(t,n)}catch{return!0}}function SC(t,e){return e()}var kC=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?SC:xC;g1.useSyncExternalStore=$i.useSyncExternalStore!==void 0?$i.useSyncExternalStore:kC;m1.exports=g1;var bC=m1.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ou=W,CC=bC;function MC(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var AC=typeof Object.is=="function"?Object.is:MC,EC=CC.useSyncExternalStore,PC=Ou.useRef,DC=Ou.useEffect,TC=Ou.useMemo,OC=Ou.useDebugValue;p1.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var s=PC(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=TC(function(){function a(d){if(!u){if(u=!0,c=d,d=r(d),i!==void 0&&o.hasValue){var p=o.value;if(i(p,d))return h=p}return h=d}if(p=h,AC(c,d))return p;var y=r(d);return i!==void 0&&i(p,y)?(c=d,p):(c=d,h=y)}var u=!1,c,h,f=n===void 0?null:n;return[function(){return a(e())},f===null?void 0:function(){return a(f())}]},[e,n,r,i]);var l=EC(t,s[0],s[1]);return DC(function(){o.hasValue=!0,o.value=l},[l]),OC(l),l};d1.exports=p1;var RC=d1.exports;const NC=Z0(RC),y1={},{useDebugValue:LC}=cy,{useSyncExternalStoreWithSelector:BC}=NC;let Wm=!1;const _C=t=>t;function IC(t,e=_C,n){(y1?"production":void 0)!=="production"&&n&&!Wm&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Wm=!0);const r=BC(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return LC(r),r}const Vm=t=>{(y1?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?dC(t):t,n=(r,i)=>IC(e,r,i);return Object.assign(n,e),n},jC=t=>t?Vm(t):Vm,Zd="shaderlm-conversation",dl=t=>{try{const e={messages:t.messages,currentShader:t.currentShader,vertexShader:t.vertexShader,shaderHistory:t.shaderHistory,lastUpdated:Date.now()};localStorage.setItem(Zd,JSON.stringify(e))}catch(e){console.error("Failed to save conversation to localStorage:",e)}},FC=()=>{try{const t=localStorage.getItem(Zd);if(!t)return null;const e=JSON.parse(t);return!e.messages||!Array.isArray(e.messages)?null:e}catch(t){return console.error("Failed to load conversation from localStorage:",t),null}},zC=()=>{try{localStorage.removeItem(Zd)}catch(t){console.error("Failed to clear conversation from localStorage:",t)}};let Sc=null;async function v1(){if(Sc)return Sc;if(!navigator.gpu)throw new Error("WebGPU is not supported in this browser");const t=await navigator.gpu.requestAdapter();if(!t)throw new Error("Failed to get GPU adapter");const e=await t.requestDevice();return Sc=e,e}async function WC(t){try{const r=await(await v1()).createShaderModule({code:t,label:"Validation Shader"}).getCompilationInfo(),i=r.messages.filter(l=>l.type==="error"),s=r.messages.filter(l=>l.type==="warning").map(l=>`Line ${l.lineNum}: ${l.message}`);if(i.length>0)return{success:!1,error:i.map(a=>`Line ${a.lineNum}: ${a.message}`).join(`
`),warnings:s.length>0?s:void 0};const o=VC(t);return{success:!0,warnings:s.length>0?s:void 0,metadata:o}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown validation error"}}}function VC(t){const e=t.match(/@(?:vertex|fragment|compute)\s+fn\s+(\w+)/),n=e?e[1]:"main",i=t.includes("@compute")?"compute":"render",s=/@group\((\d+)\)\s+@binding\((\d+)\)\s+var(?:<([^>]+)>)?\s+(\w+):\s*(\w+)/g,o=[];let l;for(;(l=s.exec(t))!==null;){const[,c,h,f,,d]=l;let p="uniform";f!=null&&f.includes("storage")?p="storage":d.includes("texture")?p="texture":d.includes("sampler")&&(p="sampler"),o.push({group:parseInt(c),binding:parseInt(h),type:p,visibility:"all"})}const a=/@location\((\d+)\)\s+(\w+):\s*([^,\)]+)/g,u=[];for(;(l=a.exec(t))!==null;)u.push({location:parseInt(l[1]),name:l[2],type:l[3].trim()});return{entryPoint:n,bindingLayout:o,usage:i,inputs:u.length>0?u:void 0}}function Hm(){return{supported:"gpu"in navigator}}function w1(t){const e=[],n=t.match(/struct\s+Uniforms\s*\{([^}]+)\}/);if(!n)return e;const r=n[1],i=/(\w+):\s*(f32|i32|u32|vec2<f32>|vec3<f32>|vec4<f32>)\s*,?/g;let s;for(;(s=i.exec(r))!==null;){const o=s[1],l=s[2];if(o==="time"||o==="resolution")continue;const a=HC(o,l);e.push(a)}return e}function HC(t,e){const n=t.toLowerCase();if(e==="f32"||e==="i32"||e==="u32"){let r=1,i=0,s=10,o=.1;return n.includes("count")||n.includes("num")||n.includes("rows")||n.includes("columns")?(r=5,i=1,s=20,o=1):n.includes("speed")?(r=1,i=0,s=5,o=.1):n.includes("scale")?(r=1,i=.1,s=5,o=.1):n.includes("radius")||n.includes("size")?(r=.5,i=0,s=2,o=.05):(n.includes("intensity")||n.includes("strength"))&&(r=1,i=0,s=2,o=.1),{name:t,type:e,defaultValue:r,min:i,max:s,step:o}}return e==="vec2<f32>"?{name:t,type:e,defaultValue:[.5,.5],min:-2,max:2,step:.05}:e==="vec3<f32>"?{name:t,type:e,defaultValue:[1,1,1],min:0,max:1,step:.01}:e==="vec4<f32>"?{name:t,type:e,defaultValue:[1,1,1,1],min:0,max:1,step:.01}:{name:t,type:e,defaultValue:1,min:0,max:10,step:.1}}function UC(t){const e=new Map;let n=0;e.set("time",0),n+=4,n=kc(n,8),e.set("resolution",n),n+=8;for(const i of t){const{size:s,alignment:o}=$C(i.type);n=kc(n,o),e.set(i.name,n),n+=s}return{size:kc(n,16),offsets:e}}function $C(t){switch(t){case"f32":case"i32":case"u32":return{size:4,alignment:4};case"vec2<f32>":return{size:8,alignment:8};case"vec3<f32>":return{size:12,alignment:16};case"vec4<f32>":return{size:16,alignment:16};default:return{size:4,alignment:4}}}function kc(t,e){return Math.ceil(t/e)*e}function KC(t,e,n,r,i){const s=new Float32Array(i.size/4),o=i.offsets.get("time")/4;s[o]=t;const l=i.offsets.get("resolution")/4;s[l]=e[0],s[l+1]=e[1];for(const a of r){const u=i.offsets.get(a.name)/4,c=n[a.name]??a.defaultValue;if(Array.isArray(c))for(let h=0;h<c.length;h++)s[u+h]=c[h];else s[u]=c}return s}class qC{constructor(){Kt(this,"device",null);Kt(this,"context",null);Kt(this,"pipeline",null);Kt(this,"uniformBuffer",null);Kt(this,"bindGroup",null);Kt(this,"animationId",null);Kt(this,"startTime",0);Kt(this,"uniformFields",[]);Kt(this,"uniformLayout",null);Kt(this,"customUniformValues",{})}async initialize(e){this.device=await v1();const n=e.getContext("webgpu");if(!n)throw new Error("Failed to get WebGPU context");this.context=n;const r=navigator.gpu.getPreferredCanvasFormat();n.configure({device:this.device,format:r,alphaMode:"premultiplied"})}async renderShader(e,n,r){if(!this.device||!this.context)throw new Error("Renderer not initialized");this.cleanup(),this.uniformFields=w1(n),this.uniformLayout=UC(this.uniformFields),this.customUniformValues={},this.uniformFields.forEach(a=>{this.customUniformValues[a.name]=a.defaultValue});const i=this.device.createShaderModule({code:e,label:"Vertex Shader"}),s=this.device.createShaderModule({code:n,label:"Fragment Shader"});this.uniformBuffer=this.device.createBuffer({size:this.uniformLayout.size,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});const o=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}}]});this.bindGroup=this.device.createBindGroup({layout:o,entries:[{binding:0,resource:{buffer:this.uniformBuffer}}]});const l=this.device.createPipelineLayout({bindGroupLayouts:[o]});this.pipeline=this.device.createRenderPipeline({layout:l,vertex:{module:i,entryPoint:(r==null?void 0:r.entryPoint)||"vs_main"},fragment:{module:s,entryPoint:"fs_main",targets:[{format:navigator.gpu.getPreferredCanvasFormat()}]},primitive:{topology:"triangle-list"}}),this.startTime=Date.now(),this.startAnimation()}startAnimation(){const e=()=>{this.frame(),this.animationId=requestAnimationFrame(e)};e()}updateCustomUniforms(e){this.customUniformValues={...this.customUniformValues,...e}}frame(){if(!this.device||!this.context||!this.pipeline||!this.uniformBuffer||!this.bindGroup||!this.uniformLayout)return;const e=this.context.canvas,n=(Date.now()-this.startTime)/1e3,r=KC(n,[e.width,e.height],this.customUniformValues,this.uniformFields,this.uniformLayout);this.device.queue.writeBuffer(this.uniformBuffer,0,r.buffer,r.byteOffset,r.byteLength);const i=this.device.createCommandEncoder(),s=this.context.getCurrentTexture().createView(),o=i.beginRenderPass({colorAttachments:[{view:s,clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});o.setPipeline(this.pipeline),o.setBindGroup(0,this.bindGroup),o.draw(3),o.end(),this.device.queue.submit([i.finish()])}cleanup(){this.animationId!==null&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.uniformBuffer&&(this.uniformBuffer.destroy(),this.uniformBuffer=null),this.pipeline=null,this.bindGroup=null}destroy(){this.cleanup(),this.device=null,this.context=null}}const GC=`
@vertex
fn vs_main(@builtin(vertex_index) vertexIndex: u32) -> @builtin(position) vec4<f32> {
    // Full-screen triangle
    var pos = array<vec2<f32>, 3>(
        vec2<f32>(-1.0, -1.0),
        vec2<f32>(3.0, -1.0),
        vec2<f32>(-1.0, 3.0)
    );
    return vec4<f32>(pos[vertexIndex], 0.0, 1.0);
}
`,XC=()=>`${Date.now()}-${Math.random().toString(36).substring(2,9)}`,Um={messages:[],currentShader:"",vertexShader:GC,isGenerating:!1,error:null,shaderHistory:[]},x1=jC(t=>({...Um,addMessage:e=>{const n={...e,id:XC(),timestamp:Date.now()};t(r=>{const i=[...r.messages,n];return dl({messages:i,currentShader:r.currentShader,vertexShader:r.vertexShader,shaderHistory:r.shaderHistory}),{messages:i}})},updateLastMessage:e=>{t(n=>{const r=[...n.messages];return r.length>0&&(r[r.length-1]={...r[r.length-1],content:e}),dl({messages:r,currentShader:n.currentShader,vertexShader:n.vertexShader,shaderHistory:n.shaderHistory}),{messages:r}})},setCurrentShader:(e,n)=>{t(r=>{const i=n?[...r.shaderHistory,{code:e,timestamp:Date.now(),messageId:n}]:r.shaderHistory;return dl({messages:r.messages,currentShader:e,vertexShader:r.vertexShader,shaderHistory:i}),{currentShader:e,shaderHistory:i}})},setVertexShader:e=>{t(n=>(dl({messages:n.messages,currentShader:n.currentShader,vertexShader:e,shaderHistory:n.shaderHistory}),{vertexShader:e}))},setIsGenerating:e=>{t({isGenerating:e})},setError:e=>{t({error:e})},clearConversation:()=>{zC(),t(Um)},loadFromStorage:()=>{const e=FC();e&&t({messages:e.messages,currentShader:e.currentShader,vertexShader:e.vertexShader,shaderHistory:e.shaderHistory})}})),YC=["A colorful animated gradient","A pulsing circle with glow effect","Wavy water effect","Fractal noise pattern","Rotating rainbow spiral"];function QC({onSendMessage:t,onOpenApiKeyDialog:e}){const[n,r]=W.useState(""),i=W.useRef(null),s=W.useRef(null),{messages:o,isGenerating:l,clearConversation:a}=x1(),u=()=>{var w;(w=i.current)==null||w.scrollIntoView({behavior:"smooth"})};W.useEffect(()=>{u()},[o]);const c=w=>{w.preventDefault(),n.trim()&&!l&&(t(n.trim()),r(""))},h=w=>{w.key==="Enter"&&(w.ctrlKey||w.metaKey)&&(w.preventDefault(),c(w))},f=w=>{var m;l||(r(w),(m=s.current)==null||m.focus())},d=w=>{navigator.clipboard.writeText(w)},p=w=>new Date(w).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),y=()=>{window.confirm("Are you sure you want to clear the conversation? This cannot be undone.")&&a()};return S.jsxs("div",{className:"flex flex-col h-full bg-gray-800 border-r border-gray-700",children:[S.jsxs("div",{className:"flex-shrink-0 p-4 border-b border-gray-700",children:[S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("h2",{className:"text-lg font-semibold text-white",children:"Shader Chat"}),S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("button",{onClick:e,className:"p-1.5 text-gray-400 hover:text-white hover:bg-gray-700 rounded transition-colors",title:"Edit API Key",children:S.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),o.length>0&&S.jsx("button",{onClick:y,className:"text-xs px-2 py-1 text-gray-400 hover:text-white hover:bg-gray-700 rounded transition-colors",title:"Clear conversation",children:"Clear"})]})]}),S.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Describe shaders and refine them iteratively"})]}),S.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[o.length===0?S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{className:"text-center text-gray-400 py-8",children:[S.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),S.jsx("p",{className:"text-sm mb-2",children:"Start a conversation to generate a shader"}),S.jsx("p",{className:"text-xs text-gray-500",children:"Try one of these examples:"})]}),S.jsx("div",{className:"space-y-2",children:YC.map((w,m)=>S.jsx("button",{onClick:()=>f(w),disabled:l,className:"w-full text-left px-4 py-3 bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 disabled:cursor-not-allowed rounded-lg transition-colors text-sm",children:w},m))})]}):S.jsxs(S.Fragment,{children:[o.map(w=>{var m;return S.jsx("div",{className:`flex ${w.role==="user"?"justify-end":"justify-start"}`,children:S.jsxs("div",{className:`max-w-[85%] rounded-lg px-4 py-2 ${w.role==="user"?"bg-blue-600 text-white":w.role==="system"?"bg-red-900 text-red-100":"bg-gray-700 text-gray-100"}`,children:[S.jsxs("div",{className:"flex items-start justify-between gap-2",children:[S.jsx("div",{className:"flex-1 whitespace-pre-wrap break-words text-sm",children:w.content}),w.role==="assistant"&&S.jsx("button",{onClick:()=>d(w.content),className:"flex-shrink-0 text-gray-400 hover:text-white transition-colors",title:"Copy message",children:S.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),S.jsx("div",{className:"text-xs mt-1 opacity-70",children:p(w.timestamp)}),((m=w.metadata)==null?void 0:m.validationError)&&S.jsx("div",{className:"mt-2 p-2 bg-red-900/50 rounded text-xs font-mono",children:w.metadata.validationError})]})},w.id)}),l&&S.jsx("div",{className:"flex justify-start",children:S.jsx("div",{className:"bg-gray-700 text-gray-100 rounded-lg px-4 py-2",children:S.jsxs("div",{className:"flex items-center space-x-2",children:[S.jsxs("div",{className:"flex space-x-1",children:[S.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),S.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),S.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),S.jsx("span",{className:"text-sm text-gray-400",children:"Generating..."})]})})})]}),S.jsx("div",{ref:i})]}),S.jsx("div",{className:"flex-shrink-0 p-4 border-t border-gray-700",children:S.jsxs("form",{onSubmit:c,className:"space-y-2",children:[S.jsx("textarea",{ref:s,value:n,onChange:w=>r(w.target.value),onKeyDown:h,placeholder:o.length===0?"Describe the shader you want to create...":"Describe how to refine the shader...",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none text-white placeholder-gray-400 text-sm",rows:3,disabled:l}),S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsx("p",{className:"text-xs text-gray-500",children:"Ctrl+Enter to send"}),S.jsx("button",{type:"submit",disabled:!n.trim()||l,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg font-medium transition-colors text-sm",children:l?"Generating...":"Send"})]})]})})]})}function rf(){return rf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rf.apply(null,arguments)}function JC(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}let sf=[],S1=[];(()=>{let t="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,n=0;e<t.length;e++)(e%2?S1:sf).push(n=n+t[e])})();function ZC(t){if(t<768)return!1;for(let e=0,n=sf.length;;){let r=e+n>>1;if(t<sf[r])n=r;else if(t>=S1[r])e=r+1;else return!0;if(e==n)return!1}}function $m(t){return t>=127462&&t<=127487}const Km=8205;function e2(t,e,n=!0,r=!0){return(n?k1:t2)(t,e,r)}function k1(t,e,n){if(e==t.length)return e;e&&b1(t.charCodeAt(e))&&C1(t.charCodeAt(e-1))&&e--;let r=bc(t,e);for(e+=qm(r);e<t.length;){let i=bc(t,e);if(r==Km||i==Km||n&&ZC(i))e+=qm(i),r=i;else if($m(i)){let s=0,o=e-2;for(;o>=0&&$m(bc(t,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function t2(t,e,n){for(;e>0;){let r=k1(t,e-2,n);if(r<e)return r;e--}return 0}function bc(t,e){let n=t.charCodeAt(e);if(!C1(n)||e+1==t.length)return n;let r=t.charCodeAt(e+1);return b1(r)?(n-55296<<10)+(r-56320)+65536:n}function b1(t){return t>=56320&&t<57344}function C1(t){return t>=55296&&t<56320}function qm(t){return t<65536?1:2}class re{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,n,r){[e,n]=Ki(this,e,n);let i=[];return this.decompose(0,e,i,2),r.length&&r.decompose(0,r.length,i,3),this.decompose(n,this.length,i,1),pn.from(i,this.length-(n-e)+r.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,n=this.length){[e,n]=Ki(this,e,n);let r=[];return this.decompose(e,n,r,0),pn.from(r,n-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let n=this.scanIdentical(e,1),r=this.length-this.scanIdentical(e,-1),i=new Ks(this),s=new Ks(e);for(let o=n,l=n;;){if(i.next(o),s.next(o),o=0,i.lineBreak!=s.lineBreak||i.done!=s.done||i.value!=s.value)return!1;if(l+=i.value.length,i.done||l>=r)return!0}}iter(e=1){return new Ks(this,e)}iterRange(e,n=this.length){return new M1(this,e,n)}iterLines(e,n){let r;if(e==null)r=this.iter();else{n==null&&(n=this.lines+1);let i=this.line(e).from;r=this.iterRange(i,Math.max(i,n==this.lines+1?this.length:n<=1?0:this.line(n-1).to))}return new A1(r)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?re.empty:e.length<=32?new ke(e):pn.from(ke.split(e,[]))}}class ke extends re{constructor(e,n=n2(e)){super(),this.text=e,this.length=n}get lines(){return this.text.length}get children(){return null}lineInner(e,n,r,i){for(let s=0;;s++){let o=this.text[s],l=i+o.length;if((n?r:l)>=e)return new r2(i,l,r,o);i=l+1,r++}}decompose(e,n,r,i){let s=e<=0&&n>=this.length?this:new ke(Gm(this.text,e,n),Math.min(n,this.length)-Math.max(0,e));if(i&1){let o=r.pop(),l=oa(s.text,o.text.slice(),0,s.length);if(l.length<=32)r.push(new ke(l,o.length+s.length));else{let a=l.length>>1;r.push(new ke(l.slice(0,a)),new ke(l.slice(a)))}}else r.push(s)}replace(e,n,r){if(!(r instanceof ke))return super.replace(e,n,r);[e,n]=Ki(this,e,n);let i=oa(this.text,oa(r.text,Gm(this.text,0,e)),n),s=this.length+r.length-(n-e);return i.length<=32?new ke(i,s):pn.from(ke.split(i,[]),s)}sliceString(e,n=this.length,r=`
`){[e,n]=Ki(this,e,n);let i="";for(let s=0,o=0;s<=n&&o<this.text.length;o++){let l=this.text[o],a=s+l.length;s>e&&o&&(i+=r),e<a&&n>s&&(i+=l.slice(Math.max(0,e-s),n-s)),s=a+1}return i}flatten(e){for(let n of this.text)e.push(n)}scanIdentical(){return 0}static split(e,n){let r=[],i=-1;for(let s of e)r.push(s),i+=s.length+1,r.length==32&&(n.push(new ke(r,i)),r=[],i=-1);return i>-1&&n.push(new ke(r,i)),n}}class pn extends re{constructor(e,n){super(),this.children=e,this.length=n,this.lines=0;for(let r of e)this.lines+=r.lines}lineInner(e,n,r,i){for(let s=0;;s++){let o=this.children[s],l=i+o.length,a=r+o.lines-1;if((n?a:l)>=e)return o.lineInner(e,n,r,i);i=l+1,r=a+1}}decompose(e,n,r,i){for(let s=0,o=0;o<=n&&s<this.children.length;s++){let l=this.children[s],a=o+l.length;if(e<=a&&n>=o){let u=i&((o<=e?1:0)|(a>=n?2:0));o>=e&&a<=n&&!u?r.push(l):l.decompose(e-o,n-o,r,u)}o=a+1}}replace(e,n,r){if([e,n]=Ki(this,e,n),r.lines<this.lines)for(let i=0,s=0;i<this.children.length;i++){let o=this.children[i],l=s+o.length;if(e>=s&&n<=l){let a=o.replace(e-s,n-s,r),u=this.lines-o.lines+a.lines;if(a.lines<u>>4&&a.lines>u>>6){let c=this.children.slice();return c[i]=a,new pn(c,this.length-(n-e)+r.length)}return super.replace(s,l,a)}s=l+1}return super.replace(e,n,r)}sliceString(e,n=this.length,r=`
`){[e,n]=Ki(this,e,n);let i="";for(let s=0,o=0;s<this.children.length&&o<=n;s++){let l=this.children[s],a=o+l.length;o>e&&s&&(i+=r),e<a&&n>o&&(i+=l.sliceString(e-o,n-o,r)),o=a+1}return i}flatten(e){for(let n of this.children)n.flatten(e)}scanIdentical(e,n){if(!(e instanceof pn))return 0;let r=0,[i,s,o,l]=n>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=n,s+=n){if(i==o||s==l)return r;let a=this.children[i],u=e.children[s];if(a!=u)return r+a.scanIdentical(u,n);r+=a.length+1}}static from(e,n=e.reduce((r,i)=>r+i.length+1,-1)){let r=0;for(let d of e)r+=d.lines;if(r<32){let d=[];for(let p of e)p.flatten(d);return new ke(d,n)}let i=Math.max(32,r>>5),s=i<<1,o=i>>1,l=[],a=0,u=-1,c=[];function h(d){let p;if(d.lines>s&&d instanceof pn)for(let y of d.children)h(y);else d.lines>o&&(a>o||!a)?(f(),l.push(d)):d instanceof ke&&a&&(p=c[c.length-1])instanceof ke&&d.lines+p.lines<=32?(a+=d.lines,u+=d.length+1,c[c.length-1]=new ke(p.text.concat(d.text),p.length+1+d.length)):(a+d.lines>i&&f(),a+=d.lines,u+=d.length+1,c.push(d))}function f(){a!=0&&(l.push(c.length==1?c[0]:pn.from(c,u)),u=-1,a=c.length=0)}for(let d of e)h(d);return f(),l.length==1?l[0]:new pn(l,n)}}re.empty=new ke([""],0);function n2(t){let e=-1;for(let n of t)e+=n.length+1;return e}function oa(t,e,n=0,r=1e9){for(let i=0,s=0,o=!0;s<t.length&&i<=r;s++){let l=t[s],a=i+l.length;a>=n&&(a>r&&(l=l.slice(0,r-i)),i<n&&(l=l.slice(n-i)),o?(e[e.length-1]+=l,o=!1):e.push(l)),i=a+1}return e}function Gm(t,e,n){return oa(t,[""],e,n)}class Ks{constructor(e,n=1){this.dir=n,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[n>0?1:(e instanceof ke?e.text.length:e.children.length)<<1]}nextInner(e,n){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,i=this.nodes[r],s=this.offsets[r],o=s>>1,l=i instanceof ke?i.text.length:i.children.length;if(o==(n>0?l:0)){if(r==0)return this.done=!0,this.value="",this;n>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(n>0?0:1)){if(this.offsets[r]+=n,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(i instanceof ke){let a=i.text[o+(n<0?-1:0)];if(this.offsets[r]+=n,a.length>Math.max(0,e))return this.value=e==0?a:n>0?a.slice(e):a.slice(0,a.length-e),this;e-=a.length}else{let a=i.children[o+(n<0?-1:0)];e>a.length?(e-=a.length,this.offsets[r]+=n):(n<0&&this.offsets[r]--,this.nodes.push(a),this.offsets.push(n>0?1:(a instanceof ke?a.text.length:a.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class M1{constructor(e,n,r){this.value="",this.done=!1,this.cursor=new Ks(e,n>r?-1:1),this.pos=n>r?e.length:0,this.from=Math.min(n,r),this.to=Math.max(n,r)}nextInner(e,n){if(n<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,n<0?this.pos-this.to:this.from-this.pos);let r=n<0?this.pos-this.from:this.to-this.pos;e>r&&(e=r),r-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*n,this.value=i.length<=r?i:n<0?i.slice(i.length-r):i.slice(0,r),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class A1{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:n,lineBreak:r,value:i}=this.inner.next(e);return n&&this.afterBreak?(this.value="",this.afterBreak=!1):n?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(re.prototype[Symbol.iterator]=function(){return this.iter()},Ks.prototype[Symbol.iterator]=M1.prototype[Symbol.iterator]=A1.prototype[Symbol.iterator]=function(){return this});class r2{constructor(e,n,r,i){this.from=e,this.to=n,this.number=r,this.text=i}get length(){return this.to-this.from}}function Ki(t,e,n){return e=Math.max(0,Math.min(t.length,e)),[e,Math.max(e,Math.min(t.length,n))]}function je(t,e,n=!0,r=!0){return e2(t,e,n,r)}function i2(t){return t>=56320&&t<57344}function s2(t){return t>=55296&&t<56320}function ht(t,e){let n=t.charCodeAt(e);if(!s2(n)||e+1==t.length)return n;let r=t.charCodeAt(e+1);return i2(r)?(n-55296<<10)+(r-56320)+65536:n}function ep(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(t&1023)+56320))}function mn(t){return t<65536?1:2}const of=/\r\n?|\n/;var nt=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(nt||(nt={}));class bn{constructor(e){this.sections=e}get length(){let e=0;for(let n=0;n<this.sections.length;n+=2)e+=this.sections[n];return e}get newLength(){let e=0;for(let n=0;n<this.sections.length;n+=2){let r=this.sections[n+1];e+=r<0?this.sections[n]:r}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let n=0,r=0,i=0;n<this.sections.length;){let s=this.sections[n++],o=this.sections[n++];o<0?(e(r,i,s),i+=s):i+=o,r+=s}}iterChangedRanges(e,n=!1){lf(this,e,n)}get invertedDesc(){let e=[];for(let n=0;n<this.sections.length;){let r=this.sections[n++],i=this.sections[n++];i<0?e.push(r,i):e.push(i,r)}return new bn(e)}composeDesc(e){return this.empty?e:e.empty?this:E1(this,e)}mapDesc(e,n=!1){return e.empty?this:af(this,e,n)}mapPos(e,n=-1,r=nt.Simple){let i=0,s=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],a=this.sections[o++],u=i+l;if(a<0){if(u>e)return s+(e-i);s+=l}else{if(r!=nt.Simple&&u>=e&&(r==nt.TrackDel&&i<e&&u>e||r==nt.TrackBefore&&i<e||r==nt.TrackAfter&&u>e))return null;if(u>e||u==e&&n<0&&!l)return e==i||n<0?s:s+a;s+=a}i=u}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return s}touchesRange(e,n=e){for(let r=0,i=0;r<this.sections.length&&i<=n;){let s=this.sections[r++],o=this.sections[r++],l=i+s;if(o>=0&&i<=n&&l>=e)return i<e&&l>n?"cover":!0;i=l}return!1}toString(){let e="";for(let n=0;n<this.sections.length;){let r=this.sections[n++],i=this.sections[n++];e+=(e?" ":"")+r+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(n=>typeof n!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new bn(e)}static create(e){return new bn(e)}}class Pe extends bn{constructor(e,n){super(e),this.inserted=n}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return lf(this,(n,r,i,s,o)=>e=e.replace(i,i+(r-n),o),!1),e}mapDesc(e,n=!1){return af(this,e,n,!0)}invert(e){let n=this.sections.slice(),r=[];for(let i=0,s=0;i<n.length;i+=2){let o=n[i],l=n[i+1];if(l>=0){n[i]=l,n[i+1]=o;let a=i>>1;for(;r.length<a;)r.push(re.empty);r.push(o?e.slice(s,s+o):re.empty)}s+=o}return new Pe(n,r)}compose(e){return this.empty?e:e.empty?this:E1(this,e,!0)}map(e,n=!1){return e.empty?this:af(this,e,n,!0)}iterChanges(e,n=!1){lf(this,e,n)}get desc(){return bn.create(this.sections)}filter(e){let n=[],r=[],i=[],s=new vo(this);e:for(let o=0,l=0;;){let a=o==e.length?1e9:e[o++];for(;l<a||l==a&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,a-l);Ue(i,c,-1);let h=s.ins==-1?-1:s.off==0?s.ins:0;Ue(n,c,h),h>0&&rr(r,n,s.text),s.forward(c),l+=c}let u=e[o++];for(;l<u;){if(s.done)break e;let c=Math.min(s.len,u-l);Ue(n,c,-1),Ue(i,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),l+=c}}return{changes:new Pe(n,r),filtered:bn.create(i)}}toJSON(){let e=[];for(let n=0;n<this.sections.length;n+=2){let r=this.sections[n],i=this.sections[n+1];i<0?e.push(r):i==0?e.push([r]):e.push([r].concat(this.inserted[n>>1].toJSON()))}return e}static of(e,n,r){let i=[],s=[],o=0,l=null;function a(c=!1){if(!c&&!i.length)return;o<n&&Ue(i,n-o,-1);let h=new Pe(i,s);l=l?l.compose(h.map(l)):h,i=[],s=[],o=0}function u(c){if(Array.isArray(c))for(let h of c)u(h);else if(c instanceof Pe){if(c.length!=n)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${n})`);a(),l=l?l.compose(c.map(l)):c}else{let{from:h,to:f=h,insert:d}=c;if(h>f||h<0||f>n)throw new RangeError(`Invalid change range ${h} to ${f} (in doc of length ${n})`);let p=d?typeof d=="string"?re.of(d.split(r||of)):d:re.empty,y=p.length;if(h==f&&y==0)return;h<o&&a(),h>o&&Ue(i,h-o,-1),Ue(i,f-h,y),rr(s,i,p),o=f}}return u(e),a(!l),l}static empty(e){return new Pe(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let n=[],r=[];for(let i=0;i<e.length;i++){let s=e[i];if(typeof s=="number")n.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)n.push(s[0],0);else{for(;r.length<i;)r.push(re.empty);r[i]=re.of(s.slice(1)),n.push(s[0],r[i].length)}}}return new Pe(n,r)}static createSet(e,n){return new Pe(e,n)}}function Ue(t,e,n,r=!1){if(e==0&&n<=0)return;let i=t.length-2;i>=0&&n<=0&&n==t[i+1]?t[i]+=e:i>=0&&e==0&&t[i]==0?t[i+1]+=n:r?(t[i]+=e,t[i+1]+=n):t.push(e,n)}function rr(t,e,n){if(n.length==0)return;let r=e.length-2>>1;if(r<t.length)t[t.length-1]=t[t.length-1].append(n);else{for(;t.length<r;)t.push(re.empty);t.push(n)}}function lf(t,e,n){let r=t.inserted;for(let i=0,s=0,o=0;o<t.sections.length;){let l=t.sections[o++],a=t.sections[o++];if(a<0)i+=l,s+=l;else{let u=i,c=s,h=re.empty;for(;u+=l,c+=a,a&&r&&(h=h.append(r[o-2>>1])),!(n||o==t.sections.length||t.sections[o+1]<0);)l=t.sections[o++],a=t.sections[o++];e(i,u,s,c,h),i=u,s=c}}}function af(t,e,n,r=!1){let i=[],s=r?[]:null,o=new vo(t),l=new vo(e);for(let a=-1;;){if(o.done&&l.len||l.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&l.ins==-1){let u=Math.min(o.len,l.len);Ue(i,u,-1),o.forward(u),l.forward(u)}else if(l.ins>=0&&(o.ins<0||a==o.i||o.off==0&&(l.len<o.len||l.len==o.len&&!n))){let u=l.len;for(Ue(i,l.ins,-1);u;){let c=Math.min(o.len,u);o.ins>=0&&a<o.i&&o.len<=c&&(Ue(i,0,o.ins),s&&rr(s,i,o.text),a=o.i),o.forward(c),u-=c}l.next()}else if(o.ins>=0){let u=0,c=o.len;for(;c;)if(l.ins==-1){let h=Math.min(c,l.len);u+=h,c-=h,l.forward(h)}else if(l.ins==0&&l.len<c)c-=l.len,l.next();else break;Ue(i,u,a<o.i?o.ins:0),s&&a<o.i&&rr(s,i,o.text),a=o.i,o.forward(o.len-c)}else{if(o.done&&l.done)return s?Pe.createSet(i,s):bn.create(i);throw new Error("Mismatched change set lengths")}}}function E1(t,e,n=!1){let r=[],i=n?[]:null,s=new vo(t),o=new vo(e);for(let l=!1;;){if(s.done&&o.done)return i?Pe.createSet(r,i):bn.create(r);if(s.ins==0)Ue(r,s.len,0,l),s.next();else if(o.len==0&&!o.done)Ue(r,0,o.ins,l),i&&rr(i,r,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let a=Math.min(s.len2,o.len),u=r.length;if(s.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;Ue(r,a,c,l),i&&c&&rr(i,r,o.text)}else o.ins==-1?(Ue(r,s.off?0:s.len,a,l),i&&rr(i,r,s.textBit(a))):(Ue(r,s.off?0:s.len,o.off?0:o.ins,l),i&&!o.off&&rr(i,r,o.text));l=(s.ins>a||o.ins>=0&&o.len>a)&&(l||r.length>u),s.forward2(a),o.forward(a)}}}}class vo{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,n=this.i-2>>1;return n>=e.length?re.empty:e[n]}textBit(e){let{inserted:n}=this.set,r=this.i-2>>1;return r>=n.length&&!e?re.empty:n[r].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Ir{constructor(e,n,r){this.from=e,this.to=n,this.flags=r}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,n=-1){let r,i;return this.empty?r=i=e.mapPos(this.from,n):(r=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),r==this.from&&i==this.to?this:new Ir(r,i,this.flags)}extend(e,n=e){if(e<=this.anchor&&n>=this.anchor)return A.range(e,n);let r=Math.abs(e-this.anchor)>Math.abs(n-this.anchor)?e:n;return A.range(this.anchor,r)}eq(e,n=!1){return this.anchor==e.anchor&&this.head==e.head&&(!n||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return A.range(e.anchor,e.head)}static create(e,n,r){return new Ir(e,n,r)}}class A{constructor(e,n){this.ranges=e,this.mainIndex=n}map(e,n=-1){return e.empty?this:A.create(this.ranges.map(r=>r.map(e,n)),this.mainIndex)}eq(e,n=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(e.ranges[r],n))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new A([this.main],0)}addRange(e,n=!0){return A.create([e].concat(this.ranges),n?0:this.mainIndex+1)}replaceRange(e,n=this.mainIndex){let r=this.ranges.slice();return r[n]=e,A.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new A(e.ranges.map(n=>Ir.fromJSON(n)),e.main)}static single(e,n=e){return new A([A.range(e,n)],0)}static create(e,n=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let r=0,i=0;i<e.length;i++){let s=e[i];if(s.empty?s.from<=r:s.from<r)return A.normalized(e.slice(),n);r=s.to}return new A(e,n)}static cursor(e,n=0,r,i){return Ir.create(e,e,(n==0?0:n<0?8:16)|(r==null?7:Math.min(6,r))|(i??16777215)<<6)}static range(e,n,r,i){let s=(r??16777215)<<6|(i==null?7:Math.min(6,i));return n<e?Ir.create(n,e,48|s):Ir.create(e,n,(n>e?8:0)|s)}static normalized(e,n=0){let r=e[n];e.sort((i,s)=>i.from-s.from),n=e.indexOf(r);for(let i=1;i<e.length;i++){let s=e[i],o=e[i-1];if(s.empty?s.from<=o.to:s.from<o.to){let l=o.from,a=Math.max(s.to,o.to);i<=n&&n--,e.splice(--i,2,s.anchor>s.head?A.range(a,l):A.range(l,a))}}return new A(e,n)}}function P1(t,e){for(let n of t.ranges)if(n.to>e)throw new RangeError("Selection points outside of document")}let tp=0;class I{constructor(e,n,r,i,s){this.combine=e,this.compareInput=n,this.compare=r,this.isStatic=i,this.id=tp++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new I(e.combine||(n=>n),e.compareInput||((n,r)=>n===r),e.compare||(e.combine?(n,r)=>n===r:np),!!e.static,e.enables)}of(e){return new la([],this,0,e)}compute(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new la(e,this,1,n)}computeN(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new la(e,this,2,n)}from(e,n){return n||(n=r=>r),this.compute([e],r=>n(r.field(e)))}}function np(t,e){return t==e||t.length==e.length&&t.every((n,r)=>n===e[r])}class la{constructor(e,n,r,i){this.dependencies=e,this.facet=n,this.type=r,this.value=i,this.id=tp++}dynamicSlot(e){var n;let r=this.value,i=this.facet.compareInput,s=this.id,o=e[s]>>1,l=this.type==2,a=!1,u=!1,c=[];for(let h of this.dependencies)h=="doc"?a=!0:h=="selection"?u=!0:((n=e[h.id])!==null&&n!==void 0?n:1)&1||c.push(e[h.id]);return{create(h){return h.values[o]=r(h),1},update(h,f){if(a&&f.docChanged||u&&(f.docChanged||f.selection)||uf(h,c)){let d=r(h);if(l?!Xm(d,h.values[o],i):!i(d,h.values[o]))return h.values[o]=d,1}return 0},reconfigure:(h,f)=>{let d,p=f.config.address[s];if(p!=null){let y=Wa(f,p);if(this.dependencies.every(w=>w instanceof I?f.facet(w)===h.facet(w):w instanceof We?f.field(w,!1)==h.field(w,!1):!0)||(l?Xm(d=r(h),y,i):i(d=r(h),y)))return h.values[o]=y,0}else d=r(h);return h.values[o]=d,1}}}}function Xm(t,e,n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!n(t[r],e[r]))return!1;return!0}function uf(t,e){let n=!1;for(let r of e)qs(t,r)&1&&(n=!0);return n}function o2(t,e,n){let r=n.map(a=>t[a.id]),i=n.map(a=>a.type),s=r.filter(a=>!(a&1)),o=t[e.id]>>1;function l(a){let u=[];for(let c=0;c<r.length;c++){let h=Wa(a,r[c]);if(i[c]==2)for(let f of h)u.push(f);else u.push(h)}return e.combine(u)}return{create(a){for(let u of r)qs(a,u);return a.values[o]=l(a),1},update(a,u){if(!uf(a,s))return 0;let c=l(a);return e.compare(c,a.values[o])?0:(a.values[o]=c,1)},reconfigure(a,u){let c=uf(a,r),h=u.config.facets[e.id],f=u.facet(e);if(h&&!c&&np(n,h))return a.values[o]=f,0;let d=l(a);return e.compare(d,f)?(a.values[o]=f,0):(a.values[o]=d,1)}}}const pl=I.define({static:!0});class We{constructor(e,n,r,i,s){this.id=e,this.createF=n,this.updateF=r,this.compareF=i,this.spec=s,this.provides=void 0}static define(e){let n=new We(tp++,e.create,e.update,e.compare||((r,i)=>r===i),e);return e.provide&&(n.provides=e.provide(n)),n}create(e){let n=e.facet(pl).find(r=>r.field==this);return((n==null?void 0:n.create)||this.createF)(e)}slot(e){let n=e[this.id]>>1;return{create:r=>(r.values[n]=this.create(r),1),update:(r,i)=>{let s=r.values[n],o=this.updateF(s,i);return this.compareF(s,o)?0:(r.values[n]=o,1)},reconfigure:(r,i)=>{let s=r.facet(pl),o=i.facet(pl),l;return(l=s.find(a=>a.field==this))&&l!=o.find(a=>a.field==this)?(r.values[n]=l.create(r),1):i.config.address[this.id]!=null?(r.values[n]=i.field(this),0):(r.values[n]=this.create(r),1)}}}init(e){return[this,pl.of({field:this,create:e})]}get extension(){return this}}const Rr={lowest:4,low:3,default:2,high:1,highest:0};function ps(t){return e=>new D1(e,t)}const ni={highest:ps(Rr.highest),high:ps(Rr.high),default:ps(Rr.default),low:ps(Rr.low),lowest:ps(Rr.lowest)};class D1{constructor(e,n){this.inner=e,this.prec=n}}class Ru{of(e){return new cf(this,e)}reconfigure(e){return Ru.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class cf{constructor(e,n){this.compartment=e,this.inner=n}}class za{constructor(e,n,r,i,s,o){for(this.base=e,this.compartments=n,this.dynamicSlots=r,this.address=i,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(e){let n=this.address[e.id];return n==null?e.default:this.staticValues[n>>1]}static resolve(e,n,r){let i=[],s=Object.create(null),o=new Map;for(let f of l2(e,n,o))f instanceof We?i.push(f):(s[f.facet.id]||(s[f.facet.id]=[])).push(f);let l=Object.create(null),a=[],u=[];for(let f of i)l[f.id]=u.length<<1,u.push(d=>f.slot(d));let c=r==null?void 0:r.config.facets;for(let f in s){let d=s[f],p=d[0].facet,y=c&&c[f]||[];if(d.every(w=>w.type==0))if(l[p.id]=a.length<<1|1,np(y,d))a.push(r.facet(p));else{let w=p.combine(d.map(m=>m.value));a.push(r&&p.compare(w,r.facet(p))?r.facet(p):w)}else{for(let w of d)w.type==0?(l[w.id]=a.length<<1|1,a.push(w.value)):(l[w.id]=u.length<<1,u.push(m=>w.dynamicSlot(m)));l[p.id]=u.length<<1,u.push(w=>o2(w,p,d))}}let h=u.map(f=>f(l));return new za(e,o,h,l,a,s)}}function l2(t,e,n){let r=[[],[],[],[],[]],i=new Map;function s(o,l){let a=i.get(o);if(a!=null){if(a<=l)return;let u=r[a].indexOf(o);u>-1&&r[a].splice(u,1),o instanceof cf&&n.delete(o.compartment)}if(i.set(o,l),Array.isArray(o))for(let u of o)s(u,l);else if(o instanceof cf){if(n.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let u=e.get(o.compartment)||o.inner;n.set(o.compartment,u),s(u,l)}else if(o instanceof D1)s(o.inner,o.prec);else if(o instanceof We)r[l].push(o),o.provides&&s(o.provides,l);else if(o instanceof la)r[l].push(o),o.facet.extensions&&s(o.facet.extensions,Rr.default);else{let u=o.extension;if(!u)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(u,l)}}return s(t,Rr.default),r.reduce((o,l)=>o.concat(l))}function qs(t,e){if(e&1)return 2;let n=e>>1,r=t.status[n];if(r==4)throw new Error("Cyclic dependency between fields and/or facets");if(r&2)return r;t.status[n]=4;let i=t.computeSlot(t,t.config.dynamicSlots[n]);return t.status[n]=2|i}function Wa(t,e){return e&1?t.config.staticValues[e>>1]:t.values[e>>1]}const T1=I.define(),hf=I.define({combine:t=>t.some(e=>e),static:!0}),O1=I.define({combine:t=>t.length?t[0]:void 0,static:!0}),R1=I.define(),N1=I.define(),L1=I.define(),B1=I.define({combine:t=>t.length?t[0]:!1});class Mn{constructor(e,n){this.type=e,this.value=n}static define(){return new a2}}class a2{of(e){return new Mn(this,e)}}class u2{constructor(e){this.map=e}of(e){return new G(this,e)}}class G{constructor(e,n){this.type=e,this.value=n}map(e){let n=this.type.map(this.value,e);return n===void 0?void 0:n==this.value?this:new G(this.type,n)}is(e){return this.type==e}static define(e={}){return new u2(e.map||(n=>n))}static mapEffects(e,n){if(!e.length)return e;let r=[];for(let i of e){let s=i.map(n);s&&r.push(s)}return r}}G.reconfigure=G.define();G.appendConfig=G.define();class Te{constructor(e,n,r,i,s,o){this.startState=e,this.changes=n,this.selection=r,this.effects=i,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,r&&P1(r,n.newLength),s.some(l=>l.type==Te.time)||(this.annotations=s.concat(Te.time.of(Date.now())))}static create(e,n,r,i,s,o){return new Te(e,n,r,i,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let n of this.annotations)if(n.type==e)return n.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let n=this.annotation(Te.userEvent);return!!(n&&(n==e||n.length>e.length&&n.slice(0,e.length)==e&&n[e.length]=="."))}}Te.time=Mn.define();Te.userEvent=Mn.define();Te.addToHistory=Mn.define();Te.remote=Mn.define();function c2(t,e){let n=[];for(let r=0,i=0;;){let s,o;if(r<t.length&&(i==e.length||e[i]>=t[r]))s=t[r++],o=t[r++];else if(i<e.length)s=e[i++],o=e[i++];else return n;!n.length||n[n.length-1]<s?n.push(s,o):n[n.length-1]<o&&(n[n.length-1]=o)}}function _1(t,e,n){var r;let i,s,o;return n?(i=e.changes,s=Pe.empty(e.changes.length),o=t.changes.compose(e.changes)):(i=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(i)),{changes:o,selection:e.selection?e.selection.map(s):(r=t.selection)===null||r===void 0?void 0:r.map(i),effects:G.mapEffects(t.effects,i).concat(G.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function ff(t,e,n){let r=e.selection,i=Oi(e.annotations);return e.userEvent&&(i=i.concat(Te.userEvent.of(e.userEvent))),{changes:e.changes instanceof Pe?e.changes:Pe.of(e.changes||[],n,t.facet(O1)),selection:r&&(r instanceof A?r:A.single(r.anchor,r.head)),effects:Oi(e.effects),annotations:i,scrollIntoView:!!e.scrollIntoView}}function I1(t,e,n){let r=ff(t,e.length?e[0]:{},t.doc.length);e.length&&e[0].filter===!1&&(n=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(n=!1);let o=!!e[s].sequential;r=_1(r,ff(t,e[s],o?r.changes.newLength:t.doc.length),o)}let i=Te.create(t,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return f2(n?h2(i):i)}function h2(t){let e=t.startState,n=!0;for(let i of e.facet(R1)){let s=i(t);if(s===!1){n=!1;break}Array.isArray(s)&&(n=n===!0?s:c2(n,s))}if(n!==!0){let i,s;if(n===!1)s=t.changes.invertedDesc,i=Pe.empty(e.doc.length);else{let o=t.changes.filter(n);i=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}t=Te.create(e,i,t.selection&&t.selection.map(s),G.mapEffects(t.effects,s),t.annotations,t.scrollIntoView)}let r=e.facet(N1);for(let i=r.length-1;i>=0;i--){let s=r[i](t);s instanceof Te?t=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Te?t=s[0]:t=I1(e,Oi(s),!1)}return t}function f2(t){let e=t.startState,n=e.facet(L1),r=t;for(let i=n.length-1;i>=0;i--){let s=n[i](t);s&&Object.keys(s).length&&(r=_1(r,ff(e,s,t.changes.newLength),!0))}return r==t?t:Te.create(e,t.changes,t.selection,r.effects,r.annotations,r.scrollIntoView)}const d2=[];function Oi(t){return t==null?d2:Array.isArray(t)?t:[t]}var ye=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(ye||(ye={}));const p2=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let df;try{df=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function m2(t){if(df)return df.test(t);for(let e=0;e<t.length;e++){let n=t[e];if(/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||p2.test(n)))return!0}return!1}function g2(t){return e=>{if(!/\S/.test(e))return ye.Space;if(m2(e))return ye.Word;for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return ye.Word;return ye.Other}}class ee{constructor(e,n,r,i,s,o){this.config=e,this.doc=n,this.selection=r,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)qs(this,l<<1);this.computeSlot=null}field(e,n=!0){let r=this.config.address[e.id];if(r==null){if(n)throw new RangeError("Field is not present in this state");return}return qs(this,r),Wa(this,r)}update(...e){return I1(this,e,!0)}applyTransaction(e){let n=this.config,{base:r,compartments:i}=n;for(let l of e.effects)l.is(Ru.reconfigure)?(n&&(i=new Map,n.compartments.forEach((a,u)=>i.set(u,a)),n=null),i.set(l.value.compartment,l.value.extension)):l.is(G.reconfigure)?(n=null,r=l.value):l.is(G.appendConfig)&&(n=null,r=Oi(r).concat(l.value));let s;n?s=e.startState.values.slice():(n=za.resolve(r,i,this),s=new ee(n,this.doc,this.selection,n.dynamicSlots.map(()=>null),(a,u)=>u.reconfigure(a,this),null).values);let o=e.startState.facet(hf)?e.newSelection:e.newSelection.asSingle();new ee(n,e.newDoc,o,s,(l,a)=>a.update(l,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:e},range:A.cursor(n.from+e.length)}))}changeByRange(e){let n=this.selection,r=e(n.ranges[0]),i=this.changes(r.changes),s=[r.range],o=Oi(r.effects);for(let l=1;l<n.ranges.length;l++){let a=e(n.ranges[l]),u=this.changes(a.changes),c=u.map(i);for(let f=0;f<l;f++)s[f]=s[f].map(c);let h=i.mapDesc(u,!0);s.push(a.range.map(h)),i=i.compose(c),o=G.mapEffects(o,c).concat(G.mapEffects(Oi(a.effects),h))}return{changes:i,selection:A.create(s,n.mainIndex),effects:o}}changes(e=[]){return e instanceof Pe?e:Pe.of(e,this.doc.length,this.facet(ee.lineSeparator))}toText(e){return re.of(e.split(this.facet(ee.lineSeparator)||of))}sliceDoc(e=0,n=this.doc.length){return this.doc.sliceString(e,n,this.lineBreak)}facet(e){let n=this.config.address[e.id];return n==null?e.default:(qs(this,n),Wa(this,n))}toJSON(e){let n={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let r in e){let i=e[r];i instanceof We&&this.config.address[i.id]!=null&&(n[r]=i.spec.toJSON(this.field(e[r]),this))}return n}static fromJSON(e,n={},r){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(r){for(let s in r)if(Object.prototype.hasOwnProperty.call(e,s)){let o=r[s],l=e[s];i.push(o.init(a=>o.spec.fromJSON(l,a)))}}return ee.create({doc:e.doc,selection:A.fromJSON(e.selection),extensions:n.extensions?i.concat([n.extensions]):i})}static create(e={}){let n=za.resolve(e.extensions||[],new Map),r=e.doc instanceof re?e.doc:re.of((e.doc||"").split(n.staticFacet(ee.lineSeparator)||of)),i=e.selection?e.selection instanceof A?e.selection:A.single(e.selection.anchor,e.selection.head):A.single(0);return P1(i,r.length),n.staticFacet(hf)||(i=i.asSingle()),new ee(n,r,i,n.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(ee.tabSize)}get lineBreak(){return this.facet(ee.lineSeparator)||`
`}get readOnly(){return this.facet(B1)}phrase(e,...n){for(let r of this.facet(ee.phrases))if(Object.prototype.hasOwnProperty.call(r,e)){e=r[e];break}return n.length&&(e=e.replace(/\$(\$|\d*)/g,(r,i)=>{if(i=="$")return"$";let s=+(i||1);return!s||s>n.length?r:n[s-1]})),e}languageDataAt(e,n,r=-1){let i=[];for(let s of this.facet(T1))for(let o of s(this,n,r))Object.prototype.hasOwnProperty.call(o,e)&&i.push(o[e]);return i}charCategorizer(e){return g2(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:n,from:r,length:i}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-r,l=e-r;for(;o>0;){let a=je(n,o,!1);if(s(n.slice(a,o))!=ye.Word)break;o=a}for(;l<i;){let a=je(n,l);if(s(n.slice(l,a))!=ye.Word)break;l=a}return o==l?null:A.range(o+r,l+r)}}ee.allowMultipleSelections=hf;ee.tabSize=I.define({combine:t=>t.length?t[0]:4});ee.lineSeparator=O1;ee.readOnly=B1;ee.phrases=I.define({compare(t,e){let n=Object.keys(t),r=Object.keys(e);return n.length==r.length&&n.every(i=>t[i]==e[i])}});ee.languageData=T1;ee.changeFilter=R1;ee.transactionFilter=N1;ee.transactionExtender=L1;Ru.reconfigure=G.define();function An(t,e,n={}){let r={};for(let i of t)for(let s of Object.keys(i)){let o=i[s],l=r[s];if(l===void 0)r[s]=o;else if(!(l===o||o===void 0))if(Object.hasOwnProperty.call(n,s))r[s]=n[s](l,o);else throw new Error("Config merge conflict for field "+s)}for(let i in e)r[i]===void 0&&(r[i]=e[i]);return r}class Gr{eq(e){return this==e}range(e,n=e){return pf.create(e,n,this)}}Gr.prototype.startSide=Gr.prototype.endSide=0;Gr.prototype.point=!1;Gr.prototype.mapMode=nt.TrackDel;let pf=class j1{constructor(e,n,r){this.from=e,this.to=n,this.value=r}static create(e,n,r){return new j1(e,n,r)}};function mf(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class rp{constructor(e,n,r,i){this.from=e,this.to=n,this.value=r,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,n,r,i=0){let s=r?this.to:this.from;for(let o=i,l=s.length;;){if(o==l)return o;let a=o+l>>1,u=s[a]-e||(r?this.value[a].endSide:this.value[a].startSide)-n;if(a==o)return u>=0?o:l;u>=0?l=a:o=a+1}}between(e,n,r,i){for(let s=this.findIndex(n,-1e9,!0),o=this.findIndex(r,1e9,!1,s);s<o;s++)if(i(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,n){let r=[],i=[],s=[],o=-1,l=-1;for(let a=0;a<this.value.length;a++){let u=this.value[a],c=this.from[a]+e,h=this.to[a]+e,f,d;if(c==h){let p=n.mapPos(c,u.startSide,u.mapMode);if(p==null||(f=d=p,u.startSide!=u.endSide&&(d=n.mapPos(c,u.endSide),d<f)))continue}else if(f=n.mapPos(c,u.startSide),d=n.mapPos(h,u.endSide),f>d||f==d&&u.startSide>0&&u.endSide<=0)continue;(d-f||u.endSide-u.startSide)<0||(o<0&&(o=f),u.point&&(l=Math.max(l,d-f)),r.push(u),i.push(f-o),s.push(d-o))}return{mapped:r.length?new rp(i,s,r,l):null,pos:o}}}class ne{constructor(e,n,r,i){this.chunkPos=e,this.chunk=n,this.nextLayer=r,this.maxPoint=i}static create(e,n,r,i){return new ne(e,n,r,i)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let n of this.chunk)e+=n.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:n=[],sort:r=!1,filterFrom:i=0,filterTo:s=this.length}=e,o=e.filter;if(n.length==0&&!o)return this;if(r&&(n=n.slice().sort(mf)),this.isEmpty)return n.length?ne.of(n):this;let l=new F1(this,null,-1).goto(0),a=0,u=[],c=new zn;for(;l.value||a<n.length;)if(a<n.length&&(l.from-n[a].from||l.startSide-n[a].value.startSide)>=0){let h=n[a++];c.addInner(h.from,h.to,h.value)||u.push(h)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==n.length||this.chunkEnd(l.chunkIndex)<n[a].from)&&(!o||i>this.chunkEnd(l.chunkIndex)||s<this.chunkPos[l.chunkIndex])&&c.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||i>l.to||s<l.from||o(l.from,l.to,l.value))&&(c.addInner(l.from,l.to,l.value)||u.push(pf.create(l.from,l.to,l.value))),l.next());return c.finishInner(this.nextLayer.isEmpty&&!u.length?ne.empty:this.nextLayer.update({add:u,filter:o,filterFrom:i,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let n=[],r=[],i=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],a=this.chunk[o],u=e.touchesRange(l,l+a.length);if(u===!1)i=Math.max(i,a.maxPoint),n.push(a),r.push(e.mapPos(l));else if(u===!0){let{mapped:c,pos:h}=a.map(l,e);c&&(i=Math.max(i,c.maxPoint),n.push(c),r.push(h))}}let s=this.nextLayer.map(e);return n.length==0?s:new ne(r,n,s||ne.empty,i)}between(e,n,r){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let s=this.chunkPos[i],o=this.chunk[i];if(n>=s&&e<=s+o.length&&o.between(s,e-s,n-s,r)===!1)return}this.nextLayer.between(e,n,r)}}iter(e=0){return wo.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,n=0){return wo.from(e).goto(n)}static compare(e,n,r,i,s=-1){let o=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),l=n.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=s),a=Ym(o,l,r),u=new ms(o,a,s),c=new ms(l,a,s);r.iterGaps((h,f,d)=>Qm(u,h,c,f,d,i)),r.empty&&r.length==0&&Qm(u,0,c,0,0,i)}static eq(e,n,r=0,i){i==null&&(i=999999999);let s=e.filter(c=>!c.isEmpty&&n.indexOf(c)<0),o=n.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let l=Ym(s,o),a=new ms(s,l,0).goto(r),u=new ms(o,l,0).goto(r);for(;;){if(a.to!=u.to||!gf(a.active,u.active)||a.point&&(!u.point||!a.point.eq(u.point)))return!1;if(a.to>i)return!0;a.next(),u.next()}}static spans(e,n,r,i,s=-1){let o=new ms(e,null,s).goto(n),l=n,a=o.openStart;for(;;){let u=Math.min(o.to,r);if(o.point){let c=o.activeForPoint(o.to),h=o.pointFrom<n?c.length+1:o.point.startSide<0?c.length:Math.min(c.length,a);i.point(l,u,o.point,c,h,o.pointRank),a=Math.min(o.openEnd(u),c.length)}else u>l&&(i.span(l,u,o.active,a),a=o.openEnd(u));if(o.to>r)return a+(o.point&&o.to>r?1:0);l=o.to,o.next()}}static of(e,n=!1){let r=new zn;for(let i of e instanceof pf?[e]:n?y2(e):e)r.add(i.from,i.to,i.value);return r.finish()}static join(e){if(!e.length)return ne.empty;let n=e[e.length-1];for(let r=e.length-2;r>=0;r--)for(let i=e[r];i!=ne.empty;i=i.nextLayer)n=new ne(i.chunkPos,i.chunk,n,Math.max(i.maxPoint,n.maxPoint));return n}}ne.empty=new ne([],[],null,-1);function y2(t){if(t.length>1)for(let e=t[0],n=1;n<t.length;n++){let r=t[n];if(mf(e,r)>0)return t.slice().sort(mf);e=r}return t}ne.empty.nextLayer=ne.empty;class zn{finishChunk(e){this.chunks.push(new rp(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,n,r){this.addInner(e,n,r)||(this.nextLayer||(this.nextLayer=new zn)).add(e,n,r)}addInner(e,n,r){let i=e-this.lastTo||r.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return i<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(n-this.chunkStart),this.last=r,this.lastFrom=e,this.lastTo=n,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,n-e)),!0)}addChunk(e,n){if((e-this.lastTo||n.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,n.maxPoint),this.chunks.push(n),this.chunkPos.push(e);let r=n.value.length-1;return this.last=n.value[r],this.lastFrom=n.from[r]+e,this.lastTo=n.to[r]+e,!0}finish(){return this.finishInner(ne.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let n=ne.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,n}}function Ym(t,e,n){let r=new Map;for(let s of t)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&r.set(s.chunk[o],s.chunkPos[o]);let i=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let l=r.get(s.chunk[o]);l!=null&&(n?n.mapPos(l):l)==s.chunkPos[o]&&!(n!=null&&n.touchesRange(l,l+s.chunk[o].length))&&i.add(s.chunk[o])}return i}class F1{constructor(e,n,r,i=0){this.layer=e,this.skip=n,this.minPoint=r,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,n=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,n,!1),this}gotoInner(e,n,r){for(;this.chunkIndex<this.layer.chunk.length;){let i=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(i)||this.layer.chunkEnd(this.chunkIndex)<e||i.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],n,!0);(!r||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,n){(this.to-e||this.endSide-n)<0&&this.gotoInner(e,n,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],n=this.layer.chunk[this.chunkIndex],r=e+n.from[this.rangeIndex];if(this.from=r,this.to=e+n.to[this.rangeIndex],this.value=n.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class wo{constructor(e){this.heap=e}static from(e,n=null,r=-1){let i=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=r&&i.push(new F1(o,n,r,s));return i.length==1?i[0]:new wo(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,n=-1e9){for(let r of this.heap)r.goto(e,n);for(let r=this.heap.length>>1;r>=0;r--)Cc(this.heap,r);return this.next(),this}forward(e,n){for(let r of this.heap)r.forward(e,n);for(let r=this.heap.length>>1;r>=0;r--)Cc(this.heap,r);(this.to-e||this.value.endSide-n)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Cc(this.heap,0)}}}function Cc(t,e){for(let n=t[e];;){let r=(e<<1)+1;if(r>=t.length)break;let i=t[r];if(r+1<t.length&&i.compare(t[r+1])>=0&&(i=t[r+1],r++),n.compare(i)<0)break;t[r]=n,t[e]=i,e=r}}class ms{constructor(e,n,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=wo.from(e,n,r)}goto(e,n=-1e9){return this.cursor.goto(e,n),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=n,this.openStart=-1,this.next(),this}forward(e,n){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-n)<0;)this.removeActive(this.minActive);this.cursor.forward(e,n)}removeActive(e){ml(this.active,e),ml(this.activeTo,e),ml(this.activeRank,e),this.minActive=Jm(this.active,this.activeTo)}addActive(e){let n=0,{value:r,to:i,rank:s}=this.cursor;for(;n<this.activeRank.length&&(s-this.activeRank[n]||i-this.activeTo[n])>0;)n++;gl(this.active,n,r),gl(this.activeTo,n,i),gl(this.activeRank,n,s),e&&gl(e,n,this.cursor.from),this.minActive=Jm(this.active,this.activeTo)}next(){let e=this.to,n=this.point;this.point=null;let r=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),r&&ml(r,i)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(r),this.cursor.next();else if(n&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(r){this.openStart=0;for(let i=r.length-1;i>=0&&r[i]<e;i--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let n=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>e||this.activeTo[r]==e&&this.active[r].endSide>=this.point.endSide)&&n.push(this.active[r]);return n.reverse()}openEnd(e){let n=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>e;r--)n++;return n}}function Qm(t,e,n,r,i,s){t.goto(e),n.goto(r);let o=r+i,l=r,a=r-e;for(;;){let u=t.to+a-n.to,c=u||t.endSide-n.endSide,h=c<0?t.to+a:n.to,f=Math.min(h,o);if(t.point||n.point?t.point&&n.point&&(t.point==n.point||t.point.eq(n.point))&&gf(t.activeForPoint(t.to),n.activeForPoint(n.to))||s.comparePoint(l,f,t.point,n.point):f>l&&!gf(t.active,n.active)&&s.compareRange(l,f,t.active,n.active),h>o)break;(u||t.openEnd!=n.openEnd)&&s.boundChange&&s.boundChange(h),l=h,c<=0&&t.next(),c>=0&&n.next()}}function gf(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!=e[n]&&!t[n].eq(e[n]))return!1;return!0}function ml(t,e){for(let n=e,r=t.length-1;n<r;n++)t[n]=t[n+1];t.pop()}function gl(t,e,n){for(let r=t.length-1;r>=e;r--)t[r+1]=t[r];t[e]=n}function Jm(t,e){let n=-1,r=1e9;for(let i=0;i<e.length;i++)(e[i]-r||t[i].endSide-t[n].endSide)<0&&(n=i,r=e[i]);return n}function rs(t,e,n=t.length){let r=0;for(let i=0;i<n&&i<t.length;)t.charCodeAt(i)==9?(r+=e-r%e,i++):(r++,i=je(t,i));return r}function yf(t,e,n,r){for(let i=0,s=0;;){if(s>=e)return i;if(i==t.length)break;s+=t.charCodeAt(i)==9?n-s%n:1,i=je(t,i)}return r===!0?-1:t.length}const vf="",Zm=typeof Symbol>"u"?"__"+vf:Symbol.for(vf),wf=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),eg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class vr{constructor(e,n){this.rules=[];let{finish:r}=n||{};function i(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,l,a,u){let c=[],h=/^@(\w+)\b/.exec(o[0]),f=h&&h[1]=="keyframes";if(h&&l==null)return a.push(o[0]+";");for(let d in l){let p=l[d];if(/&/.test(d))s(d.split(/,\s*/).map(y=>o.map(w=>y.replace(/&/,w))).reduce((y,w)=>y.concat(w)),p,a);else if(p&&typeof p=="object"){if(!h)throw new RangeError("The value of a property ("+d+") should be a primitive value.");s(i(d),p,c,f)}else p!=null&&c.push(d.replace(/_.*/,"").replace(/[A-Z]/g,y=>"-"+y.toLowerCase())+": "+p+";")}(c.length||f)&&a.push((r&&!h&&!u?o.map(r):o).join(", ")+" {"+c.join(" ")+"}")}for(let o in e)s(i(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=eg[Zm]||1;return eg[Zm]=e+1,vf+e.toString(36)}static mount(e,n,r){let i=e[wf],s=r&&r.nonce;i?s&&i.setNonce(s):i=new v2(e,s),i.mount(Array.isArray(n)?n:[n],e)}}let tg=new Map;class v2{constructor(e,n){let r=e.ownerDocument||e,i=r.defaultView;if(!e.head&&e.adoptedStyleSheets&&i.CSSStyleSheet){let s=tg.get(r);if(s)return e[wf]=s;this.sheet=new i.CSSStyleSheet,tg.set(r,this)}else this.styleTag=r.createElement("style"),n&&this.styleTag.setAttribute("nonce",n);this.modules=[],e[wf]=this}mount(e,n){let r=this.sheet,i=0,s=0;for(let o=0;o<e.length;o++){let l=e[o],a=this.modules.indexOf(l);if(a<s&&a>-1&&(this.modules.splice(a,1),s--,a=-1),a==-1){if(this.modules.splice(s++,0,l),r)for(let u=0;u<l.rules.length;u++)r.insertRule(l.rules[u],i++)}else{for(;s<a;)i+=this.modules[s++].rules.length;i+=l.rules.length,s++}}if(r)n.adoptedStyleSheets.indexOf(this.sheet)<0&&(n.adoptedStyleSheets=[this.sheet,...n.adoptedStyleSheets]);else{let o="";for(let a=0;a<this.modules.length;a++)o+=this.modules[a].getRules()+`
`;this.styleTag.textContent=o;let l=n.head||n;this.styleTag.parentNode!=l&&l.insertBefore(this.styleTag,l.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var wr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},xo={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},w2=typeof navigator<"u"&&/Mac/.test(navigator.platform),x2=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var _e=0;_e<10;_e++)wr[48+_e]=wr[96+_e]=String(_e);for(var _e=1;_e<=24;_e++)wr[_e+111]="F"+_e;for(var _e=65;_e<=90;_e++)wr[_e]=String.fromCharCode(_e+32),xo[_e]=String.fromCharCode(_e);for(var Mc in wr)xo.hasOwnProperty(Mc)||(xo[Mc]=wr[Mc]);function S2(t){var e=w2&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||x2&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?xo:wr)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}function ae(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var i=n[r];typeof i=="string"?t.setAttribute(r,i):i!=null&&(t[r]=i)}e++}for(;e<arguments.length;e++)z1(t,arguments[e]);return t}function z1(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)z1(t,e[n]);else throw new RangeError("Unsupported child node: "+e)}let tt=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},xf=typeof document<"u"?document:{documentElement:{style:{}}};const Sf=/Edge\/(\d+)/.exec(tt.userAgent),W1=/MSIE \d/.test(tt.userAgent),kf=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(tt.userAgent),Nu=!!(W1||kf||Sf),ng=!Nu&&/gecko\/(\d+)/i.test(tt.userAgent),Ac=!Nu&&/Chrome\/(\d+)/.exec(tt.userAgent),k2="webkitFontSmoothing"in xf.documentElement.style,bf=!Nu&&/Apple Computer/.test(tt.vendor),rg=bf&&(/Mobile\/\w+/.test(tt.userAgent)||tt.maxTouchPoints>2);var _={mac:rg||/Mac/.test(tt.platform),windows:/Win/.test(tt.platform),linux:/Linux|X11/.test(tt.platform),ie:Nu,ie_version:W1?xf.documentMode||6:kf?+kf[1]:Sf?+Sf[1]:0,gecko:ng,gecko_version:ng?+(/Firefox\/(\d+)/.exec(tt.userAgent)||[0,0])[1]:0,chrome:!!Ac,chrome_version:Ac?+Ac[1]:0,ios:rg,android:/Android\b/.test(tt.userAgent),webkit_version:k2?+(/\bAppleWebKit\/(\d+)/.exec(tt.userAgent)||[0,0])[1]:0,safari:bf,safari_version:bf?+(/\bVersion\/(\d+(\.\d+)?)/.exec(tt.userAgent)||[0,0])[1]:0,tabSize:xf.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function So(t){let e;return t.nodeType==11?e=t.getSelection?t:t.ownerDocument:e=t,e.getSelection()}function Cf(t,e){return e?t==e||t.contains(e.nodeType!=1?e.parentNode:e):!1}function aa(t,e){if(!e.anchorNode)return!1;try{return Cf(t,e.anchorNode)}catch{return!1}}function qi(t){return t.nodeType==3?Yr(t,0,t.nodeValue.length).getClientRects():t.nodeType==1?t.getClientRects():[]}function Gs(t,e,n,r){return n?ig(t,e,n,r,-1)||ig(t,e,n,r,1):!1}function Xr(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e}function Va(t){return t.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function ig(t,e,n,r,i){for(;;){if(t==n&&e==r)return!0;if(e==(i<0?0:Cn(t))){if(t.nodeName=="DIV")return!1;let s=t.parentNode;if(!s||s.nodeType!=1)return!1;e=Xr(t)+(i<0?0:1),t=s}else if(t.nodeType==1){if(t=t.childNodes[e+(i<0?-1:0)],t.nodeType==1&&t.contentEditable=="false")return!1;e=i<0?Cn(t):0}else return!1}}function Cn(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Fo(t,e){let n=e?t.left:t.right;return{left:n,right:n,top:t.top,bottom:t.bottom}}function b2(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function V1(t,e){let n=e.width/t.offsetWidth,r=e.height/t.offsetHeight;return(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.width-t.offsetWidth)<1)&&(n=1),(r>.995&&r<1.005||!isFinite(r)||Math.abs(e.height-t.offsetHeight)<1)&&(r=1),{scaleX:n,scaleY:r}}function C2(t,e,n,r,i,s,o,l){let a=t.ownerDocument,u=a.defaultView||window;for(let c=t,h=!1;c&&!h;)if(c.nodeType==1){let f,d=c==a.body,p=1,y=1;if(d)f=b2(u);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(h=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let g=c.getBoundingClientRect();({scaleX:p,scaleY:y}=V1(c,g)),f={left:g.left,right:g.left+c.clientWidth*p,top:g.top,bottom:g.top+c.clientHeight*y}}let w=0,m=0;if(i=="nearest")e.top<f.top?(m=e.top-(f.top+o),n>0&&e.bottom>f.bottom+m&&(m=e.bottom-f.bottom+o)):e.bottom>f.bottom&&(m=e.bottom-f.bottom+o,n<0&&e.top-m<f.top&&(m=e.top-(f.top+o)));else{let g=e.bottom-e.top,v=f.bottom-f.top;m=(i=="center"&&g<=v?e.top+g/2-v/2:i=="start"||i=="center"&&n<0?e.top-o:e.bottom-v+o)-f.top}if(r=="nearest"?e.left<f.left?(w=e.left-(f.left+s),n>0&&e.right>f.right+w&&(w=e.right-f.right+s)):e.right>f.right&&(w=e.right-f.right+s,n<0&&e.left<f.left+w&&(w=e.left-(f.left+s))):w=(r=="center"?e.left+(e.right-e.left)/2-(f.right-f.left)/2:r=="start"==l?e.left-s:e.right-(f.right-f.left)+s)-f.left,w||m)if(d)u.scrollBy(w,m);else{let g=0,v=0;if(m){let x=c.scrollTop;c.scrollTop+=m/y,v=(c.scrollTop-x)*y}if(w){let x=c.scrollLeft;c.scrollLeft+=w/p,g=(c.scrollLeft-x)*p}e={left:e.left-g,top:e.top-v,right:e.right-g,bottom:e.bottom-v},g&&Math.abs(g-w)<1&&(r="nearest"),v&&Math.abs(v-m)<1&&(i="nearest")}if(d)break;(e.top<f.top||e.bottom>f.bottom||e.left<f.left||e.right>f.right)&&(e={left:Math.max(e.left,f.left),right:Math.min(e.right,f.right),top:Math.max(e.top,f.top),bottom:Math.min(e.bottom,f.bottom)}),c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}function M2(t){let e=t.ownerDocument,n,r;for(let i=t.parentNode;i&&!(i==e.body||n&&r);)if(i.nodeType==1)!r&&i.scrollHeight>i.clientHeight&&(r=i),!n&&i.scrollWidth>i.clientWidth&&(n=i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;return{x:n,y:r}}class A2{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:n,focusNode:r}=e;this.set(n,Math.min(e.anchorOffset,n?Cn(n):0),r,Math.min(e.focusOffset,r?Cn(r):0))}set(e,n,r,i){this.anchorNode=e,this.anchorOffset=n,this.focusNode=r,this.focusOffset=i}}let Or=null;_.safari&&_.safari_version>=26&&(Or=!1);function H1(t){if(t.setActive)return t.setActive();if(Or)return t.focus(Or);let e=[];for(let n=t;n&&(e.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(t.focus(Or==null?{get preventScroll(){return Or={preventScroll:!0},!0}}:void 0),!Or){Or=!1;for(let n=0;n<e.length;){let r=e[n++],i=e[n++],s=e[n++];r.scrollTop!=i&&(r.scrollTop=i),r.scrollLeft!=s&&(r.scrollLeft=s)}}}let sg;function Yr(t,e,n=e){let r=sg||(sg=document.createRange());return r.setEnd(t,n),r.setStart(t,e),r}function Ri(t,e,n,r){let i={key:e,code:e,keyCode:n,which:n,cancelable:!0};r&&({altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey}=r);let s=new KeyboardEvent("keydown",i);s.synthetic=!0,t.dispatchEvent(s);let o=new KeyboardEvent("keyup",i);return o.synthetic=!0,t.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function E2(t){for(;t;){if(t&&(t.nodeType==9||t.nodeType==11&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function U1(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function P2(t,e){let n=e.focusNode,r=e.focusOffset;if(!n||e.anchorNode!=n||e.anchorOffset!=r)return!1;for(r=Math.min(r,Cn(n));;)if(r){if(n.nodeType!=1)return!1;let i=n.childNodes[r-1];i.contentEditable=="false"?r--:(n=i,r=Cn(n))}else{if(n==t)return!0;r=Xr(n),n=n.parentNode}}function $1(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function K1(t,e){for(let n=t,r=e;;){if(n.nodeType==3&&r>0)return{node:n,offset:r};if(n.nodeType==1&&r>0){if(n.contentEditable=="false")return null;n=n.childNodes[r-1],r=Cn(n)}else if(n.parentNode&&!Va(n))r=Xr(n),n=n.parentNode;else return null}}function q1(t,e){for(let n=t,r=e;;){if(n.nodeType==3&&r<n.nodeValue.length)return{node:n,offset:r};if(n.nodeType==1&&r<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[r],r=0}else if(n.parentNode&&!Va(n))r=Xr(n)+1,n=n.parentNode;else return null}}class Ke{constructor(e,n,r=!0){this.node=e,this.offset=n,this.precise=r}static before(e,n){return new Ke(e.parentNode,Xr(e),n)}static after(e,n){return new Ke(e.parentNode,Xr(e)+1,n)}}const ip=[];class le{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let n=this.posAtStart;for(let r of this.children){if(r==e)return n;n+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,n){if(this.flags&2){let r=this.dom,i=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=i?i.nextSibling:r.firstChild)){let l=le.get(s);(!l||!l.parent&&l.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,n),o.flags&=-8}if(s=i?i.nextSibling:r.firstChild,n&&!n.written&&n.node==r&&s!=o.dom&&(n.written=!0),o.dom.parentNode==r)for(;s&&s!=o.dom;)s=og(s);else r.insertBefore(o.dom,s);i=o.dom}for(s=i?i.nextSibling:r.firstChild,s&&n&&n.node==r&&(n.written=!0);s;)s=og(s)}else if(this.flags&1)for(let r of this.children)r.flags&7&&(r.sync(e,n),r.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,n){let r;if(e==this.dom)r=this.dom.childNodes[n];else{let i=Cn(e)==0?0:n==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;i==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?i=-1:i=1),e=s}i<0?r=e:r=e.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!le.get(r);)r=r.nextSibling;if(!r)return this.length;for(let i=0,s=0;;i++){let o=this.children[i];if(o.dom==r)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,n,r=0){let i=-1,s=-1,o=-1,l=-1;for(let a=0,u=r,c=r;a<this.children.length;a++){let h=this.children[a],f=u+h.length;if(u<e&&f>n)return h.domBoundsAround(e,n,u);if(f>=e&&i==-1&&(i=a,s=u),u>n&&h.dom.parentNode==this.dom){o=a,l=c;break}c=f,u=f+h.breakAfter}return{from:s,to:l<0?r+this.length:l,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let n=this.parent;n;n=n.parent){if(e&&(n.flags|=2),n.flags&1)return;n.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let n=e.parent;if(!n)return e;e=n}}replaceChildren(e,n,r=ip){this.markDirty();for(let i=e;i<n;i++){let s=this.children[i];s.parent==this&&r.indexOf(s)<0&&s.destroy()}r.length<250?this.children.splice(e,n-e,...r):this.children=[].concat(this.children.slice(0,e),r,this.children.slice(n));for(let i=0;i<r.length;i++)r[i].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new G1(this.children,e,this.children.length)}childPos(e,n=1){return this.childCursor().findPos(e,n)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,n,r,i,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}le.prototype.breakAfter=0;function og(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class G1{constructor(e,n,r){this.children=e,this.pos=n,this.i=r,this.off=0}findPos(e,n=1){for(;;){if(e>this.pos||e==this.pos&&(n>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let r=this.children[--this.i];this.pos-=r.length+r.breakAfter}}}function X1(t,e,n,r,i,s,o,l,a){let{children:u}=t,c=u.length?u[e]:null,h=s.length?s[s.length-1]:null,f=h?h.breakAfter:o;if(!(e==r&&c&&!o&&!f&&s.length<2&&c.merge(n,i,s.length?h:null,n==0,l,a))){if(r<u.length){let d=u[r];d&&(i<d.length||d.breakAfter&&(h!=null&&h.breakAfter))?(e==r&&(d=d.split(i),i=0),!f&&h&&d.merge(0,i,h,!0,0,a)?s[s.length-1]=d:((i||d.children.length&&!d.children[0].length)&&d.merge(0,i,null,!1,0,a),s.push(d))):d!=null&&d.breakAfter&&(h?h.breakAfter=1:o=1),r++}for(c&&(c.breakAfter=o,n>0&&(!o&&s.length&&c.merge(n,c.length,s[0],!1,l,0)?c.breakAfter=s.shift().breakAfter:(n<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(n,c.length,null,!1,l,0),e++));e<r&&s.length;)if(u[r-1].become(s[s.length-1]))r--,s.pop(),a=s.length?0:l;else if(u[e].become(s[0]))e++,s.shift(),l=s.length?0:a;else break;!s.length&&e&&r<u.length&&!u[e-1].breakAfter&&u[r].merge(0,0,u[e-1],!1,l,a)&&e--,(e<r||s.length)&&t.replaceChildren(e,r,s)}}function Y1(t,e,n,r,i,s){let o=t.childCursor(),{i:l,off:a}=o.findPos(n,1),{i:u,off:c}=o.findPos(e,-1),h=e-n;for(let f of r)h+=f.length;t.length+=h,X1(t,u,c,l,a,r,0,i,s)}const D2=256;class tn extends le{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,n){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(n&&n.node==this.dom&&(n.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,n,r){return this.flags&8||r&&(!(r instanceof tn)||this.length-(n-e)+r.length>D2||r.flags&8)?!1:(this.text=this.text.slice(0,e)+(r?r.text:"")+this.text.slice(n),this.markDirty(),!0)}split(e){let n=new tn(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),n.flags|=this.flags&8,n}localPosFromDOM(e,n){return e==this.dom?n:n?this.text.length:0}domAtPos(e){return new Ke(this.dom,e)}domBoundsAround(e,n,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,n){return T2(this.dom,e,n)}}class Wn extends le{constructor(e,n=[],r=0){super(),this.mark=e,this.children=n,this.length=r;for(let i of n)i.setParent(this)}setAttrs(e){if(U1(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let n in this.mark.attrs)e.setAttribute(n,this.mark.attrs[n]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,n){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,n)}merge(e,n,r,i,s,o){return r&&(!(r instanceof Wn&&r.mark.eq(this.mark))||e&&s<=0||n<this.length&&o<=0)?!1:(Y1(this,e,n,r?r.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(e){let n=[],r=0,i=-1,s=0;for(let l of this.children){let a=r+l.length;a>e&&n.push(r<e?l.split(e-r):l),i<0&&r>=e&&(i=s),r=a,s++}let o=this.length-e;return this.length=e,i>-1&&(this.children.length=i,this.markDirty()),new Wn(this.mark,n,o)}domAtPos(e){return Q1(this,e)}coordsAt(e,n){return Z1(this,e,n)}}function T2(t,e,n){let r=t.nodeValue.length;e>r&&(e=r);let i=e,s=e,o=0;e==0&&n<0||e==r&&n>=0?_.chrome||_.gecko||(e?(i--,o=1):s<r&&(s++,o=-1)):n<0?i--:s<r&&s++;let l=Yr(t,i,s).getClientRects();if(!l.length)return null;let a=l[(o?o<0:n>=0)?0:l.length-1];return _.safari&&!o&&a.width==0&&(a=Array.prototype.find.call(l,u=>u.width)||a),o?Fo(a,o<0):a||null}class ir extends le{static create(e,n,r){return new ir(e,n,r)}constructor(e,n,r){super(),this.widget=e,this.length=n,this.side=r,this.prevWidget=null}split(e){let n=ir.create(this.widget,this.length-e,this.side);return this.length-=e,n}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,n,r,i,s,o){return r&&(!(r instanceof ir)||!this.widget.compare(r.widget)||e>0&&s<=0||n<this.length&&o<=0)?!1:(this.length=e+(r?r.length:0)+(this.length-n),!0)}become(e){return e instanceof ir&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return re.empty;let e=this;for(;e.parent;)e=e.parent;let{view:n}=e,r=n&&n.state.doc,i=this.posAtStart;return r?r.slice(i,i+this.length):re.empty}domAtPos(e){return(this.length?e==0:this.side>0)?Ke.before(this.dom):Ke.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,n){let r=this.widget.coordsAt(this.dom,e,n);if(r)return r;let i=this.dom.getClientRects(),s=null;if(!i.length)return null;let o=this.side?this.side<0:e>0;for(let l=o?i.length-1:0;s=i[l],!(e>0?l==0:l==i.length-1||s.top<s.bottom);l+=o?-1:1);return Fo(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Gi extends le{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Gi&&e.side==this.side}split(){return new Gi(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Ke.before(this.dom):Ke.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return re.empty}get isHidden(){return!0}}tn.prototype.children=ir.prototype.children=Gi.prototype.children=ip;function Q1(t,e){let n=t.dom,{children:r}=t,i=0;for(let s=0;i<r.length;i++){let o=r[i],l=s+o.length;if(!(l==s&&o.getSide()<=0)){if(e>s&&e<l&&o.dom.parentNode==n)return o.domAtPos(e-s);if(e<=s)break;s=l}}for(let s=i;s>0;s--){let o=r[s-1];if(o.dom.parentNode==n)return o.domAtPos(o.length)}for(let s=i;s<r.length;s++){let o=r[s];if(o.dom.parentNode==n)return o.domAtPos(0)}return new Ke(n,0)}function J1(t,e,n){let r,{children:i}=t;n>0&&e instanceof Wn&&i.length&&(r=i[i.length-1])instanceof Wn&&r.mark.eq(e.mark)?J1(r,e.children[0],n-1):(i.push(e),e.setParent(t)),t.length+=e.length}function Z1(t,e,n){let r=null,i=-1,s=null,o=-1;function l(u,c){for(let h=0,f=0;h<u.children.length&&f<=c;h++){let d=u.children[h],p=f+d.length;p>=c&&(d.children.length?l(d,c-f):(!s||s.isHidden&&(n>0||R2(s,d)))&&(p>c||f==p&&d.getSide()>0)?(s=d,o=c-f):(f<c||f==p&&d.getSide()<0&&!d.isHidden)&&(r=d,i=c-f)),f=p}}l(t,e);let a=(n<0?r:s)||r||s;return a?a.coordsAt(Math.max(0,a==r?i:o),n):O2(t)}function O2(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let n=qi(e);return n[n.length-1]||null}function R2(t,e){let n=t.coordsAt(0,1),r=e.coordsAt(0,1);return n&&r&&r.top<n.bottom}function Mf(t,e){for(let n in t)n=="class"&&e.class?e.class+=" "+t.class:n=="style"&&e.style?e.style+=";"+t.style:e[n]=t[n];return e}const lg=Object.create(null);function Ha(t,e,n){if(t==e)return!0;t||(t=lg),e||(e=lg);let r=Object.keys(t),i=Object.keys(e);if(r.length-(n&&r.indexOf(n)>-1?1:0)!=i.length-(n&&i.indexOf(n)>-1?1:0))return!1;for(let s of r)if(s!=n&&(i.indexOf(s)==-1||t[s]!==e[s]))return!1;return!0}function Af(t,e,n){let r=!1;if(e)for(let i in e)n&&i in n||(r=!0,i=="style"?t.style.cssText="":t.removeAttribute(i));if(n)for(let i in n)e&&e[i]==n[i]||(r=!0,i=="style"?t.style.cssText=n[i]:t.setAttribute(i,n[i]));return r}function N2(t){let e=Object.create(null);for(let n=0;n<t.attributes.length;n++){let r=t.attributes[n];e[r.name]=r.value}return e}class Un{eq(e){return!1}updateDOM(e,n){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,n,r){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var it=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(it||(it={}));class $ extends Gr{constructor(e,n,r,i){super(),this.startSide=e,this.endSide=n,this.widget=r,this.spec=i}get heightRelevant(){return!1}static mark(e){return new zo(e)}static widget(e){let n=Math.max(-1e4,Math.min(1e4,e.side||0)),r=!!e.block;return n+=r&&!e.inlineOrder?n>0?3e8:-4e8:n>0?1e8:-1e8,new xr(e,n,n,r,e.widget||null,!1)}static replace(e){let n=!!e.block,r,i;if(e.isBlockGap)r=-5e8,i=4e8;else{let{start:s,end:o}=ew(e,n);r=(s?n?-3e8:-1:5e8)-1,i=(o?n?2e8:1:-6e8)+1}return new xr(e,r,i,n,e.widget||null,!0)}static line(e){return new Wo(e)}static set(e,n=!1){return ne.of(e,n)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}$.none=ne.empty;class zo extends ${constructor(e){let{start:n,end:r}=ew(e);super(n?-1:5e8,r?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var n,r;return this==e||e instanceof zo&&this.tagName==e.tagName&&(this.class||((n=this.attrs)===null||n===void 0?void 0:n.class))==(e.class||((r=e.attrs)===null||r===void 0?void 0:r.class))&&Ha(this.attrs,e.attrs,"class")}range(e,n=e){if(e>=n)throw new RangeError("Mark decorations may not be empty");return super.range(e,n)}}zo.prototype.point=!1;class Wo extends ${constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Wo&&this.spec.class==e.spec.class&&Ha(this.spec.attributes,e.spec.attributes)}range(e,n=e){if(n!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,n)}}Wo.prototype.mapMode=nt.TrackBefore;Wo.prototype.point=!0;class xr extends ${constructor(e,n,r,i,s,o){super(n,r,s,e),this.block=i,this.isReplace=o,this.mapMode=i?n<=0?nt.TrackBefore:nt.TrackAfter:nt.TrackDel}get type(){return this.startSide!=this.endSide?it.WidgetRange:this.startSide<=0?it.WidgetBefore:it.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof xr&&L2(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,n=e){if(this.isReplace&&(e>n||e==n&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&n!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,n)}}xr.prototype.point=!0;function ew(t,e=!1){let{inclusiveStart:n,inclusiveEnd:r}=t;return n==null&&(n=t.inclusive),r==null&&(r=t.inclusive),{start:n??e,end:r??e}}function L2(t,e){return t==e||!!(t&&e&&t.compare(e))}function ua(t,e,n,r=0){let i=n.length-1;i>=0&&n[i]+r>=t?n[i]=Math.max(n[i],e):n.push(t,e)}class Me extends le{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,n,r,i,s,o){if(r){if(!(r instanceof Me))return!1;this.dom||r.transferDOM(this)}return i&&this.setDeco(r?r.attrs:null),Y1(this,e,n,r?r.children.slice():[],s,o),!0}split(e){let n=new Me;if(n.breakAfter=this.breakAfter,this.length==0)return n;let{i:r,off:i}=this.childPos(e);i&&(n.append(this.children[r].split(i),0),this.children[r].merge(i,this.children[r].length,null,!1,0,0),r++);for(let s=r;s<this.children.length;s++)n.append(this.children[s],0);for(;r>0&&this.children[r-1].length==0;)this.children[--r].destroy();return this.children.length=r,this.markDirty(),this.length=e,n}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Ha(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,n){J1(this,e,n)}addLineDeco(e){let n=e.spec.attributes,r=e.spec.class;n&&(this.attrs=Mf(n,this.attrs||{})),r&&(this.attrs=Mf({class:r},this.attrs||{}))}domAtPos(e){return Q1(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,n){var r;this.dom?this.flags&4&&(U1(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Af(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,n);let i=this.dom.lastChild;for(;i&&le.get(i)instanceof Wn;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((r=le.get(i))===null||r===void 0?void 0:r.isEditable)==!1&&(!_.ios||!this.children.some(s=>s instanceof tn))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,n;for(let r of this.children){if(!(r instanceof tn)||/[^ -~]/.test(r.text))return null;let i=qi(r.dom);if(i.length!=1)return null;e+=i[0].width,n=i[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:n}:null}coordsAt(e,n){let r=Z1(this,e,n);if(!this.children.length&&r&&this.parent){let{heightOracle:i}=this.parent.view.viewState,s=r.bottom-r.top;if(Math.abs(s-i.lineHeight)<2&&i.textHeight<s){let o=(s-i.textHeight)/2;return{top:r.top+o,bottom:r.bottom-o,left:r.left,right:r.left}}}return r}become(e){return e instanceof Me&&this.children.length==0&&e.children.length==0&&Ha(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,n){for(let r=0,i=0;r<e.children.length;r++){let s=e.children[r],o=i+s.length;if(o>=n){if(s instanceof Me)return s;if(o>n)break}i=o+s.breakAfter}return null}}class Bn extends le{constructor(e,n,r){super(),this.widget=e,this.length=n,this.deco=r,this.breakAfter=0,this.prevWidget=null}merge(e,n,r,i,s,o){return r&&(!(r instanceof Bn)||!this.widget.compare(r.widget)||e>0&&s<=0||n<this.length&&o<=0)?!1:(this.length=e+(r?r.length:0)+(this.length-n),!0)}domAtPos(e){return e==0?Ke.before(this.dom):Ke.after(this.dom,e==this.length)}split(e){let n=this.length-e;this.length=e;let r=new Bn(this.widget,n,this.deco);return r.breakAfter=this.breakAfter,r}get children(){return ip}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):re.empty}domBoundsAround(){return null}become(e){return e instanceof Bn&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,n){let r=this.widget.coordsAt(this.dom,e,n);return r||(this.widget instanceof Ef?null:Fo(this.dom.getBoundingClientRect(),this.length?e==0:n<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:n,endSide:r}=this.deco;return n==r?!1:e<0?n<0:r>0}}class Ef extends Un{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class Xs{constructor(e,n,r,i){this.doc=e,this.pos=n,this.end=r,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=n}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Bn&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Me),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(yl(new Gi(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Bn)&&this.getLine()}buildText(e,n,r){for(;e>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:l,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(l){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=o,this.textOff=0}let i=Math.min(this.text.length-this.textOff,e),s=Math.min(i,512);this.flushBuffer(n.slice(n.length-r)),this.getLine().append(yl(new tn(this.text.slice(this.textOff,this.textOff+s)),n),r),this.atCursorPos=!0,this.textOff+=s,e-=s,r=i<=s?0:n.length}}span(e,n,r,i){this.buildText(n-e,r,i),this.pos=n,this.openStart<0&&(this.openStart=i)}point(e,n,r,i,s,o){if(this.disallowBlockEffectsFor[o]&&r instanceof xr){if(r.block)throw new RangeError("Block decorations may not be specified via plugins");if(n>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=n-e;if(r instanceof xr)if(r.block)r.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Bn(r.widget||Xi.block,l,r));else{let a=ir.create(r.widget||Xi.inline,l,l?0:r.startSide),u=this.atCursorPos&&!a.isEditable&&s<=i.length&&(e<n||r.startSide>0),c=!a.isEditable&&(e<n||s>i.length||r.startSide<=0),h=this.getLine();this.pendingBuffer==2&&!u&&!a.isEditable&&(this.pendingBuffer=0),this.flushBuffer(i),u&&(h.append(yl(new Gi(1),i),s),s=i.length+Math.max(0,s-i.length)),h.append(yl(a,i),s),this.atCursorPos=c,this.pendingBuffer=c?e<n||s>i.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=i.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(r);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=n),this.openStart<0&&(this.openStart=s)}static build(e,n,r,i,s){let o=new Xs(e,n,r,s);return o.openEnd=ne.spans(i,n,r,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function yl(t,e){for(let n of e)t=new Wn(n,[t],t.length);return t}class Xi extends Un{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Xi.inline=new Xi("span");Xi.block=new Xi("div");var pe=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(pe||(pe={}));const Qr=pe.LTR,sp=pe.RTL;function tw(t){let e=[];for(let n=0;n<t.length;n++)e.push(1<<+t[n]);return e}const B2=tw("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),_2=tw("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Pf=Object.create(null),an=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),n=t.charCodeAt(1);Pf[e]=n,Pf[n]=-e}function nw(t){return t<=247?B2[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?_2[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const I2=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class sr{get dir(){return this.level%2?sp:Qr}constructor(e,n,r){this.from=e,this.to=n,this.level=r}side(e,n){return this.dir==n==e?this.to:this.from}forward(e,n){return e==(this.dir==n)}static find(e,n,r,i){let s=-1;for(let o=0;o<e.length;o++){let l=e[o];if(l.from<=n&&l.to>=n){if(l.level==r)return o;(s<0||(i!=0?i<0?l.from<n:l.to>n:e[s].level>l.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function rw(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++){let r=t[n],i=e[n];if(r.from!=i.from||r.to!=i.to||r.direction!=i.direction||!rw(r.inner,i.inner))return!1}return!0}const ue=[];function j2(t,e,n,r,i){for(let s=0;s<=r.length;s++){let o=s?r[s-1].to:e,l=s<r.length?r[s].from:n,a=s?256:i;for(let u=o,c=a,h=a;u<l;u++){let f=nw(t.charCodeAt(u));f==512?f=c:f==8&&h==4&&(f=16),ue[u]=f==4?2:f,f&7&&(h=f),c=f}for(let u=o,c=a,h=a;u<l;u++){let f=ue[u];if(f==128)u<l-1&&c==ue[u+1]&&c&24?f=ue[u]=c:ue[u]=256;else if(f==64){let d=u+1;for(;d<l&&ue[d]==64;)d++;let p=u&&c==8||d<n&&ue[d]==8?h==1?1:8:256;for(let y=u;y<d;y++)ue[y]=p;u=d-1}else f==8&&h==1&&(ue[u]=1);c=f,f&7&&(h=f)}}}function F2(t,e,n,r,i){let s=i==1?2:1;for(let o=0,l=0,a=0;o<=r.length;o++){let u=o?r[o-1].to:e,c=o<r.length?r[o].from:n;for(let h=u,f,d,p;h<c;h++)if(d=Pf[f=t.charCodeAt(h)])if(d<0){for(let y=l-3;y>=0;y-=3)if(an[y+1]==-d){let w=an[y+2],m=w&2?i:w&4?w&1?s:i:0;m&&(ue[h]=ue[an[y]]=m),l=y;break}}else{if(an.length==189)break;an[l++]=h,an[l++]=f,an[l++]=a}else if((p=ue[h])==2||p==1){let y=p==i;a=y?0:1;for(let w=l-3;w>=0;w-=3){let m=an[w+2];if(m&2)break;if(y)an[w+2]|=2;else{if(m&4)break;an[w+2]|=4}}}}}function z2(t,e,n,r){for(let i=0,s=r;i<=n.length;i++){let o=i?n[i-1].to:t,l=i<n.length?n[i].from:e;for(let a=o;a<l;){let u=ue[a];if(u==256){let c=a+1;for(;;)if(c==l){if(i==n.length)break;c=n[i++].to,l=i<n.length?n[i].from:e}else if(ue[c]==256)c++;else break;let h=s==1,f=(c<e?ue[c]:r)==1,d=h==f?h?1:2:r;for(let p=c,y=i,w=y?n[y-1].to:t;p>a;)p==w&&(p=n[--y].from,w=y?n[y-1].to:t),ue[--p]=d;a=c}else s=u,a++}}}function Df(t,e,n,r,i,s,o){let l=r%2?2:1;if(r%2==i%2)for(let a=e,u=0;a<n;){let c=!0,h=!1;if(u==s.length||a<s[u].from){let y=ue[a];y!=l&&(c=!1,h=y==16)}let f=!c&&l==1?[]:null,d=c?r:r+1,p=a;e:for(;;)if(u<s.length&&p==s[u].from){if(h)break e;let y=s[u];if(!c)for(let w=y.to,m=u+1;;){if(w==n)break e;if(m<s.length&&s[m].from==w)w=s[m++].to;else{if(ue[w]==l)break e;break}}if(u++,f)f.push(y);else{y.from>a&&o.push(new sr(a,y.from,d));let w=y.direction==Qr!=!(d%2);Tf(t,w?r+1:r,i,y.inner,y.from,y.to,o),a=y.to}p=y.to}else{if(p==n||(c?ue[p]!=l:ue[p]==l))break;p++}f?Df(t,a,p,r+1,i,f,o):a<p&&o.push(new sr(a,p,d)),a=p}else for(let a=n,u=s.length;a>e;){let c=!0,h=!1;if(!u||a>s[u-1].to){let y=ue[a-1];y!=l&&(c=!1,h=y==16)}let f=!c&&l==1?[]:null,d=c?r:r+1,p=a;e:for(;;)if(u&&p==s[u-1].to){if(h)break e;let y=s[--u];if(!c)for(let w=y.from,m=u;;){if(w==e)break e;if(m&&s[m-1].to==w)w=s[--m].from;else{if(ue[w-1]==l)break e;break}}if(f)f.push(y);else{y.to<a&&o.push(new sr(y.to,a,d));let w=y.direction==Qr!=!(d%2);Tf(t,w?r+1:r,i,y.inner,y.from,y.to,o),a=y.from}p=y.from}else{if(p==e||(c?ue[p-1]!=l:ue[p-1]==l))break;p--}f?Df(t,p,a,r+1,i,f,o):p<a&&o.push(new sr(p,a,d)),a=p}}function Tf(t,e,n,r,i,s,o){let l=e%2?2:1;j2(t,i,s,r,l),F2(t,i,s,r,l),z2(i,s,r,l),Df(t,i,s,e,n,r,o)}function W2(t,e,n){if(!t)return[new sr(0,0,e==sp?1:0)];if(e==Qr&&!n.length&&!I2.test(t))return iw(t.length);if(n.length)for(;t.length>ue.length;)ue[ue.length]=256;let r=[],i=e==Qr?0:1;return Tf(t,i,i,n,0,t.length,r),r}function iw(t){return[new sr(0,t,0)]}let sw="";function V2(t,e,n,r,i){var s;let o=r.head-t.from,l=sr.find(e,o,(s=r.bidiLevel)!==null&&s!==void 0?s:-1,r.assoc),a=e[l],u=a.side(i,n);if(o==u){let f=l+=i?1:-1;if(f<0||f>=e.length)return null;a=e[l=f],o=a.side(!i,n),u=a.side(i,n)}let c=je(t.text,o,a.forward(i,n));(c<a.from||c>a.to)&&(c=u),sw=t.text.slice(Math.min(o,c),Math.max(o,c));let h=l==(i?e.length-1:0)?null:e[l+(i?1:-1)];return h&&c==u&&h.level+(i?0:1)<a.level?A.cursor(h.side(!i,n)+t.from,h.forward(i,n)?1:-1,h.level):A.cursor(c+t.from,a.forward(i,n)?-1:1,a.level)}function H2(t,e,n){for(let r=e;r<n;r++){let i=nw(t.charCodeAt(r));if(i==1)return Qr;if(i==2||i==4)return sp}return Qr}const ow=I.define(),lw=I.define(),aw=I.define(),uw=I.define(),Of=I.define(),cw=I.define(),hw=I.define(),op=I.define(),lp=I.define(),fw=I.define({combine:t=>t.some(e=>e)}),dw=I.define({combine:t=>t.some(e=>e)}),pw=I.define();class Ni{constructor(e,n="nearest",r="nearest",i=5,s=5,o=!1){this.range=e,this.y=n,this.x=r,this.yMargin=i,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new Ni(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Ni(A.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const vl=G.define({map:(t,e)=>t.map(e)}),mw=G.define();function pt(t,e,n){let r=t.facet(uw);r.length?r[0](e):window.onerror&&window.onerror(String(e),n,void 0,void 0,e)||(n?console.error(n+":",e):console.error(e))}const On=I.define({combine:t=>t.length?t[0]:!0});let U2=0;const ki=I.define({combine(t){return t.filter((e,n)=>{for(let r=0;r<n;r++)if(t[r].plugin==e.plugin)return!1;return!0})}});class Ce{constructor(e,n,r,i,s){this.id=e,this.create=n,this.domEventHandlers=r,this.domEventObservers=i,this.baseExtensions=s(this),this.extension=this.baseExtensions.concat(ki.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(ki.of({plugin:this,arg:e}))}static define(e,n){const{eventHandlers:r,eventObservers:i,provide:s,decorations:o}=n||{};return new Ce(U2++,e,r,i,l=>{let a=[];return o&&a.push(ko.of(u=>{let c=u.plugin(l);return c?o(c):$.none})),s&&a.push(s(l)),a})}static fromClass(e,n){return Ce.define((r,i)=>new e(r,i),n)}}class Ec{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let n=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(n)}catch(r){if(pt(n.state,r,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(n){pt(e.state,n,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var n;if(!((n=this.value)===null||n===void 0)&&n.destroy)try{this.value.destroy()}catch(r){pt(e.state,r,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const gw=I.define(),ap=I.define(),ko=I.define(),yw=I.define(),Vo=I.define(),vw=I.define();function ag(t,e){let n=t.state.facet(vw);if(!n.length)return n;let r=n.map(s=>s instanceof Function?s(t):s),i=[];return ne.spans(r,e.from,e.to,{point(){},span(s,o,l,a){let u=s-e.from,c=o-e.from,h=i;for(let f=l.length-1;f>=0;f--,a--){let d=l[f].spec.bidiIsolate,p;if(d==null&&(d=H2(e.text,u,c)),a>0&&h.length&&(p=h[h.length-1]).to==u&&p.direction==d)p.to=c,h=p.inner;else{let y={from:u,to:c,direction:d,inner:[]};h.push(y),h=y.inner}}}}),i}const ww=I.define();function up(t){let e=0,n=0,r=0,i=0;for(let s of t.state.facet(ww)){let o=s(t);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(n=Math.max(n,o.right)),o.top!=null&&(r=Math.max(r,o.top)),o.bottom!=null&&(i=Math.max(i,o.bottom)))}return{left:e,right:n,top:r,bottom:i}}const Rs=I.define();class jt{constructor(e,n,r,i){this.fromA=e,this.toA=n,this.fromB=r,this.toB=i}join(e){return new jt(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let n=e.length,r=this;for(;n>0;n--){let i=e[n-1];if(!(i.fromA>r.toA)){if(i.toA<r.fromA)break;r=r.join(i),e.splice(n-1,1)}}return e.splice(n,0,r),e}static extendWithRanges(e,n){if(n.length==0)return e;let r=[];for(let i=0,s=0,o=0,l=0;;i++){let a=i==e.length?null:e[i],u=o-l,c=a?a.fromB:1e9;for(;s<n.length&&n[s]<c;){let h=n[s],f=n[s+1],d=Math.max(l,h),p=Math.min(c,f);if(d<=p&&new jt(d+u,p+u,d,p).addToSet(r),f>c)break;s+=2}if(!a)return r;new jt(a.fromA,a.toA,a.fromB,a.toB).addToSet(r),o=a.toA,l=a.toB}}}class Ua{constructor(e,n,r){this.view=e,this.state=n,this.transactions=r,this.flags=0,this.startState=e.state,this.changes=Pe.empty(this.startState.doc.length);for(let s of r)this.changes=this.changes.compose(s.changes);let i=[];this.changes.iterChangedRanges((s,o,l,a)=>i.push(new jt(s,o,l,a))),this.changedRanges=i}static create(e,n,r){return new Ua(e,n,r)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class ug extends le{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=$.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Me],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new jt(0,0,0,e.state.doc.length)],0,null)}update(e){var n;let r=e.changedRanges;this.minWidth>0&&r.length&&(r.every(({fromA:u,toA:c})=>c<this.minWidthFrom||u>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let i=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((n=this.domChanged)===null||n===void 0)&&n.newSel?i=this.domChanged.newSel.head:!Q2(e.changes,this.hasComposition)&&!e.selectionSet&&(i=e.state.selection.main.head));let s=i>-1?K2(this.view,e.changes,i):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:u,to:c}=this.hasComposition;r=new jt(u,c,e.changes.mapPos(u,-1),e.changes.mapPos(c,1)).addToSet(r.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(_.ie||_.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,l=this.updateDeco(),a=X2(o,l,e.changes);return r=jt.extendWithRanges(r,a),!(this.flags&7)&&r.length==0?!1:(this.updateInner(r,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,n,r){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,n,r);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=_.chrome||_.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||i.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Bn&&o.widget instanceof Ef&&s.push(o.dom);i.updateGaps(s)}updateChildren(e,n,r){let i=r?r.range.addToSet(e.slice()):e,s=this.childCursor(n);for(let o=i.length-1;;o--){let l=o>=0?i[o]:null;if(!l)break;let{fromA:a,toA:u,fromB:c,toB:h}=l,f,d,p,y;if(r&&r.range.fromB<h&&r.range.toB>c){let x=Xs.build(this.view.state.doc,c,r.range.fromB,this.decorations,this.dynamicDecorationMap),k=Xs.build(this.view.state.doc,r.range.toB,h,this.decorations,this.dynamicDecorationMap);d=x.breakAtStart,p=x.openStart,y=k.openEnd;let b=this.compositionView(r);k.breakAtStart?b.breakAfter=1:k.content.length&&b.merge(b.length,b.length,k.content[0],!1,k.openStart,0)&&(b.breakAfter=k.content[0].breakAfter,k.content.shift()),x.content.length&&b.merge(0,0,x.content[x.content.length-1],!0,0,x.openEnd)&&x.content.pop(),f=x.content.concat(b).concat(k.content)}else({content:f,breakAtStart:d,openStart:p,openEnd:y}=Xs.build(this.view.state.doc,c,h,this.decorations,this.dynamicDecorationMap));let{i:w,off:m}=s.findPos(u,1),{i:g,off:v}=s.findPos(a,-1);X1(this,g,v,w,m,f,d,p,y)}r&&this.fixCompositionDOM(r)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let n of e.transactions)for(let r of n.effects)r.is(mw)&&(this.editContextFormatting=r.value)}compositionView(e){let n=new tn(e.text.nodeValue);n.flags|=8;for(let{deco:i}of e.marks)n=new Wn(i,[n],n.length);let r=new Me;return r.append(n,0),r}fixCompositionDOM(e){let n=(s,o)=>{o.flags|=8|(o.children.some(a=>a.flags&7)?1:0),this.markedForComposition.add(o);let l=le.get(s);l&&l!=o&&(l.dom=null),o.setDOM(s)},r=this.childPos(e.range.fromB,1),i=this.children[r.i];n(e.line,i);for(let s=e.marks.length-1;s>=-1;s--)r=i.childPos(r.off,1),i=i.children[r.i],n(s>=0?e.marks[s].node:e.text,i)}updateSelection(e=!1,n=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let r=this.view.root.activeElement,i=r==this.dom,s=!i&&!(this.view.state.facet(On)||this.dom.tabIndex>-1)&&aa(this.dom,this.view.observer.selectionRange)&&!(r&&this.dom.contains(r));if(!(i||n||s))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,a=this.moveToLine(this.domAtPos(l.anchor)),u=l.empty?a:this.moveToLine(this.domAtPos(l.head));if(_.gecko&&l.empty&&!this.hasComposition&&$2(a)){let h=document.createTextNode("");this.view.observer.ignore(()=>a.node.insertBefore(h,a.node.childNodes[a.offset]||null)),a=u=new Ke(h,0),o=!0}let c=this.view.observer.selectionRange;(o||!c.focusNode||(!Gs(a.node,a.offset,c.anchorNode,c.anchorOffset)||!Gs(u.node,u.offset,c.focusNode,c.focusOffset))&&!this.suppressWidgetCursorChange(c,l))&&(this.view.observer.ignore(()=>{_.android&&_.chrome&&this.dom.contains(c.focusNode)&&Y2(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let h=So(this.view.root);if(h)if(l.empty){if(_.gecko){let f=q2(a.node,a.offset);if(f&&f!=3){let d=(f==1?K1:q1)(a.node,a.offset);d&&(a=new Ke(d.node,d.offset))}}h.collapse(a.node,a.offset),l.bidiLevel!=null&&h.caretBidiLevel!==void 0&&(h.caretBidiLevel=l.bidiLevel)}else if(h.extend){h.collapse(a.node,a.offset);try{h.extend(u.node,u.offset)}catch{}}else{let f=document.createRange();l.anchor>l.head&&([a,u]=[u,a]),f.setEnd(u.node,u.offset),f.setStart(a.node,a.offset),h.removeAllRanges(),h.addRange(f)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),r&&r.focus())}),this.view.observer.setSelectionRange(a,u)),this.impreciseAnchor=a.precise?null:new Ke(c.anchorNode,c.anchorOffset),this.impreciseHead=u.precise?null:new Ke(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(e,n){return this.hasComposition&&n.empty&&Gs(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==n.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,n=e.state.selection.main,r=So(e.root),{anchorNode:i,anchorOffset:s}=e.observer.selectionRange;if(!r||!n.empty||!n.assoc||!r.modify)return;let o=Me.find(this,n.head);if(!o)return;let l=o.posAtStart;if(n.head==l||n.head==l+o.length)return;let a=this.coordsAt(n.head,-1),u=this.coordsAt(n.head,1);if(!a||!u||a.bottom>u.top)return;let c=this.domAtPos(n.head+n.assoc);r.collapse(c.node,c.offset),r.modify("move",n.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=n.from&&r.collapse(i,s)}moveToLine(e){let n=this.dom,r;if(e.node!=n)return e;for(let i=e.offset;!r&&i<n.childNodes.length;i++){let s=le.get(n.childNodes[i]);s instanceof Me&&(r=s.domAtPos(0))}for(let i=e.offset-1;!r&&i>=0;i--){let s=le.get(n.childNodes[i]);s instanceof Me&&(r=s.domAtPos(s.length))}return r?new Ke(r.node,r.offset,!0):e}nearest(e){for(let n=e;n;){let r=le.get(n);if(r&&r.rootView==this)return r;n=n.parentNode}return null}posFromDOM(e,n){let r=this.nearest(e);if(!r)throw new RangeError("Trying to find position for a DOM position outside of the document");return r.localPosFromDOM(e,n)+r.posAtStart}domAtPos(e){let{i:n,off:r}=this.childCursor().findPos(e,-1);for(;n<this.children.length-1;){let i=this.children[n];if(r<i.length||i instanceof Me)break;n++,r=0}return this.children[n].domAtPos(r)}coordsAt(e,n){let r=null,i=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let l=this.children[o],a=s-l.breakAfter,u=a-l.length;if(a<e)break;if(u<=e&&(u<e||l.covers(-1))&&(a>e||l.covers(1))&&(!r||l instanceof Me&&!(r instanceof Me&&n>=0)))r=l,i=u;else if(r&&u==e&&a==e&&l instanceof Bn&&Math.abs(n)<2){if(l.deco.startSide<0)break;o&&(r=null)}s=u}return r?r.coordsAt(e-i,n):null}coordsForChar(e){let{i:n,off:r}=this.childPos(e,1),i=this.children[n];if(!(i instanceof Me))return null;for(;i.children.length;){let{i:l,off:a}=i.childPos(r,1);for(;;l++){if(l==i.children.length)return null;if((i=i.children[l]).length)break}r=a}if(!(i instanceof tn))return null;let s=je(i.text,r);if(s==r)return null;let o=Yr(i.dom,r,s).getClientRects();for(let l=0;l<o.length;l++){let a=o[l];if(l==o.length-1||a.top<a.bottom&&a.left<a.right)return a}return null}measureVisibleLineHeights(e){let n=[],{from:r,to:i}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,a=this.view.textDirection==pe.LTR;for(let u=0,c=0;c<this.children.length;c++){let h=this.children[c],f=u+h.length;if(f>i)break;if(u>=r){let d=h.dom.getBoundingClientRect();if(n.push(d.height),o){let p=h.dom.lastChild,y=p?qi(p):[];if(y.length){let w=y[y.length-1],m=a?w.right-d.left:d.right-w.left;m>l&&(l=m,this.minWidth=s,this.minWidthFrom=u,this.minWidthTo=f)}}}u=f+h.breakAfter}return n}textDirectionAt(e){let{i:n}=this.childPos(e,1);return getComputedStyle(this.children[n].dom).direction=="rtl"?pe.RTL:pe.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Me){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),n,r,i;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=qi(e.firstChild)[0];n=e.getBoundingClientRect().height,r=s?s.width/27:7,i=s?s.height:n,e.remove()}),{lineHeight:n,charWidth:r,textHeight:i}}childCursor(e=this.length){let n=this.children.length;return n&&(e-=this.children[--n].length),new G1(this.children,e,n)}computeBlockGapDeco(){let e=[],n=this.view.viewState;for(let r=0,i=0;;i++){let s=i==n.viewports.length?null:n.viewports[i],o=s?s.from-1:this.length;if(o>r){let l=(n.lineBlockAt(o).bottom-n.lineBlockAt(r).top)/this.view.scaleY;e.push($.replace({widget:new Ef(l),block:!0,inclusive:!0,isBlockGap:!0}).range(r,o))}if(!s)break;r=s.to+1}return $.set(e)}updateDeco(){let e=1,n=this.view.state.facet(ko).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),r=!1,i=this.view.state.facet(yw).map((s,o)=>{let l=typeof s=="function";return l&&(r=!0),l?s(this.view):s});for(i.length&&(this.dynamicDecorationMap[e++]=r,n.push(ne.join(i))),this.decorations=[this.editContextFormatting,...n,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let u=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=u.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let u of this.view.state.facet(pw))try{if(u(this.view,e.range,e))return!0}catch(c){pt(this.view.state,c,"scroll handler")}let{range:n}=e,r=this.coordsAt(n.head,n.empty?n.assoc:n.head>n.anchor?-1:1),i;if(!r)return;!n.empty&&(i=this.coordsAt(n.anchor,n.anchor>n.head?-1:1))&&(r={left:Math.min(r.left,i.left),top:Math.min(r.top,i.top),right:Math.max(r.right,i.right),bottom:Math.max(r.bottom,i.bottom)});let s=up(this.view),o={left:r.left-s.left,top:r.top-s.top,right:r.right+s.right,bottom:r.bottom+s.bottom},{offsetWidth:l,offsetHeight:a}=this.view.scrollDOM;C2(this.view.scrollDOM,o,n.head<n.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,l),-l),Math.max(Math.min(e.yMargin,a),-a),this.view.textDirection==pe.LTR)}}function $2(t){return t.node.nodeType==1&&t.node.firstChild&&(t.offset==0||t.node.childNodes[t.offset-1].contentEditable=="false")&&(t.offset==t.node.childNodes.length||t.node.childNodes[t.offset].contentEditable=="false")}function xw(t,e){let n=t.observer.selectionRange;if(!n.focusNode)return null;let r=K1(n.focusNode,n.focusOffset),i=q1(n.focusNode,n.focusOffset),s=r||i;if(i&&r&&i.node!=r.node){let l=le.get(i.node);if(!l||l instanceof tn&&l.text!=i.node.nodeValue)s=i;else if(t.docView.lastCompositionAfterCursor){let a=le.get(r.node);!a||a instanceof tn&&a.text!=r.node.nodeValue||(s=i)}}if(t.docView.lastCompositionAfterCursor=s!=r,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function K2(t,e,n){let r=xw(t,n);if(!r)return null;let{node:i,from:s,to:o}=r,l=i.nodeValue;if(/[\n\r]/.test(l)||t.state.doc.sliceString(r.from,r.to)!=l)return null;let a=e.invertedDesc,u=new jt(a.mapPos(s),a.mapPos(o),s,o),c=[];for(let h=i.parentNode;;h=h.parentNode){let f=le.get(h);if(f instanceof Wn)c.push({node:h,deco:f.mark});else{if(f instanceof Me||h.nodeName=="DIV"&&h.parentNode==t.contentDOM)return{range:u,text:i,marks:c,line:h};if(h!=t.contentDOM)c.push({node:h,deco:new zo({inclusive:!0,attributes:N2(h),tagName:h.tagName.toLowerCase()})});else return null}}}function q2(t,e){return t.nodeType!=1?0:(e&&t.childNodes[e-1].contentEditable=="false"?1:0)|(e<t.childNodes.length&&t.childNodes[e].contentEditable=="false"?2:0)}let G2=class{constructor(){this.changes=[]}compareRange(e,n){ua(e,n,this.changes)}comparePoint(e,n){ua(e,n,this.changes)}boundChange(e){ua(e,e,this.changes)}};function X2(t,e,n){let r=new G2;return ne.compare(t,e,n,r),r.changes}function Y2(t,e){for(let n=t;n&&n!=e;n=n.assignedSlot||n.parentNode)if(n.nodeType==1&&n.contentEditable=="false")return!0;return!1}function Q2(t,e){let n=!1;return e&&t.iterChangedRanges((r,i)=>{r<e.to&&i>e.from&&(n=!0)}),n}function J2(t,e,n=1){let r=t.charCategorizer(e),i=t.doc.lineAt(e),s=e-i.from;if(i.length==0)return A.cursor(e);s==0?n=1:s==i.length&&(n=-1);let o=s,l=s;n<0?o=je(i.text,s,!1):l=je(i.text,s);let a=r(i.text.slice(o,l));for(;o>0;){let u=je(i.text,o,!1);if(r(i.text.slice(u,o))!=a)break;o=u}for(;l<i.length;){let u=je(i.text,l);if(r(i.text.slice(l,u))!=a)break;l=u}return A.range(o+i.from,l+i.from)}function Z2(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function eM(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function Pc(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function cg(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function hg(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function Rf(t,e,n){let r,i,s,o,l=!1,a,u,c,h;for(let p=t.firstChild;p;p=p.nextSibling){let y=qi(p);for(let w=0;w<y.length;w++){let m=y[w];i&&Pc(i,m)&&(m=cg(hg(m,i.bottom),i.top));let g=Z2(e,m),v=eM(n,m);if(g==0&&v==0)return p.nodeType==3?fg(p,e,n):Rf(p,e,n);(!r||o>v||o==v&&s>g)&&(r=p,i=m,s=g,o=v,l=g?e<m.left?w>0:w<y.length-1:!0),g==0?n>m.bottom&&(!c||c.bottom<m.bottom)?(a=p,c=m):n<m.top&&(!h||h.top>m.top)&&(u=p,h=m):c&&Pc(c,m)?c=hg(c,m.bottom):h&&Pc(h,m)&&(h=cg(h,m.top))}}if(c&&c.bottom>=n?(r=a,i=c):h&&h.top<=n&&(r=u,i=h),!r)return{node:t,offset:0};let f=Math.max(i.left,Math.min(i.right,e));if(r.nodeType==3)return fg(r,f,n);if(l&&r.contentEditable!="false")return Rf(r,f,n);let d=Array.prototype.indexOf.call(t.childNodes,r)+(e>=(i.left+i.right)/2?1:0);return{node:t,offset:d}}function fg(t,e,n){let r=t.nodeValue.length,i=-1,s=1e9,o=0;for(let l=0;l<r;l++){let a=Yr(t,l,l+1).getClientRects();for(let u=0;u<a.length;u++){let c=a[u];if(c.top==c.bottom)continue;o||(o=e-c.left);let h=(c.top>n?c.top-n:n-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&h<s){let f=e>=(c.left+c.right)/2,d=f;if((_.chrome||_.gecko)&&Yr(t,l).getBoundingClientRect().left==c.right&&(d=!f),h<=0)return{node:t,offset:l+(d?1:0)};i=l+(d?1:0),s=h}}}return{node:t,offset:i>-1?i:o>0?t.nodeValue.length:0}}function Sw(t,e,n,r=-1){var i,s;let o=t.contentDOM.getBoundingClientRect(),l=o.top+t.viewState.paddingTop,a,{docHeight:u}=t.viewState,{x:c,y:h}=e,f=h-l;if(f<0)return 0;if(f>u)return t.state.doc.length;for(let x=t.viewState.heightOracle.textHeight/2,k=!1;a=t.elementAtHeight(f),a.type!=it.Text;)for(;f=r>0?a.bottom+x:a.top-x,!(f>=0&&f<=u);){if(k)return n?null:0;k=!0,r=-r}h=l+f;let d=a.from;if(d<t.viewport.from)return t.viewport.from==0?0:n?null:dg(t,o,a,c,h);if(d>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:n?null:dg(t,o,a,c,h);let p=t.dom.ownerDocument,y=t.root.elementFromPoint?t.root:p,w=y.elementFromPoint(c,h);w&&!t.contentDOM.contains(w)&&(w=null),w||(c=Math.max(o.left+1,Math.min(o.right-1,c)),w=y.elementFromPoint(c,h),w&&!t.contentDOM.contains(w)&&(w=null));let m,g=-1;if(w&&((i=t.docView.nearest(w))===null||i===void 0?void 0:i.isEditable)!=!1){if(p.caretPositionFromPoint){let x=p.caretPositionFromPoint(c,h);x&&({offsetNode:m,offset:g}=x)}else if(p.caretRangeFromPoint){let x=p.caretRangeFromPoint(c,h);x&&({startContainer:m,startOffset:g}=x)}m&&(!t.contentDOM.contains(m)||_.safari&&tM(m,g,c)||_.chrome&&nM(m,g,c))&&(m=void 0),m&&(g=Math.min(Cn(m),g))}if(!m||!t.docView.dom.contains(m)){let x=Me.find(t.docView,d);if(!x)return f>a.top+a.height/2?a.to:a.from;({node:m,offset:g}=Rf(x.dom,c,h))}let v=t.docView.nearest(m);if(!v)return null;if(v.isWidget&&((s=v.dom)===null||s===void 0?void 0:s.nodeType)==1){let x=v.dom.getBoundingClientRect();return e.y<x.top||e.y<=x.bottom&&e.x<=(x.left+x.right)/2?v.posAtStart:v.posAtEnd}else return v.localPosFromDOM(m,g)+v.posAtStart}function dg(t,e,n,r,i){let s=Math.round((r-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&n.height>t.defaultLineHeight*1.5){let l=t.viewState.heightOracle.textHeight,a=Math.floor((i-n.top-(t.defaultLineHeight-l)*.5)/l);s+=a*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(n.from,n.to);return n.from+yf(o,s,t.state.tabSize)}function kw(t,e,n){let r,i=t;if(t.nodeType!=3||e!=(r=t.nodeValue.length))return!1;for(;;){let s=i.nextSibling;if(s){if(s.nodeName=="BR")break;return!1}else{let o=i.parentNode;if(!o||o.nodeName=="DIV")break;i=o}}return Yr(t,r-1,r).getBoundingClientRect().right>n}function tM(t,e,n){return kw(t,e,n)}function nM(t,e,n){if(e!=0)return kw(t,e,n);for(let i=t;;){let s=i.parentNode;if(!s||s.nodeType!=1||s.firstChild!=i)return!1;if(s.classList.contains("cm-line"))break;i=s}let r=t.nodeType==1?t.getBoundingClientRect():Yr(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect();return n-r.left>5}function Nf(t,e,n){let r=t.lineBlockAt(e);if(Array.isArray(r.type)){let i;for(let s of r.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;(!i||s.type==it.Text&&(i.type!=s.type||(n<0?s.from<e:s.to>e)))&&(i=s)}}return i||r}return r}function rM(t,e,n,r){let i=Nf(t,e.head,e.assoc||-1),s=!r||i.type!=it.Text||!(t.lineWrapping||i.widgetLineBreaks)?null:t.coordsAtPos(e.assoc<0&&e.head>i.from?e.head-1:e.head);if(s){let o=t.dom.getBoundingClientRect(),l=t.textDirectionAt(i.from),a=t.posAtCoords({x:n==(l==pe.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(a!=null)return A.cursor(a,n?-1:1)}return A.cursor(n?i.to:i.from,n?-1:1)}function pg(t,e,n,r){let i=t.state.doc.lineAt(e.head),s=t.bidiSpans(i),o=t.textDirectionAt(i.from);for(let l=e,a=null;;){let u=V2(i,s,o,l,n),c=sw;if(!u){if(i.number==(n?t.state.doc.lines:1))return l;c=`
`,i=t.state.doc.line(i.number+(n?1:-1)),s=t.bidiSpans(i),u=t.visualLineSide(i,!n)}if(a){if(!a(c))return l}else{if(!r)return u;a=r(c)}l=u}}function iM(t,e,n){let r=t.state.charCategorizer(e),i=r(n);return s=>{let o=r(s);return i==ye.Space&&(i=o),i==o}}function sM(t,e,n,r){let i=e.head,s=n?1:-1;if(i==(n?t.state.doc.length:0))return A.cursor(i,e.assoc);let o=e.goalColumn,l,a=t.contentDOM.getBoundingClientRect(),u=t.coordsAtPos(i,e.assoc||-1),c=t.documentTop;if(u)o==null&&(o=u.left-a.left),l=s<0?u.top:u.bottom;else{let d=t.viewState.lineBlockAt(i);o==null&&(o=Math.min(a.right-a.left,t.defaultCharacterWidth*(i-d.from))),l=(s<0?d.top:d.bottom)+c}let h=a.left+o,f=r??t.viewState.heightOracle.textHeight>>1;for(let d=0;;d+=10){let p=l+(f+d)*s,y=Sw(t,{x:h,y:p},!1,s);if(p<a.top||p>a.bottom||(s<0?y<i:y>i)){let w=t.docView.coordsForChar(y),m=!w||p<w.top?-1:1;return A.cursor(y,m,void 0,o)}}}function Ys(t,e,n){for(;;){let r=0;for(let i of t)i.between(e-1,e+1,(s,o,l)=>{if(e>s&&e<o){let a=r||n||(e-s<o-e?-1:1);e=a<0?s:o,r=a}});if(!r)return e}}function bw(t,e){let n=null;for(let r=0;r<e.ranges.length;r++){let i=e.ranges[r],s=null;if(i.empty){let o=Ys(t,i.from,0);o!=i.from&&(s=A.cursor(o,-1))}else{let o=Ys(t,i.from,-1),l=Ys(t,i.to,1);(o!=i.from||l!=i.to)&&(s=A.range(i.from==i.anchor?o:l,i.from==i.head?o:l))}s&&(n||(n=e.ranges.slice()),n[r]=s)}return n?A.create(n,e.mainIndex):e}function Dc(t,e,n){let r=Ys(t.state.facet(Vo).map(i=>i(t)),n.from,e.head>n.from?-1:1);return r==n.from?n:A.cursor(r,r<n.from?1:-1)}const Ns="";class oM{constructor(e,n){this.points=e,this.text="",this.lineSeparator=n.facet(ee.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Ns}readRange(e,n){if(!e)return this;let r=e.parentNode;for(let i=e;;){this.findPointBefore(r,i);let s=this.text.length;this.readNode(i);let o=i.nextSibling;if(o==n)break;let l=le.get(i),a=le.get(o);(l&&a?l.breakAfter:(l?l.breakAfter:Va(i))||Va(o)&&(i.nodeName!="BR"||i.cmIgnore)&&this.text.length>s)&&!aM(o,n)&&this.lineBreak(),i=o}return this.findPointBefore(r,n),this}readTextNode(e){let n=e.nodeValue;for(let r of this.points)r.node==e&&(r.pos=this.text.length+Math.min(r.offset,n.length));for(let r=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,l;if(this.lineSeparator?(s=n.indexOf(this.lineSeparator,r),o=this.lineSeparator.length):(l=i.exec(n))&&(s=l.index,o=l[0].length),this.append(n.slice(r,s<0?n.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let a of this.points)a.node==e&&a.pos>this.text.length&&(a.pos-=o-1);r=s+o}}readNode(e){if(e.cmIgnore)return;let n=le.get(e),r=n&&n.overrideDOMText;if(r!=null){this.findPointInside(e,r.length);for(let i=r.iter();!i.next().done;)i.lineBreak?this.lineBreak():this.append(i.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,n){for(let r of this.points)r.node==e&&e.childNodes[r.offset]==n&&(r.pos=this.text.length)}findPointInside(e,n){for(let r of this.points)(e.nodeType==3?r.node==e:e.contains(r.node))&&(r.pos=this.text.length+(lM(e,r.node,r.offset)?n:0))}}function lM(t,e,n){for(;;){if(!e||n<Cn(e))return!1;if(e==t)return!0;n=Xr(e)+1,e=e.parentNode}}function aM(t,e){let n;for(;!(t==e||!t);t=t.nextSibling){let r=le.get(t);if(!(r!=null&&r.isWidget||t.cmIgnore))return!1;r&&(n||(n=[])).push(r)}if(n)for(let r of n){let i=r.overrideDOMText;if(i!=null&&i.length)return!1}return!0}class mg{constructor(e,n){this.node=e,this.offset=n,this.pos=-1}}class uM{constructor(e,n,r,i){this.typeOver=i,this.bounds=null,this.text="",this.domChanged=n>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&n>-1)this.newSel=null;else if(n>-1&&(this.bounds=e.docView.domBoundsAround(n,r,0))){let l=s||o?[]:hM(e),a=new oM(l,e.state);a.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=a.text,this.newSel=fM(l,this.bounds.from)}else{let l=e.observer.selectionRange,a=s&&s.node==l.focusNode&&s.offset==l.focusOffset||!Cf(e.contentDOM,l.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(l.focusNode,l.focusOffset),u=o&&o.node==l.anchorNode&&o.offset==l.anchorOffset||!Cf(e.contentDOM,l.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(l.anchorNode,l.anchorOffset),c=e.viewport;if((_.ios||_.chrome)&&e.state.selection.main.empty&&a!=u&&(c.from>0||c.to<e.state.doc.length)){let h=Math.min(a,u),f=Math.max(a,u),d=c.from-h,p=c.to-f;(d==0||d==1||h==0)&&(p==0||p==-1||f==e.state.doc.length)&&(a=0,u=e.state.doc.length)}this.newSel=A.single(u,a)}}}function Cw(t,e){let n,{newSel:r}=e,i=t.state.selection.main,s=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:l}=e.bounds,a=i.from,u=null;(s===8||_.android&&e.text.length<l-o)&&(a=i.to,u="end");let c=Mw(t.state.doc.sliceString(o,l,Ns),e.text,a-o,u);c&&(_.chrome&&s==13&&c.toB==c.from+2&&e.text.slice(c.from,c.toB)==Ns+Ns&&c.toB--,n={from:o+c.from,to:o+c.toA,insert:re.of(e.text.slice(c.from,c.toB).split(Ns))})}else r&&(!t.hasFocus&&t.state.facet(On)||r.main.eq(i))&&(r=null);if(!n&&!r)return!1;if(!n&&e.typeOver&&!i.empty&&r&&r.main.empty?n={from:i.from,to:i.to,insert:t.state.doc.slice(i.from,i.to)}:(_.mac||_.android)&&n&&n.from==n.to&&n.from==i.head-1&&/^\. ?$/.test(n.insert.toString())&&t.contentDOM.getAttribute("autocorrect")=="off"?(r&&n.insert.length==2&&(r=A.single(r.main.anchor-1,r.main.head-1)),n={from:n.from,to:n.to,insert:re.of([n.insert.toString().replace("."," ")])}):n&&n.from>=i.from&&n.to<=i.to&&(n.from!=i.from||n.to!=i.to)&&i.to-i.from-(n.to-n.from)<=4?n={from:i.from,to:i.to,insert:t.state.doc.slice(i.from,n.from).append(n.insert).append(t.state.doc.slice(n.to,i.to))}:_.chrome&&n&&n.from==n.to&&n.from==i.head&&n.insert.toString()==`
 `&&t.lineWrapping&&(r&&(r=A.single(r.main.anchor-1,r.main.head-1)),n={from:i.from,to:i.to,insert:re.of([" "])}),n)return cp(t,n,r,s);if(r&&!r.main.eq(i)){let o=!1,l="select";return t.inputState.lastSelectionTime>Date.now()-50&&(t.inputState.lastSelectionOrigin=="select"&&(o=!0),l=t.inputState.lastSelectionOrigin,l=="select.pointer"&&(r=bw(t.state.facet(Vo).map(a=>a(t)),r))),t.dispatch({selection:r,scrollIntoView:o,userEvent:l}),!0}else return!1}function cp(t,e,n,r=-1){if(_.ios&&t.inputState.flushIOSKey(e))return!0;let i=t.state.selection.main;if(_.android&&(e.to==i.to&&(e.from==i.from||e.from==i.from-1&&t.state.sliceDoc(e.from,i.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Ri(t.contentDOM,"Enter",13)||(e.from==i.from-1&&e.to==i.to&&e.insert.length==0||r==8&&e.insert.length<e.to-e.from&&e.to>i.head)&&Ri(t.contentDOM,"Backspace",8)||e.from==i.from&&e.to==i.to+1&&e.insert.length==0&&Ri(t.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let o,l=()=>o||(o=cM(t,e,n));return t.state.facet(cw).some(a=>a(t,e.from,e.to,s,l))||t.dispatch(l()),!0}function cM(t,e,n){let r,i=t.state,s=i.selection.main,o=-1;if(e.from==e.to&&e.from<s.from||e.from>s.to){let a=e.from<s.from?-1:1,u=a<0?s.from:s.to,c=Ys(i.facet(Vo).map(h=>h(t)),u,a);e.from==c&&(o=c)}if(o>-1)r={changes:e,selection:A.cursor(e.from+e.insert.length,-1)};else if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!n||n.main.empty&&n.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let a=s.from<e.from?i.sliceDoc(s.from,e.from):"",u=s.to>e.to?i.sliceDoc(e.to,s.to):"";r=i.replaceSelection(t.state.toText(a+e.insert.sliceString(0,void 0,t.state.lineBreak)+u))}else{let a=i.changes(e),u=n&&n.main.to<=a.newLength?n.main:void 0;if(i.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let c=t.state.sliceDoc(e.from,e.to),h,f=n&&xw(t,n.main.head);if(f){let y=e.insert.length-(e.to-e.from);h={from:f.from,to:f.to-y}}else h=t.state.doc.lineAt(s.head);let d=s.to-e.to,p=s.to-s.from;r=i.changeByRange(y=>{if(y.from==s.from&&y.to==s.to)return{changes:a,range:u||y.map(a)};let w=y.to-d,m=w-c.length;if(y.to-y.from!=p||t.state.sliceDoc(m,w)!=c||y.to>=h.from&&y.from<=h.to)return{range:y};let g=i.changes({from:m,to:w,insert:e.insert}),v=y.to-s.to;return{changes:g,range:u?A.range(Math.max(0,u.anchor+v),Math.max(0,u.head+v)):y.map(g)}})}else r={changes:a,selection:u&&i.selection.replaceRange(u)}}let l="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,l+=".compose",t.inputState.compositionFirstChange&&(l+=".start",t.inputState.compositionFirstChange=!1)),i.update(r,{userEvent:l,scrollIntoView:!0})}function Mw(t,e,n,r){let i=Math.min(t.length,e.length),s=0;for(;s<i&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==i&&t.length==e.length)return null;let o=t.length,l=e.length;for(;o>0&&l>0&&t.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if(r=="end"){let a=Math.max(0,s-Math.min(o,l));n-=o+a-s}if(o<s&&t.length<e.length){let a=n<=s&&n>=o?s-n:0;s-=a,l=s+(l-o),o=s}else if(l<s){let a=n<=s&&n>=l?s-n:0;s-=a,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}function hM(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:s}=t.observer.selectionRange;return n&&(e.push(new mg(n,r)),(i!=n||s!=r)&&e.push(new mg(i,s))),e}function fM(t,e){if(t.length==0)return null;let n=t[0].pos,r=t.length==2?t[1].pos:n;return n>-1&&r>-1?A.single(n+e,r+e):null}class dM{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,_.safari&&e.contentDOM.addEventListener("input",()=>null),_.gecko&&DM(e.contentDOM.ownerDocument)}handleEvent(e){!SM(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,n){let r=this.handlers[e];if(r){for(let i of r.observers)i(this.view,n);for(let i of r.handlers){if(n.defaultPrevented)break;if(i(this.view,n)){n.preventDefault();break}}}}ensureHandlers(e){let n=pM(e),r=this.handlers,i=this.view.contentDOM;for(let s in n)if(s!="scroll"){let o=!n[s].handlers.length,l=r[s];l&&o!=!l.handlers.length&&(i.removeEventListener(s,this.handleEvent),l=null),l||i.addEventListener(s,this.handleEvent,{passive:o})}for(let s in r)s!="scroll"&&!n[s]&&i.removeEventListener(s,this.handleEvent);this.handlers=n}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&Ew.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),_.android&&_.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let n;return _.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((n=Aw.find(r=>r.keyCode==e.keyCode))&&!e.ctrlKey||mM.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=n||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let n=this.pendingIOSKey;return!n||n.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Ri(this.view.contentDOM,n.key,n.keyCode,n instanceof KeyboardEvent?n:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:_.safari&&!_.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function gg(t,e){return(n,r)=>{try{return e.call(t,r,n)}catch(i){pt(n.state,i)}}}function pM(t){let e=Object.create(null);function n(r){return e[r]||(e[r]={observers:[],handlers:[]})}for(let r of t){let i=r.spec,s=i&&i.plugin.domEventHandlers,o=i&&i.plugin.domEventObservers;if(s)for(let l in s){let a=s[l];a&&n(l).handlers.push(gg(r.value,a))}if(o)for(let l in o){let a=o[l];a&&n(l).observers.push(gg(r.value,a))}}for(let r in nn)n(r).handlers.push(nn[r]);for(let r in Vt)n(r).observers.push(Vt[r]);return e}const Aw=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],mM="dthko",Ew=[16,17,18,20,91,92,224,225],wl=6;function xl(t){return Math.max(0,t)*.7+8}function gM(t,e){return Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))}class yM{constructor(e,n,r,i){this.view=e,this.startEvent=n,this.style=r,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=n,this.scrollParents=M2(e.contentDOM),this.atoms=e.state.facet(Vo).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=n.shiftKey,this.multiple=e.state.facet(ee.allowMultipleSelections)&&vM(e,n),this.dragging=xM(e,n)&&Tw(n)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&gM(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let n=0,r=0,i=0,s=0,o=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:i,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:l}=this.scrollParents.y.getBoundingClientRect());let a=up(this.view);e.clientX-a.left<=i+wl?n=-xl(i-e.clientX):e.clientX+a.right>=o-wl&&(n=xl(e.clientX-o)),e.clientY-a.top<=s+wl?r=-xl(s-e.clientY):e.clientY+a.bottom>=l-wl&&(r=xl(e.clientY-l)),this.setScrollSpeed(n,r)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,n){this.scrollSpeed={x:e,y:n},e||n?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:n}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),n&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=n,n=0),(e||n)&&this.view.win.scrollBy(e,n),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:n}=this,r=bw(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!r.eq(n.state.selection,this.dragging===!1))&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(n=>n.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function vM(t,e){let n=t.state.facet(ow);return n.length?n[0](e):_.mac?e.metaKey:e.ctrlKey}function wM(t,e){let n=t.state.facet(lw);return n.length?n[0](e):_.mac?!e.altKey:!e.ctrlKey}function xM(t,e){let{main:n}=t.state.selection;if(n.empty)return!1;let r=So(t.root);if(!r||r.rangeCount==0)return!0;let i=r.getRangeAt(0).getClientRects();for(let s=0;s<i.length;s++){let o=i[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function SM(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target,r;n!=t.contentDOM;n=n.parentNode)if(!n||n.nodeType==11||(r=le.get(n))&&r.ignoreEvent(e))return!1;return!0}const nn=Object.create(null),Vt=Object.create(null),Pw=_.ie&&_.ie_version<15||_.ios&&_.webkit_version<604;function kM(t){let e=t.dom.parentNode;if(!e)return;let n=e.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout(()=>{t.focus(),n.remove(),Dw(t,n.value)},50)}function Lu(t,e,n){for(let r of t.facet(e))n=r(n,t);return n}function Dw(t,e){e=Lu(t.state,op,e);let{state:n}=t,r,i=1,s=n.toText(e),o=s.lines==n.selection.ranges.length;if(Lf!=null&&n.selection.ranges.every(a=>a.empty)&&Lf==s.toString()){let a=-1;r=n.changeByRange(u=>{let c=n.doc.lineAt(u.from);if(c.from==a)return{range:u};a=c.from;let h=n.toText((o?s.line(i++).text:e)+n.lineBreak);return{changes:{from:c.from,insert:h},range:A.cursor(u.from+h.length)}})}else o?r=n.changeByRange(a=>{let u=s.line(i++);return{changes:{from:a.from,to:a.to,insert:u.text},range:A.cursor(a.from+u.length)}}):r=n.replaceSelection(s);t.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}Vt.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft};nn.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),e.keyCode==27&&t.inputState.tabFocusMode!=0&&(t.inputState.tabFocusMode=Date.now()+2e3),!1);Vt.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")};Vt.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")};nn.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let n=null;for(let r of t.state.facet(aw))if(n=r(t,e),n)break;if(!n&&e.button==0&&(n=MM(t,e)),n){let r=!t.hasFocus;t.inputState.startMouseSelection(new yM(t,e,n,r)),r&&t.observer.ignore(()=>{H1(t.contentDOM);let s=t.root.activeElement;s&&!s.contains(t.contentDOM)&&s.blur()});let i=t.inputState.mouseSelection;if(i)return i.start(e),i.dragging===!1}else t.inputState.setSelectionOrigin("select.pointer");return!1};function yg(t,e,n,r){if(r==1)return A.cursor(e,n);if(r==2)return J2(t.state,e,n);{let i=Me.find(t.docView,e),s=t.state.doc.lineAt(i?i.posAtEnd:e),o=i?i.posAtStart:s.from,l=i?i.posAtEnd:s.to;return l<t.state.doc.length&&l==s.to&&l++,A.range(o,l)}}let vg=(t,e,n)=>e>=n.top&&e<=n.bottom&&t>=n.left&&t<=n.right;function bM(t,e,n,r){let i=Me.find(t.docView,e);if(!i)return 1;let s=e-i.posAtStart;if(s==0)return 1;if(s==i.length)return-1;let o=i.coordsAt(s,-1);if(o&&vg(n,r,o))return-1;let l=i.coordsAt(s,1);return l&&vg(n,r,l)?1:o&&o.bottom>=r?-1:1}function wg(t,e){let n=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:n,bias:bM(t,n,e.clientX,e.clientY)}}const CM=_.ie&&_.ie_version<=11;let xg=null,Sg=0,kg=0;function Tw(t){if(!CM)return t.detail;let e=xg,n=kg;return xg=t,kg=Date.now(),Sg=!e||n>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(Sg+1)%3:1}function MM(t,e){let n=wg(t,e),r=Tw(e),i=t.state.selection;return{update(s){s.docChanged&&(n.pos=s.changes.mapPos(n.pos),i=i.map(s.changes))},get(s,o,l){let a=wg(t,s),u,c=yg(t,a.pos,a.bias,r);if(n.pos!=a.pos&&!o){let h=yg(t,n.pos,n.bias,r),f=Math.min(h.from,c.from),d=Math.max(h.to,c.to);c=f<c.from?A.range(f,d):A.range(d,f)}return o?i.replaceRange(i.main.extend(c.from,c.to)):l&&r==1&&i.ranges.length>1&&(u=AM(i,a.pos))?u:l?i.addRange(c):A.create([c])}}}function AM(t,e){for(let n=0;n<t.ranges.length;n++){let{from:r,to:i}=t.ranges[n];if(r<=e&&i>=e)return A.create(t.ranges.slice(0,n).concat(t.ranges.slice(n+1)),t.mainIndex==n?0:t.mainIndex-(t.mainIndex>n?1:0))}return null}nn.dragstart=(t,e)=>{let{selection:{main:n}}=t.state;if(e.target.draggable){let i=t.docView.nearest(e.target);if(i&&i.isWidget){let s=i.posAtStart,o=s+i.length;(s>=n.to||o<=n.from)&&(n=A.range(s,o))}}let{inputState:r}=t;return r.mouseSelection&&(r.mouseSelection.dragging=!0),r.draggedContent=n,e.dataTransfer&&(e.dataTransfer.setData("Text",Lu(t.state,lp,t.state.sliceDoc(n.from,n.to))),e.dataTransfer.effectAllowed="copyMove"),!1};nn.dragend=t=>(t.inputState.draggedContent=null,!1);function bg(t,e,n,r){if(n=Lu(t.state,op,n),!n)return;let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=t.inputState,o=r&&s&&wM(t,e)?{from:s.from,to:s.to}:null,l={from:i,insert:n},a=t.state.changes(o?[o,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(i,-1),head:a.mapPos(i,1)},userEvent:o?"move.drop":"input.drop"}),t.inputState.draggedContent=null}nn.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let n=e.dataTransfer.files;if(n&&n.length){let r=Array(n.length),i=0,s=()=>{++i==n.length&&bg(t,e,r.filter(o=>o!=null).join(t.state.lineBreak),!1)};for(let o=0;o<n.length;o++){let l=new FileReader;l.onerror=s,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(r[o]=l.result),s()},l.readAsText(n[o])}return!0}else{let r=e.dataTransfer.getData("Text");if(r)return bg(t,e,r,!0),!0}return!1};nn.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let n=Pw?null:e.clipboardData;return n?(Dw(t,n.getData("text/plain")||n.getData("text/uri-list")),!0):(kM(t),!1)};function EM(t,e){let n=t.dom.parentNode;if(!n)return;let r=n.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=e,r.focus(),r.selectionEnd=e.length,r.selectionStart=0,setTimeout(()=>{r.remove(),t.focus()},50)}function PM(t){let e=[],n=[],r=!1;for(let i of t.selection.ranges)i.empty||(e.push(t.sliceDoc(i.from,i.to)),n.push(i));if(!e.length){let i=-1;for(let{from:s}of t.selection.ranges){let o=t.doc.lineAt(s);o.number>i&&(e.push(o.text),n.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),i=o.number}r=!0}return{text:Lu(t,lp,e.join(t.lineBreak)),ranges:n,linewise:r}}let Lf=null;nn.copy=nn.cut=(t,e)=>{let{text:n,ranges:r,linewise:i}=PM(t.state);if(!n&&!i)return!1;Lf=i?n:null,e.type=="cut"&&!t.state.readOnly&&t.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"});let s=Pw?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",n),!0):(EM(t,n),!1)};const Ow=Mn.define();function Rw(t,e){let n=[];for(let r of t.facet(hw)){let i=r(t,e);i&&n.push(i)}return n.length?t.update({effects:n,annotations:Ow.of(!0)}):null}function Nw(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let n=Rw(t.state,e);n?t.dispatch(n):t.update([])}},10)}Vt.focus=t=>{t.inputState.lastFocusTime=Date.now(),!t.scrollDOM.scrollTop&&(t.inputState.lastScrollTop||t.inputState.lastScrollLeft)&&(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),Nw(t)};Vt.blur=t=>{t.observer.clearSelectionRange(),Nw(t)};Vt.compositionstart=Vt.compositionupdate=t=>{t.observer.editContext||(t.inputState.compositionFirstChange==null&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))};Vt.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,_.chrome&&_.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50))};Vt.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()};nn.beforeinput=(t,e)=>{var n,r;if(e.inputType=="insertReplacementText"&&t.observer.editContext){let s=(n=e.dataTransfer)===null||n===void 0?void 0:n.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let l=o[0],a=t.posAtDOM(l.startContainer,l.startOffset),u=t.posAtDOM(l.endContainer,l.endOffset);return cp(t,{from:a,to:u,insert:t.state.toText(s)},null),!0}}let i;if(_.chrome&&_.android&&(i=Aw.find(s=>s.inputType==e.inputType))&&(t.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let s=((r=window.visualViewport)===null||r===void 0?void 0:r.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}return _.ios&&e.inputType=="deleteContentForward"&&t.observer.flushSoon(),_.safari&&e.inputType=="insertText"&&t.inputState.composing>=0&&setTimeout(()=>Vt.compositionend(t,e),20),!1};const Cg=new Set;function DM(t){Cg.has(t)||(Cg.add(t),t.addEventListener("copy",()=>{}),t.addEventListener("cut",()=>{}))}const Mg=["pre-wrap","normal","pre-line","break-spaces"];let Yi=!1;function Ag(){Yi=!1}class TM{constructor(e){this.lineWrapping=e,this.doc=re.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,n){let r=this.doc.lineAt(n).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((n-e-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Mg.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let n=!1;for(let r=0;r<e.length;r++){let i=e[r];i<0?r++:this.heightSamples[Math.floor(i*10)]||(n=!0,this.heightSamples[Math.floor(i*10)]=!0)}return n}refresh(e,n,r,i,s,o){let l=Mg.indexOf(e)>-1,a=Math.round(n)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=n,this.charWidth=r,this.textHeight=i,this.lineLength=s,a){this.heightSamples={};for(let u=0;u<o.length;u++){let c=o[u];c<0?u++:this.heightSamples[Math.floor(c*10)]=!0}}return a}}class OM{constructor(e,n){this.from=e,this.heights=n,this.index=0}get more(){return this.index<this.heights.length}}class gn{constructor(e,n,r,i,s){this.from=e,this.length=n,this.top=r,this.height=i,this._content=s}get type(){return typeof this._content=="number"?it.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof xr?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let n=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new gn(this.from,this.length+e.length,this.top,this.height+e.height,n)}}var fe=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(fe||(fe={}));const ca=.001;class st{constructor(e,n,r=2){this.length=e,this.height=n,this.flags=r}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>ca&&(Yi=!0),this.height=e)}replace(e,n,r){return st.of(r)}decomposeLeft(e,n){n.push(this)}decomposeRight(e,n){n.push(this)}applyChanges(e,n,r,i){let s=this,o=r.doc;for(let l=i.length-1;l>=0;l--){let{fromA:a,toA:u,fromB:c,toB:h}=i[l],f=s.lineAt(a,fe.ByPosNoHeight,r.setDoc(n),0,0),d=f.to>=u?f:s.lineAt(u,fe.ByPosNoHeight,r,0,0);for(h+=d.to-u,u=d.to;l>0&&f.from<=i[l-1].toA;)a=i[l-1].fromA,c=i[l-1].fromB,l--,a<f.from&&(f=s.lineAt(a,fe.ByPosNoHeight,r,0,0));c+=f.from-a,a=f.from;let p=hp.build(r.setDoc(o),e,c,h);s=$a(s,s.replace(a,u,p))}return s.updateHeight(r,0)}static empty(){return new St(0,0)}static of(e){if(e.length==1)return e[0];let n=0,r=e.length,i=0,s=0;for(;;)if(n==r)if(i>s*2){let l=e[n-1];l.break?e.splice(--n,1,l.left,null,l.right):e.splice(--n,1,l.left,l.right),r+=1+l.break,i-=l.size}else if(s>i*2){let l=e[r];l.break?e.splice(r,1,l.left,null,l.right):e.splice(r,1,l.left,l.right),r+=2+l.break,s-=l.size}else break;else if(i<s){let l=e[n++];l&&(i+=l.size)}else{let l=e[--r];l&&(s+=l.size)}let o=0;return e[n-1]==null?(o=1,n--):e[n]==null&&(o=1,r++),new RM(st.of(e.slice(0,n)),o,st.of(e.slice(r)))}}function $a(t,e){return t==e?t:(t.constructor!=e.constructor&&(Yi=!0),e)}st.prototype.size=1;class Lw extends st{constructor(e,n,r){super(e,n),this.deco=r}blockAt(e,n,r,i){return new gn(i,this.length,r,this.height,this.deco||0)}lineAt(e,n,r,i,s){return this.blockAt(0,r,i,s)}forEachLine(e,n,r,i,s,o){e<=s+this.length&&n>=s&&o(this.blockAt(0,r,i,s))}updateHeight(e,n=0,r=!1,i){return i&&i.from<=n&&i.more&&this.setHeight(i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class St extends Lw{constructor(e,n){super(e,n,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,n,r,i){return new gn(i,this.length,r,this.height,this.breaks)}replace(e,n,r){let i=r[0];return r.length==1&&(i instanceof St||i instanceof Be&&i.flags&4)&&Math.abs(this.length-i.length)<10?(i instanceof Be?i=new St(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):st.of(r)}updateHeight(e,n=0,r=!1,i){return i&&i.from<=n&&i.more?this.setHeight(i.heights[i.index++]):(r||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Be extends st{constructor(e){super(e,0)}heightMetrics(e,n){let r=e.doc.lineAt(n).number,i=e.doc.lineAt(n+this.length).number,s=i-r+1,o,l=0;if(e.lineWrapping){let a=Math.min(this.height,e.lineHeight*s);o=a/s,this.length>s+1&&(l=(this.height-a)/(this.length-s-1))}else o=this.height/s;return{firstLine:r,lastLine:i,perLine:o,perChar:l}}blockAt(e,n,r,i){let{firstLine:s,lastLine:o,perLine:l,perChar:a}=this.heightMetrics(n,i);if(n.lineWrapping){let u=i+(e<n.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-r)/this.height))*this.length)),c=n.doc.lineAt(u),h=l+c.length*a,f=Math.max(r,e-h/2);return new gn(c.from,c.length,f,h,0)}else{let u=Math.max(0,Math.min(o-s,Math.floor((e-r)/l))),{from:c,length:h}=n.doc.line(s+u);return new gn(c,h,r+l*u,l,0)}}lineAt(e,n,r,i,s){if(n==fe.ByHeight)return this.blockAt(e,r,i,s);if(n==fe.ByPosNoHeight){let{from:d,to:p}=r.doc.lineAt(e);return new gn(d,p-d,0,0,0)}let{firstLine:o,perLine:l,perChar:a}=this.heightMetrics(r,s),u=r.doc.lineAt(e),c=l+u.length*a,h=u.number-o,f=i+l*h+a*(u.from-s-h);return new gn(u.from,u.length,Math.max(i,Math.min(f,i+this.height-c)),c,0)}forEachLine(e,n,r,i,s,o){e=Math.max(e,s),n=Math.min(n,s+this.length);let{firstLine:l,perLine:a,perChar:u}=this.heightMetrics(r,s);for(let c=e,h=i;c<=n;){let f=r.doc.lineAt(c);if(c==e){let p=f.number-l;h+=a*p+u*(e-s-p)}let d=a+u*f.length;o(new gn(f.from,f.length,h,d,0)),h+=d,c=f.to+1}}replace(e,n,r){let i=this.length-n;if(i>0){let s=r[r.length-1];s instanceof Be?r[r.length-1]=new Be(s.length+i):r.push(null,new Be(i-1))}if(e>0){let s=r[0];s instanceof Be?r[0]=new Be(e+s.length):r.unshift(new Be(e-1),null)}return st.of(r)}decomposeLeft(e,n){n.push(new Be(e-1),null)}decomposeRight(e,n){n.push(null,new Be(this.length-e-1))}updateHeight(e,n=0,r=!1,i){let s=n+this.length;if(i&&i.from<=n+this.length&&i.more){let o=[],l=Math.max(n,i.from),a=-1;for(i.from>n&&o.push(new Be(i.from-n-1).updateHeight(e,n));l<=s&&i.more;){let c=e.doc.lineAt(l).length;o.length&&o.push(null);let h=i.heights[i.index++];a==-1?a=h:Math.abs(h-a)>=ca&&(a=-2);let f=new St(c,h);f.outdated=!1,o.push(f),l+=c+1}l<=s&&o.push(null,new Be(s-l).updateHeight(e,l));let u=st.of(o);return(a<0||Math.abs(u.height-this.height)>=ca||Math.abs(a-this.heightMetrics(e,n).perLine)>=ca)&&(Yi=!0),$a(this,u)}else(r||this.outdated)&&(this.setHeight(e.heightForGap(n,n+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class RM extends st{constructor(e,n,r){super(e.length+n+r.length,e.height+r.height,n|(e.outdated||r.outdated?2:0)),this.left=e,this.right=r,this.size=e.size+r.size}get break(){return this.flags&1}blockAt(e,n,r,i){let s=r+this.left.height;return e<s?this.left.blockAt(e,n,r,i):this.right.blockAt(e,n,s,i+this.left.length+this.break)}lineAt(e,n,r,i,s){let o=i+this.left.height,l=s+this.left.length+this.break,a=n==fe.ByHeight?e<o:e<l,u=a?this.left.lineAt(e,n,r,i,s):this.right.lineAt(e,n,r,o,l);if(this.break||(a?u.to<l:u.from>l))return u;let c=n==fe.ByPosNoHeight?fe.ByPosNoHeight:fe.ByPos;return a?u.join(this.right.lineAt(l,c,r,o,l)):this.left.lineAt(l,c,r,i,s).join(u)}forEachLine(e,n,r,i,s,o){let l=i+this.left.height,a=s+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,n,r,i,s,o),n>=a&&this.right.forEachLine(e,n,r,l,a,o);else{let u=this.lineAt(a,fe.ByPos,r,i,s);e<u.from&&this.left.forEachLine(e,u.from-1,r,i,s,o),u.to>=e&&u.from<=n&&o(u),n>u.to&&this.right.forEachLine(u.to+1,n,r,l,a,o)}}replace(e,n,r){let i=this.left.length+this.break;if(n<i)return this.balanced(this.left.replace(e,n,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,n-i,r));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let l of r)s.push(l);if(e>0&&Eg(s,o-1),n<this.length){let l=s.length;this.decomposeRight(n,s),Eg(s,l)}return st.of(s)}decomposeLeft(e,n){let r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,n);n.push(this.left),this.break&&(r++,e>=r&&n.push(null)),e>r&&this.right.decomposeLeft(e-r,n)}decomposeRight(e,n){let r=this.left.length,i=r+this.break;if(e>=i)return this.right.decomposeRight(e-i,n);e<r&&this.left.decomposeRight(e,n),this.break&&e<i&&n.push(null),n.push(this.right)}balanced(e,n){return e.size>2*n.size||n.size>2*e.size?st.of(this.break?[e,null,n]:[e,n]):(this.left=$a(this.left,e),this.right=$a(this.right,n),this.setHeight(e.height+n.height),this.outdated=e.outdated||n.outdated,this.size=e.size+n.size,this.length=e.length+this.break+n.length,this)}updateHeight(e,n=0,r=!1,i){let{left:s,right:o}=this,l=n+s.length+this.break,a=null;return i&&i.from<=n+s.length&&i.more?a=s=s.updateHeight(e,n,r,i):s.updateHeight(e,n,r),i&&i.from<=l+o.length&&i.more?a=o=o.updateHeight(e,l,r,i):o.updateHeight(e,l,r),a?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Eg(t,e){let n,r;t[e]==null&&(n=t[e-1])instanceof Be&&(r=t[e+1])instanceof Be&&t.splice(e-1,3,new Be(n.length+1+r.length))}const NM=5;class hp{constructor(e,n){this.pos=e,this.oracle=n,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,n){if(this.lineStart>-1){let r=Math.min(n,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof St?i.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new St(r-this.pos,-1)),this.writtenTo=r,n>r&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=n}point(e,n,r){if(e<n||r.heightRelevant){let i=r.widget?r.widget.estimatedHeight:0,s=r.widget?r.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let o=n-e;r.block?this.addBlock(new Lw(o,i,r)):(o||s||i>=NM)&&this.addLineDeco(i,s,o)}else n>e&&this.span(e,n);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:n}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=n,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new St(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,n){let r=new Be(n-e);return this.oracle.doc.lineAt(e).to==n&&(r.flags|=4),r}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof St)return e;let n=new St(0,-1);return this.nodes.push(n),n}addBlock(e){this.enterLine();let n=e.deco;n&&n.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,n&&n.endSide>0&&(this.covering=e)}addLineDeco(e,n,r){let i=this.ensureLine();i.length+=r,i.collapsed+=r,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=n,this.writtenTo=this.pos=this.pos+r}finish(e){let n=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(n instanceof St)&&!this.isCovered?this.nodes.push(new St(0,-1)):(this.writtenTo<this.pos||n==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let r=e;for(let i of this.nodes)i instanceof St&&i.updateHeight(this.oracle,r),r+=i?i.length:1;return this.nodes}static build(e,n,r,i){let s=new hp(r,e);return ne.spans(n,r,i,s,0),s.finish(r)}}function LM(t,e,n){let r=new BM;return ne.compare(t,e,n,r,0),r.changes}class BM{constructor(){this.changes=[]}compareRange(){}comparePoint(e,n,r,i){(e<n||r&&r.heightRelevant||i&&i.heightRelevant)&&ua(e,n,this.changes,5)}}function _M(t,e){let n=t.getBoundingClientRect(),r=t.ownerDocument,i=r.defaultView||window,s=Math.max(0,n.left),o=Math.min(i.innerWidth,n.right),l=Math.max(0,n.top),a=Math.min(i.innerHeight,n.bottom);for(let u=t.parentNode;u&&u!=r.body;)if(u.nodeType==1){let c=u,h=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&h.overflow!="visible"){let f=c.getBoundingClientRect();s=Math.max(s,f.left),o=Math.min(o,f.right),l=Math.max(l,f.top),a=Math.min(u==t.parentNode?i.innerHeight:a,f.bottom)}u=h.position=="absolute"||h.position=="fixed"?c.offsetParent:c.parentNode}else if(u.nodeType==11)u=u.host;else break;return{left:s-n.left,right:Math.max(s,o)-n.left,top:l-(n.top+e),bottom:Math.max(l,a)-(n.top+e)}}function IM(t){let e=t.getBoundingClientRect(),n=t.ownerDocument.defaultView||window;return e.left<n.innerWidth&&e.right>0&&e.top<n.innerHeight&&e.bottom>0}function jM(t,e){let n=t.getBoundingClientRect();return{left:0,right:n.right-n.left,top:e,bottom:n.bottom-(n.top+e)}}class Tc{constructor(e,n,r,i){this.from=e,this.to=n,this.size=r,this.displaySize=i}static same(e,n){if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++){let i=e[r],s=n[r];if(i.from!=s.from||i.to!=s.to||i.size!=s.size)return!1}return!0}draw(e,n){return $.replace({widget:new FM(this.displaySize*(n?e.scaleY:e.scaleX),n)}).range(this.from,this.to)}}class FM extends Un{constructor(e,n){super(),this.size=e,this.vertical=n}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Pg{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Dg,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=pe.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let n=e.facet(ap).some(r=>typeof r!="function"&&r.class=="cm-lineWrapping");this.heightOracle=new TM(n),this.stateDeco=e.facet(ko).filter(r=>typeof r!="function"),this.heightMap=st.empty().applyChanges(this.stateDeco,re.empty,this.heightOracle.setDoc(e.doc),[new jt(0,0,0,e.doc.length)]);for(let r=0;r<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());r++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=$.set(this.lineGaps.map(r=>r.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:n}=this.state.selection;for(let r=0;r<=1;r++){let i=r?n.head:n.anchor;if(!e.some(({from:s,to:o})=>i>=s&&i<=o)){let{from:s,to:o}=this.lineBlockAt(i);e.push(new Sl(s,o))}}return this.viewports=e.sort((r,i)=>r.from-i.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?Dg:new fp(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Ls(e,this.scaler))})}update(e,n=null){this.state=e.state;let r=this.stateDeco;this.stateDeco=this.state.facet(ko).filter(c=>typeof c!="function");let i=e.changedRanges,s=jt.extendWithRanges(i,LM(r,this.stateDeco,e?e.changes:Pe.empty(this.state.doc.length))),o=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);Ag(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||Yi)&&(e.flags|=2),l?(this.scrollAnchorPos=e.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let a=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(n&&(n.range.head<a.from||n.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,n));let u=a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,e.flags|=this.updateForViewport(),(u||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),n&&(this.scrollTarget=n),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(dw)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let n=e.contentDOM,r=window.getComputedStyle(n),i=this.heightOracle,s=r.whiteSpace;this.defaultTextDirection=r.direction=="rtl"?pe.RTL:pe.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),l=n.getBoundingClientRect(),a=o||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let u=0,c=0;if(l.width&&l.height){let{scaleX:x,scaleY:k}=V1(n,l);(x>.005&&Math.abs(this.scaleX-x)>.005||k>.005&&Math.abs(this.scaleY-k)>.005)&&(this.scaleX=x,this.scaleY=k,u|=16,o=a=!0)}let h=(parseInt(r.paddingTop)||0)*this.scaleY,f=(parseInt(r.paddingBottom)||0)*this.scaleY;(this.paddingTop!=h||this.paddingBottom!=f)&&(this.paddingTop=h,this.paddingBottom=f,u|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,u|=16);let d=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=d&&(this.scrollAnchorHeight=-1,this.scrollTop=d),this.scrolledToBottom=$1(e.scrollDOM);let p=(this.printing?jM:_M)(n,this.paddingTop),y=p.top-this.pixelViewport.top,w=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let m=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(m!=this.inView&&(this.inView=m,m&&(a=!0)),!this.inView&&!this.scrollTarget&&!IM(e.dom))return 0;let g=l.width;if((this.contentDOMWidth!=g||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=e.scrollDOM.clientHeight,u|=16),a){let x=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(x)&&(o=!0),o||i.lineWrapping&&Math.abs(g-this.contentDOMWidth)>i.charWidth){let{lineHeight:k,charWidth:b,textHeight:C}=e.docView.measureTextSize();o=k>0&&i.refresh(s,k,b,C,Math.max(5,g/b),x),o&&(e.docView.minWidth=0,u|=16)}y>0&&w>0?c=Math.max(y,w):y<0&&w<0&&(c=Math.min(y,w)),Ag();for(let k of this.viewports){let b=k.from==this.viewport.from?x:e.docView.measureVisibleLineHeights(k);this.heightMap=(o?st.empty().applyChanges(this.stateDeco,re.empty,this.heightOracle,[new jt(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,o,new OM(k.from,b))}Yi&&(u|=2)}let v=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(u&2&&(u|=this.updateScaler()),this.viewport=this.getViewport(c,this.scrollTarget),u|=this.updateForViewport()),(u&2||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),u}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,n){let r=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:l}=this,a=new Sl(i.lineAt(o-r*1e3,fe.ByHeight,s,0,0).from,i.lineAt(l+(1-r)*1e3,fe.ByHeight,s,0,0).to);if(n){let{head:u}=n.range;if(u<a.from||u>a.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=i.lineAt(u,fe.ByPos,s,0,0),f;n.y=="center"?f=(h.top+h.bottom)/2-c/2:n.y=="start"||n.y=="nearest"&&u<a.from?f=h.top:f=h.bottom-c,a=new Sl(i.lineAt(f-1e3/2,fe.ByHeight,s,0,0).from,i.lineAt(f+c+1e3/2,fe.ByHeight,s,0,0).to)}}return a}mapViewport(e,n){let r=n.mapPos(e.from,-1),i=n.mapPos(e.to,1);return new Sl(this.heightMap.lineAt(r,fe.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,fe.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:n},r=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,fe.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(n,fe.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:l}=this;return(e==0||i<=o-Math.max(10,Math.min(-r,250)))&&(n==this.state.doc.length||s>=l+Math.max(10,Math.min(r,250)))&&i>o-2*1e3&&s<l+2*1e3}mapLineGaps(e,n){if(!e.length||n.empty)return e;let r=[];for(let i of e)n.touchesRange(i.from,i.to)||r.push(new Tc(n.mapPos(i.from),n.mapPos(i.to),i.size,i.displaySize));return r}ensureLineGaps(e,n){let r=this.heightOracle.lineWrapping,i=r?1e4:2e3,s=i>>1,o=i<<1;if(this.defaultTextDirection!=pe.LTR&&!r)return[];let l=[],a=(c,h,f,d)=>{if(h-c<s)return;let p=this.state.selection.main,y=[p.from];p.empty||y.push(p.to);for(let m of y)if(m>c&&m<h){a(c,m-10,f,d),a(m+10,h,f,d);return}let w=WM(e,m=>m.from>=f.from&&m.to<=f.to&&Math.abs(m.from-c)<s&&Math.abs(m.to-h)<s&&!y.some(g=>m.from<g&&m.to>g));if(!w){if(h<f.to&&n&&r&&n.visibleRanges.some(v=>v.from<=h&&v.to>=h)){let v=n.moveToLineBoundary(A.cursor(h),!1,!0).head;v>c&&(h=v)}let m=this.gapSize(f,c,h,d),g=r||m<2e6?m:2e6;w=new Tc(c,h,m,g)}l.push(w)},u=c=>{if(c.length<o||c.type!=it.Text)return;let h=zM(c.from,c.to,this.stateDeco);if(h.total<o)return;let f=this.scrollTarget?this.scrollTarget.range.head:null,d,p;if(r){let y=i/this.heightOracle.lineLength*this.heightOracle.lineHeight,w,m;if(f!=null){let g=bl(h,f),v=((this.visibleBottom-this.visibleTop)/2+y)/c.height;w=g-v,m=g+v}else w=(this.visibleTop-c.top-y)/c.height,m=(this.visibleBottom-c.top+y)/c.height;d=kl(h,w),p=kl(h,m)}else{let y=h.total*this.heightOracle.charWidth,w=i*this.heightOracle.charWidth,m=0;if(y>2e6)for(let b of e)b.from>=c.from&&b.from<c.to&&b.size!=b.displaySize&&b.from*this.heightOracle.charWidth+m<this.pixelViewport.left&&(m=b.size-b.displaySize);let g=this.pixelViewport.left+m,v=this.pixelViewport.right+m,x,k;if(f!=null){let b=bl(h,f),C=((v-g)/2+w)/y;x=b-C,k=b+C}else x=(g-w)/y,k=(v+w)/y;d=kl(h,x),p=kl(h,k)}d>c.from&&a(c.from,d,c,h),p<c.to&&a(p,c.to,c,h)};for(let c of this.viewportLines)Array.isArray(c.type)?c.type.forEach(u):u(c);return l}gapSize(e,n,r,i){let s=bl(i,r)-bl(i,n);return this.heightOracle.lineWrapping?e.height*s:i.total*this.heightOracle.charWidth*s}updateLineGaps(e){Tc.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=$.set(e.map(n=>n.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let n=this.stateDeco;this.lineGaps.length&&(n=n.concat(this.lineGapDeco));let r=[];ne.spans(n,this.viewport.from,this.viewport.to,{span(s,o){r.push({from:s,to:o})},point(){}},20);let i=0;if(r.length!=this.visibleRanges.length)i=12;else for(let s=0;s<r.length&&!(i&8);s++){let o=this.visibleRanges[s],l=r[s];(o.from!=l.from||o.to!=l.to)&&(i|=4,e&&e.mapPos(o.from,-1)==l.from&&e.mapPos(o.to,1)==l.to||(i|=8))}return this.visibleRanges=r,i}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(n=>n.from<=e&&n.to>=e)||Ls(this.heightMap.lineAt(e,fe.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(n=>n.top<=e&&n.bottom>=e)||Ls(this.heightMap.lineAt(this.scaler.fromDOM(e),fe.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let n=this.lineBlockAtHeight(e+8);return n.from>=this.viewport.from||this.viewportLines[0].top-e>200?n:this.viewportLines[0]}elementAtHeight(e){return Ls(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Sl{constructor(e,n){this.from=e,this.to=n}}function zM(t,e,n){let r=[],i=t,s=0;return ne.spans(n,t,e,{span(){},point(o,l){o>i&&(r.push({from:i,to:o}),s+=o-i),i=l}},20),i<e&&(r.push({from:i,to:e}),s+=e-i),{total:s,ranges:r}}function kl({total:t,ranges:e},n){if(n<=0)return e[0].from;if(n>=1)return e[e.length-1].to;let r=Math.floor(t*n);for(let i=0;;i++){let{from:s,to:o}=e[i],l=o-s;if(r<=l)return s+r;r-=l}}function bl(t,e){let n=0;for(let{from:r,to:i}of t.ranges){if(e<=i){n+=e-r;break}n+=i-r}return n/t.total}function WM(t,e){for(let n of t)if(e(n))return n}const Dg={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class fp{constructor(e,n,r){let i=0,s=0,o=0;this.viewports=r.map(({from:l,to:a})=>{let u=n.lineAt(l,fe.ByPos,e,0,0).top,c=n.lineAt(a,fe.ByPos,e,0,0).bottom;return i+=c-u,{from:l,to:a,top:u,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(n.height-i);for(let l of this.viewports)l.domTop=o+(l.top-s)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),s=l.bottom}toDOM(e){for(let n=0,r=0,i=0;;n++){let s=n<this.viewports.length?this.viewports[n]:null;if(!s||e<s.top)return i+(e-r)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);r=s.bottom,i=s.domBottom}}fromDOM(e){for(let n=0,r=0,i=0;;n++){let s=n<this.viewports.length?this.viewports[n]:null;if(!s||e<s.domTop)return r+(e-i)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);r=s.bottom,i=s.domBottom}}eq(e){return e instanceof fp?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((n,r)=>n.from==e.viewports[r].from&&n.to==e.viewports[r].to):!1}}function Ls(t,e){if(e.scale==1)return t;let n=e.toDOM(t.top),r=e.toDOM(t.bottom);return new gn(t.from,t.length,n,r-n,Array.isArray(t._content)?t._content.map(i=>Ls(i,e)):t._content)}const Cl=I.define({combine:t=>t.join(" ")}),Bf=I.define({combine:t=>t.indexOf(!0)>-1}),_f=vr.newName(),Bw=vr.newName(),_w=vr.newName(),Iw={"&light":"."+Bw,"&dark":"."+_w};function If(t,e,n){return new vr(e,{finish(r){return/&/.test(r)?r.replace(/&\w*/,i=>{if(i=="&")return t;if(!n||!n[i])throw new RangeError(`Unsupported selector: ${i}`);return n[i]}):t+" "+r}})}const VM=If("."+_f,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Iw),HM={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Oc=_.ie&&_.ie_version<=11;class UM{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new A2,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(n=>{for(let r of n)this.queue.push(r);(_.ie&&_.ie_version<=11||_.ios&&e.composing)&&n.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&_.android&&e.constructor.EDIT_CONTEXT!==!1&&!(_.chrome&&_.chrome_version<126)&&(this.editContext=new KM(e),e.state.facet(On)&&(e.contentDOM.editContext=this.editContext.editContext)),Oc&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var n;((n=this.view.docView)===null||n===void 0?void 0:n.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(n=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),n.length>0&&n[n.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(n=>{n.length>0&&n[n.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((n,r)=>n!=e[r]))){this.gapIntersection.disconnect();for(let n of e)this.gapIntersection.observe(n);this.gaps=e}}onSelectionChange(e){let n=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,i=this.selectionRange;if(r.state.facet(On)?r.root.activeElement!=this.dom:!aa(this.dom,i))return;let s=i.anchorNode&&r.docView.nearest(i.anchorNode);if(s&&s.ignoreEvent(e)){n||(this.selectionChanged=!1);return}(_.ie&&_.ie_version<=11||_.android&&_.chrome)&&!r.state.selection.main.empty&&i.focusNode&&Gs(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,n=So(e.root);if(!n)return!1;let r=_.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&$M(this.view,n)||n;if(!r||this.selectionRange.eq(r))return!1;let i=aa(this.dom,r);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&P2(this.dom,r)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(r),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,n){this.selectionRange.set(e.node,e.offset,n.node,n.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,n=null;for(let r=this.dom;r;)if(r.nodeType==1)!n&&e<this.scrollTargets.length&&this.scrollTargets[e]==r?e++:n||(n=this.scrollTargets.slice(0,e)),n&&n.push(r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;if(e<this.scrollTargets.length&&!n&&(n=this.scrollTargets.slice(0,e)),n){for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);for(let r of this.scrollTargets=n)r.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,HM),Oc&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Oc&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,n){var r;if(!this.delayedAndroidKey){let i=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&Ri(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(i)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:n,force:this.lastChange<Date.now()-50||!!(!((r=this.delayedAndroidKey)===null||r===void 0)&&r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let n=-1,r=-1,i=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(i=!0),n==-1?{from:n,to:r}=o:(n=Math.min(o.from,n),r=Math.max(o.to,r)))}return{from:n,to:r,typeOver:i}}readChange(){let{from:e,to:n,typeOver:r}=this.processRecords(),i=this.selectionChanged&&aa(this.dom,this.selectionRange);if(e<0&&!i)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new uM(this.view,e,n,r);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let n=this.readChange();if(!n)return this.view.requestMeasure(),!1;let r=this.view.state,i=Cw(this.view,n);return this.view.state==r&&(n.domChanged||n.newSel&&!n.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),i}readMutation(e){let n=this.view.docView.nearest(e.target);if(!n||n.ignoreMutation(e))return null;if(n.markDirty(e.type=="attributes"),e.type=="attributes"&&(n.flags|=4),e.type=="childList"){let r=Tg(n,e.previousSibling||e.target.previousSibling,-1),i=Tg(n,e.nextSibling||e.target.nextSibling,1);return{from:r?n.posAfter(r):n.posAtStart,to:i?n.posBefore(i):n.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(On)!=e.state.facet(On)&&(e.view.contentDOM.editContext=e.state.facet(On)?this.editContext.editContext:null))}destroy(){var e,n,r;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(n=this.gapIntersection)===null||n===void 0||n.disconnect(),(r=this.resizeScroll)===null||r===void 0||r.disconnect();for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Tg(t,e,n){for(;e;){let r=le.get(e);if(r&&r.parent==t)return r;let i=e.parentNode;e=i!=t.dom?i:n>0?e.nextSibling:e.previousSibling}return null}function Og(t,e){let n=e.startContainer,r=e.startOffset,i=e.endContainer,s=e.endOffset,o=t.docView.domAtPos(t.state.selection.main.anchor);return Gs(o.node,o.offset,i,s)&&([n,r,i,s]=[i,s,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:s}}function $M(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return Og(t,i)}let n=null;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",r,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",r,!0),n?Og(t,n):null}class KM{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let n=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=r=>{let i=e.state.selection.main,{anchor:s,head:o}=i,l=this.toEditorPos(r.updateRangeStart),a=this.toEditorPos(r.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:r.updateRangeStart,editorBase:l,drifted:!1});let u=a-l>r.text.length;l==this.from&&s<this.from?l=s:a==this.to&&s>this.to&&(a=s);let c=Mw(e.state.sliceDoc(l,a),r.text,(u?i.from:i.to)-l,u?"end":null);if(!c){let f=A.single(this.toEditorPos(r.selectionStart),this.toEditorPos(r.selectionEnd));f.main.eq(i)||e.dispatch({selection:f,userEvent:"select"});return}let h={from:c.from+l,to:c.toA+l,insert:re.of(r.text.slice(c.from,c.toB).split(`
`))};if((_.mac||_.android)&&h.from==o-1&&/^\. ?$/.test(r.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(h={from:l,to:a,insert:re.of([r.text.replace("."," ")])}),this.pendingContextChange=h,!e.state.readOnly){let f=this.to-this.from+(h.to-h.from+h.insert.length);cp(e,h,A.single(this.toEditorPos(r.selectionStart,f),this.toEditorPos(r.selectionEnd,f)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),h.from<h.to&&!h.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(n.text.slice(Math.max(0,r.updateRangeStart-1),Math.min(n.text.length,r.updateRangeStart+1)))&&this.handlers.compositionend(r)},this.handlers.characterboundsupdate=r=>{let i=[],s=null;for(let o=this.toEditorPos(r.rangeStart),l=this.toEditorPos(r.rangeEnd);o<l;o++){let a=e.coordsForChar(o);s=a&&new DOMRect(a.left,a.top,a.right-a.left,a.bottom-a.top)||s||new DOMRect,i.push(s)}n.updateCharacterBounds(r.rangeStart,i)},this.handlers.textformatupdate=r=>{let i=[];for(let s of r.getTextFormats()){let o=s.underlineStyle,l=s.underlineThickness;if(!/none/i.test(o)&&!/none/i.test(l)){let a=this.toEditorPos(s.rangeStart),u=this.toEditorPos(s.rangeEnd);if(a<u){let c=`text-decoration: underline ${/^[a-z]/.test(o)?o+" ":o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${/thin/i.test(l)?1:2}px`;i.push($.mark({attributes:{style:c}}).range(a,u))}}}e.dispatch({effects:mw.of($.set(i))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:r}=this.composing;this.composing=null,r&&this.reset(e.state)}};for(let r in this.handlers)n.addEventListener(r,this.handlers[r]);this.measureReq={read:r=>{this.editContext.updateControlBounds(r.contentDOM.getBoundingClientRect());let i=So(r.root);i&&i.rangeCount&&this.editContext.updateSelectionBounds(i.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let n=0,r=!1,i=this.pendingContextChange;return e.changes.iterChanges((s,o,l,a,u)=>{if(r)return;let c=u.length-(o-s);if(i&&o>=i.to)if(i.from==s&&i.to==o&&i.insert.eq(u)){i=this.pendingContextChange=null,n+=c,this.to+=c;return}else i=null,this.revertPending(e.state);if(s+=n,o+=n,o<=this.from)this.from+=c,this.to+=c;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+u.length>3e4){r=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),u.toString()),this.to+=c}n+=c}),i&&!r&&this.revertPending(e.state),!r}update(e){let n=this.pendingContextChange,r=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(r.from,r.to)&&e.transactions.some(i=>!i.isUserEvent("input.type")&&i.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||n)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:n}=e.selection.main;this.from=Math.max(0,n-1e4),this.to=Math.min(e.doc.length,n+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let n=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(n.from),this.toContextPos(n.from+n.insert.length),e.doc.sliceString(n.from,n.to))}setSelection(e){let{main:n}=e.selection,r=this.toContextPos(Math.max(this.from,Math.min(this.to,n.anchor))),i=this.toContextPos(n.head);(this.editContext.selectionStart!=r||this.editContext.selectionEnd!=i)&&this.editContext.updateSelection(r,i)}rangeIsValid(e){let{head:n}=e.selection.main;return!(this.from>0&&n-this.from<500||this.to<e.doc.length&&this.to-n<500||this.to-this.from>1e4*3)}toEditorPos(e,n=this.to-this.from){e=Math.min(e,n);let r=this.composing;return r&&r.drifted?r.editorBase+(e-r.contextBase):e+this.from}toContextPos(e){let n=this.composing;return n&&n.drifted?n.contextBase+(e-n.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class B{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var n;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:r}=e;this.dispatchTransactions=e.dispatchTransactions||r&&(i=>i.forEach(s=>r(s,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=e.root||E2(e.parent)||document,this.viewState=new Pg(e.state||ee.create(e)),e.scrollTo&&e.scrollTo.is(vl)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(ki).map(i=>new Ec(i));for(let i of this.plugins)i.update(this);this.observer=new UM(this),this.inputState=new dM(this),this.inputState.ensureHandlers(this.plugins),this.docView=new ug(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((n=document.fonts)===null||n===void 0)&&n.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let n=e.length==1&&e[0]instanceof Te?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(n,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let n=!1,r=!1,i,s=this.state;for(let f of e){if(f.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=f.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,l=0,a=null;e.some(f=>f.annotation(Ow))?(this.inputState.notifiedFocused=o,l=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,a=Rw(s,o),a||(l=1));let u=this.observer.delayedAndroidKey,c=null;if(u?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(c=null)):this.observer.clear(),s.facet(ee.phrases)!=this.state.facet(ee.phrases))return this.setState(s);i=Ua.create(this,s,e),i.flags|=l;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let f of e){if(h&&(h=h.map(f.changes)),f.scrollIntoView){let{main:d}=f.state.selection;h=new Ni(d.empty?d:A.cursor(d.head,d.head>d.anchor?-1:1))}for(let d of f.effects)d.is(vl)&&(h=d.value.clip(this.state))}this.viewState.update(i,h),this.bidiCache=Ka.update(this.bidiCache,i.changes),i.empty||(this.updatePlugins(i),this.inputState.update(i)),n=this.docView.update(i),this.state.facet(Rs)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(n,e.some(f=>f.isUserEvent("select.pointer")))}finally{this.updateState=0}if(i.startState.facet(Cl)!=i.state.facet(Cl)&&(this.viewState.mustMeasureContent=!0),(n||r||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),n&&this.docViewUpdate(),!i.empty)for(let f of this.state.facet(Of))try{f(i)}catch(d){pt(this.state,d,"update listener")}(a||c)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),c&&!Cw(this,c)&&u.force&&Ri(this.contentDOM,u.key,u.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let n=this.hasFocus;try{for(let r of this.plugins)r.destroy(this);this.viewState=new Pg(e),this.plugins=e.facet(ki).map(r=>new Ec(r)),this.pluginMap.clear();for(let r of this.plugins)r.update(this);this.docView.destroy(),this.docView=new ug(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}n&&this.focus(),this.requestMeasure()}updatePlugins(e){let n=e.startState.facet(ki),r=e.state.facet(ki);if(n!=r){let i=[];for(let s of r){let o=n.indexOf(s);if(o<0)i.push(new Ec(s));else{let l=this.plugins[o];l.mustUpdate=e,i.push(l)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(let i of this.plugins)i.mustUpdate=e;for(let i=0;i<this.plugins.length;i++)this.plugins[i].update(this);n!=r&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let n=e.value;if(n&&n.docViewUpdate)try{n.docViewUpdate(this)}catch(r){pt(this.state,r,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let n=null,r=this.scrollDOM,i=r.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(i-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(o<0)if($1(r))s=-1,o=this.viewState.heightMap.height;else{let d=this.viewState.scrollAnchorAt(i);s=d.from,o=d.top}this.updateState=1;let a=this.viewState.measure(this);if(!a&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let u=[];a&4||([this.measureRequests,u]=[u,this.measureRequests]);let c=u.map(d=>{try{return d.read(this)}catch(p){return pt(this.state,p),Rg}}),h=Ua.create(this,this.state,[]),f=!1;h.flags|=a,n?n.flags|=a:n=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),f=this.docView.update(h),f&&this.docViewUpdate());for(let d=0;d<u.length;d++)if(c[d]!=Rg)try{let p=u[d];p.write&&p.write(c[d],this)}catch(p){pt(this.state,p)}if(f&&this.docView.updateSelection(!0),!h.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let p=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(p>1||p<-1){i=i+p,r.scrollTop=i/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(n&&!n.empty)for(let l of this.state.facet(Of))l(n)}get themeClasses(){return _f+" "+(this.state.facet(Bf)?_w:Bw)+" "+this.state.facet(Cl)}updateAttrs(){let e=Ng(this,gw,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),n={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(On)?"true":"false",class:"cm-content",style:`${_.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(n["aria-readonly"]="true"),Ng(this,ap,n);let r=this.observer.ignore(()=>{let i=Af(this.contentDOM,this.contentAttrs,n),s=Af(this.dom,this.editorAttrs,e);return i||s});return this.editorAttrs=e,this.contentAttrs=n,r}showAnnouncements(e){let n=!0;for(let r of e)for(let i of r.effects)if(i.is(B.announce)){n&&(this.announceDOM.textContent=""),n=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=i.value}}mountStyles(){this.styleModules=this.state.facet(Rs);let e=this.state.facet(B.cspNonce);vr.mount(this.root,this.styleModules.concat(VM).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let n=0;n<this.measureRequests.length;n++)if(this.measureRequests[n].key===e.key){this.measureRequests[n]=e;return}}this.measureRequests.push(e)}}plugin(e){let n=this.pluginMap.get(e);return(n===void 0||n&&n.plugin!=e)&&this.pluginMap.set(e,n=this.plugins.find(r=>r.plugin==e)||null),n&&n.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,n,r){return Dc(this,e,pg(this,e,n,r))}moveByGroup(e,n){return Dc(this,e,pg(this,e,n,r=>iM(this,e.head,r)))}visualLineSide(e,n){let r=this.bidiSpans(e),i=this.textDirectionAt(e.from),s=r[n?r.length-1:0];return A.cursor(s.side(n,i)+e.from,s.forward(!n,i)?1:-1)}moveToLineBoundary(e,n,r=!0){return rM(this,e,n,r)}moveVertically(e,n,r){return Dc(this,e,sM(this,e,n,r))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,n=0){return this.docView.posFromDOM(e,n)}posAtCoords(e,n=!0){return this.readMeasured(),Sw(this,e,n)}coordsAtPos(e,n=1){this.readMeasured();let r=this.docView.coordsAt(e,n);if(!r||r.left==r.right)return r;let i=this.state.doc.lineAt(e),s=this.bidiSpans(i),o=s[sr.find(s,e-i.from,-1,n)];return Fo(r,o.dir==pe.LTR==n>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(fw)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>qM)return iw(e.length);let n=this.textDirectionAt(e.from),r;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==n&&(s.fresh||rw(s.isolates,r=ag(this,e))))return s.order;r||(r=ag(this,e));let i=W2(e.text,n,r);return this.bidiCache.push(new Ka(e.from,e.to,n,r,!0,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||_.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{H1(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,n={}){return vl.of(new Ni(typeof e=="number"?A.cursor(e):e,n.y,n.x,n.yMargin,n.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:n}=this.scrollDOM,r=this.viewState.scrollAnchorAt(e);return vl.of(new Ni(A.cursor(r.from),"start","start",r.top-e,n,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Ce.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Ce.define(()=>({}),{eventObservers:e})}static theme(e,n){let r=vr.newName(),i=[Cl.of(r),Rs.of(If(`.${r}`,e))];return n&&n.dark&&i.push(Bf.of(!0)),i}static baseTheme(e){return ni.lowest(Rs.of(If("."+_f,e,Iw)))}static findFromDOM(e){var n;let r=e.querySelector(".cm-content"),i=r&&le.get(r)||le.get(e);return((n=i==null?void 0:i.rootView)===null||n===void 0?void 0:n.view)||null}}B.styleModule=Rs;B.inputHandler=cw;B.clipboardInputFilter=op;B.clipboardOutputFilter=lp;B.scrollHandler=pw;B.focusChangeEffect=hw;B.perLineTextDirection=fw;B.exceptionSink=uw;B.updateListener=Of;B.editable=On;B.mouseSelectionStyle=aw;B.dragMovesSelection=lw;B.clickAddsSelectionRange=ow;B.decorations=ko;B.outerDecorations=yw;B.atomicRanges=Vo;B.bidiIsolatedRanges=vw;B.scrollMargins=ww;B.darkTheme=Bf;B.cspNonce=I.define({combine:t=>t.length?t[0]:""});B.contentAttributes=ap;B.editorAttributes=gw;B.lineWrapping=B.contentAttributes.of({class:"cm-lineWrapping"});B.announce=G.define();const qM=4096,Rg={};class Ka{constructor(e,n,r,i,s,o){this.from=e,this.to=n,this.dir=r,this.isolates=i,this.fresh=s,this.order=o}static update(e,n){if(n.empty&&!e.some(s=>s.fresh))return e;let r=[],i=e.length?e[e.length-1].dir:pe.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==i&&!n.touchesRange(o.from,o.to)&&r.push(new Ka(n.mapPos(o.from,1),n.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return r}}function Ng(t,e,n){for(let r=t.state.facet(e),i=r.length-1;i>=0;i--){let s=r[i],o=typeof s=="function"?s(t):s;o&&Mf(o,n)}return n}const GM=_.mac?"mac":_.windows?"win":_.linux?"linux":"key";function XM(t,e){const n=t.split(/-(?!$)/);let r=n[n.length-1];r=="Space"&&(r=" ");let i,s,o,l;for(let a=0;a<n.length-1;++a){const u=n[a];if(/^(cmd|meta|m)$/i.test(u))l=!0;else if(/^a(lt)?$/i.test(u))i=!0;else if(/^(c|ctrl|control)$/i.test(u))s=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))e=="mac"?l=!0:s=!0;else throw new Error("Unrecognized modifier name: "+u)}return i&&(r="Alt-"+r),s&&(r="Ctrl-"+r),l&&(r="Meta-"+r),o&&(r="Shift-"+r),r}function Ml(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n!==!1&&e.shiftKey&&(t="Shift-"+t),t}const YM=ni.default(B.domEventHandlers({keydown(t,e){return Fw(jw(e.state),t,e,"editor")}})),Bu=I.define({enables:YM}),Lg=new WeakMap;function jw(t){let e=t.facet(Bu),n=Lg.get(e);return n||Lg.set(e,n=ZM(e.reduce((r,i)=>r.concat(i),[]))),n}function QM(t,e,n){return Fw(jw(t.state),e,t,n)}let er=null;const JM=4e3;function ZM(t,e=GM){let n=Object.create(null),r=Object.create(null),i=(o,l)=>{let a=r[o];if(a==null)r[o]=l;else if(a!=l)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,l,a,u,c)=>{var h,f;let d=n[o]||(n[o]=Object.create(null)),p=l.split(/ (?!$)/).map(m=>XM(m,e));for(let m=1;m<p.length;m++){let g=p.slice(0,m).join(" ");i(g,!0),d[g]||(d[g]={preventDefault:!0,stopPropagation:!1,run:[v=>{let x=er={view:v,prefix:g,scope:o};return setTimeout(()=>{er==x&&(er=null)},JM),!0}]})}let y=p.join(" ");i(y,!1);let w=d[y]||(d[y]={preventDefault:!1,stopPropagation:!1,run:((f=(h=d._any)===null||h===void 0?void 0:h.run)===null||f===void 0?void 0:f.slice())||[]});a&&w.run.push(a),u&&(w.preventDefault=!0),c&&(w.stopPropagation=!0)};for(let o of t){let l=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let u of l){let c=n[u]||(n[u]=Object.create(null));c._any||(c._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:h}=o;for(let f in c)c[f].run.push(d=>h(d,jf))}let a=o[e]||o.key;if(a)for(let u of l)s(u,a,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(u,"Shift-"+a,o.shift,o.preventDefault,o.stopPropagation)}return n}let jf=null;function Fw(t,e,n,r){jf=e;let i=S2(e),s=ht(i,0),o=mn(s)==i.length&&i!=" ",l="",a=!1,u=!1,c=!1;er&&er.view==n&&er.scope==r&&(l=er.prefix+" ",Ew.indexOf(e.keyCode)<0&&(u=!0,er=null));let h=new Set,f=w=>{if(w){for(let m of w.run)if(!h.has(m)&&(h.add(m),m(n)))return w.stopPropagation&&(c=!0),!0;w.preventDefault&&(w.stopPropagation&&(c=!0),u=!0)}return!1},d=t[r],p,y;return d&&(f(d[l+Ml(i,e,!o)])?a=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(_.windows&&e.ctrlKey&&e.altKey)&&!(_.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(p=wr[e.keyCode])&&p!=i?(f(d[l+Ml(p,e,!0)])||e.shiftKey&&(y=xo[e.keyCode])!=i&&y!=p&&f(d[l+Ml(y,e,!1)]))&&(a=!0):o&&e.shiftKey&&f(d[l+Ml(i,e,!0)])&&(a=!0),!a&&f(d._any)&&(a=!0)),u&&(a=!0),a&&c&&e.stopPropagation(),jf=null,a}class Ho{constructor(e,n,r,i,s){this.className=e,this.left=n,this.top=r,this.width=i,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,n){return n.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,n,r){if(r.empty){let i=e.coordsAtPos(r.head,r.assoc||1);if(!i)return[];let s=zw(e);return[new Ho(n,i.left-s.left,i.top-s.top,null,i.bottom-i.top)]}else return eA(e,n,r)}}function zw(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==pe.LTR?e.left:e.right-t.scrollDOM.clientWidth*t.scaleX)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}}function Bg(t,e,n,r){let i=t.coordsAtPos(e,n*2);if(!i)return r;let s=t.dom.getBoundingClientRect(),o=(i.top+i.bottom)/2,l=t.posAtCoords({x:s.left+1,y:o}),a=t.posAtCoords({x:s.right-1,y:o});return l==null||a==null?r:{from:Math.max(r.from,Math.min(l,a)),to:Math.min(r.to,Math.max(l,a))}}function eA(t,e,n){if(n.to<=t.viewport.from||n.from>=t.viewport.to)return[];let r=Math.max(n.from,t.viewport.from),i=Math.min(n.to,t.viewport.to),s=t.textDirection==pe.LTR,o=t.contentDOM,l=o.getBoundingClientRect(),a=zw(t),u=o.querySelector(".cm-line"),c=u&&window.getComputedStyle(u),h=l.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),f=l.right-(c?parseInt(c.paddingRight):0),d=Nf(t,r,1),p=Nf(t,i,-1),y=d.type==it.Text?d:null,w=p.type==it.Text?p:null;if(y&&(t.lineWrapping||d.widgetLineBreaks)&&(y=Bg(t,r,1,y)),w&&(t.lineWrapping||p.widgetLineBreaks)&&(w=Bg(t,i,-1,w)),y&&w&&y.from==w.from&&y.to==w.to)return g(v(n.from,n.to,y));{let k=y?v(n.from,null,y):x(d,!1),b=w?v(null,n.to,w):x(p,!0),C=[];return(y||d).to<(w||p).from-(y&&w?1:0)||d.widgetLineBreaks>1&&k.bottom+t.defaultLineHeight/2<b.top?C.push(m(h,k.bottom,f,b.top)):k.bottom<b.top&&t.elementAtHeight((k.bottom+b.top)/2).type==it.Text&&(k.bottom=b.top=(k.bottom+b.top)/2),g(k).concat(C).concat(g(b))}function m(k,b,C,E){return new Ho(e,k-a.left,b-a.top,C-k,E-b)}function g({top:k,bottom:b,horizontal:C}){let E=[];for(let O=0;O<C.length;O+=2)E.push(m(C[O],k,C[O+1],b));return E}function v(k,b,C){let E=1e9,O=-1e9,N=[];function V(H,Y,U,X,T){let L=t.coordsAtPos(H,H==C.to?-2:2),z=t.coordsAtPos(U,U==C.from?2:-2);!L||!z||(E=Math.min(L.top,z.top,E),O=Math.max(L.bottom,z.bottom,O),T==pe.LTR?N.push(s&&Y?h:L.left,s&&X?f:z.right):N.push(!s&&X?h:z.left,!s&&Y?f:L.right))}let j=k??C.from,D=b??C.to;for(let H of t.visibleRanges)if(H.to>j&&H.from<D)for(let Y=Math.max(H.from,j),U=Math.min(H.to,D);;){let X=t.state.doc.lineAt(Y);for(let T of t.bidiSpans(X)){let L=T.from+X.from,z=T.to+X.from;if(L>=U)break;z>Y&&V(Math.max(L,Y),k==null&&L<=j,Math.min(z,U),b==null&&z>=D,T.dir)}if(Y=X.to+1,Y>=U)break}return N.length==0&&V(j,k==null,D,b==null,t.textDirection),{top:E,bottom:O,horizontal:N}}function x(k,b){let C=l.top+(b?k.top:k.bottom);return{top:C,bottom:C,horizontal:[]}}}function tA(t,e){return t.constructor==e.constructor&&t.eq(e)}class nA{constructor(e,n){this.view=e,this.layer=n,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),n.above&&this.dom.classList.add("cm-layer-above"),n.class&&this.dom.classList.add(n.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),n.mount&&n.mount(this.dom,e)}update(e){e.startState.facet(ha)!=e.state.facet(ha)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let n=0,r=e.facet(ha);for(;n<r.length&&r[n]!=this.layer;)n++;this.dom.style.zIndex=String((this.layer.above?150:-1)-n)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:n}=this.view;(e!=this.scaleX||n!=this.scaleY)&&(this.scaleX=e,this.scaleY=n,this.dom.style.transform=`scale(${1/e}, ${1/n})`)}draw(e){if(e.length!=this.drawn.length||e.some((n,r)=>!tA(n,this.drawn[r]))){let n=this.dom.firstChild,r=0;for(let i of e)i.update&&n&&i.constructor&&this.drawn[r].constructor&&i.update(n,this.drawn[r])?(n=n.nextSibling,r++):this.dom.insertBefore(i.draw(),n);for(;n;){let i=n.nextSibling;n.remove(),n=i}this.drawn=e,_.safari&&_.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const ha=I.define();function Ww(t){return[Ce.define(e=>new nA(e,t)),ha.of(t)]}const bo=I.define({combine(t){return An(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,n)=>Math.min(e,n),drawRangeCursor:(e,n)=>e||n})}});function rA(t={}){return[bo.of(t),iA,sA,oA,dw.of(!0)]}function Vw(t){return t.startState.facet(bo)!=t.state.facet(bo)}const iA=Ww({above:!0,markers(t){let{state:e}=t,n=e.facet(bo),r=[];for(let i of e.selection.ranges){let s=i==e.selection.main;if(i.empty||n.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=i.empty?i:A.cursor(i.head,i.head>i.anchor?-1:1);for(let a of Ho.forRange(t,o,l))r.push(a)}}return r},update(t,e){t.transactions.some(r=>r.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let n=Vw(t);return n&&_g(t.state,e),t.docChanged||t.selectionSet||n},mount(t,e){_g(e.state,t)},class:"cm-cursorLayer"});function _g(t,e){e.style.animationDuration=t.facet(bo).cursorBlinkRate+"ms"}const sA=Ww({above:!1,markers(t){return t.state.selection.ranges.map(e=>e.empty?[]:Ho.forRange(t,"cm-selectionBackground",e)).reduce((e,n)=>e.concat(n))},update(t,e){return t.docChanged||t.selectionSet||t.viewportChanged||Vw(t)},class:"cm-selectionLayer"}),oA=ni.highest(B.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),Hw=G.define({map(t,e){return t==null?null:e.mapPos(t)}}),Bs=We.define({create(){return null},update(t,e){return t!=null&&(t=e.changes.mapPos(t)),e.effects.reduce((n,r)=>r.is(Hw)?r.value:n,t)}}),lA=Ce.fromClass(class{constructor(t){this.view=t,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(t){var e;let n=t.state.field(Bs);n==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(t.startState.field(Bs)!=n||t.docChanged||t.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:t}=this,e=t.state.field(Bs),n=e!=null&&t.coordsAtPos(e);if(!n)return null;let r=t.scrollDOM.getBoundingClientRect();return{left:n.left-r.left+t.scrollDOM.scrollLeft*t.scaleX,top:n.top-r.top+t.scrollDOM.scrollTop*t.scaleY,height:n.bottom-n.top}}drawCursor(t){if(this.cursor){let{scaleX:e,scaleY:n}=this.view;t?(this.cursor.style.left=t.left/e+"px",this.cursor.style.top=t.top/n+"px",this.cursor.style.height=t.height/n+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(t){this.view.state.field(Bs)!=t&&this.view.dispatch({effects:Hw.of(t)})}},{eventObservers:{dragover(t){this.setDropPos(this.view.posAtCoords({x:t.clientX,y:t.clientY}))},dragleave(t){(t.target==this.view.contentDOM||!this.view.contentDOM.contains(t.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function aA(){return[Bs,lA]}function Ig(t,e,n,r,i){e.lastIndex=0;for(let s=t.iterRange(n,r),o=n,l;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;l=e.exec(s.value);)i(o+l.index,l)}function uA(t,e){let n=t.visibleRanges;if(n.length==1&&n[0].from==t.viewport.from&&n[0].to==t.viewport.to)return n;let r=[];for(let{from:i,to:s}of n)i=Math.max(t.state.doc.lineAt(i).from,i-e),s=Math.min(t.state.doc.lineAt(s).to,s+e),r.length&&r[r.length-1].to>=i?r[r.length-1].to=s:r.push({from:i,to:s});return r}class cA{constructor(e){const{regexp:n,decoration:r,decorate:i,boundary:s,maxLength:o=1e3}=e;if(!n.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=n,i)this.addMatch=(l,a,u,c)=>i(c,u,u+l[0].length,l,a);else if(typeof r=="function")this.addMatch=(l,a,u,c)=>{let h=r(l,a,u);h&&c(u,u+l[0].length,h)};else if(r)this.addMatch=(l,a,u,c)=>c(u,u+l[0].length,r);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let n=new zn,r=n.add.bind(n);for(let{from:i,to:s}of uA(e,this.maxLength))Ig(e.state.doc,this.regexp,i,s,(o,l)=>this.addMatch(l,e,o,r));return n.finish()}updateDeco(e,n){let r=1e9,i=-1;return e.docChanged&&e.changes.iterChanges((s,o,l,a)=>{a>=e.view.viewport.from&&l<=e.view.viewport.to&&(r=Math.min(l,r),i=Math.max(a,i))}),e.viewportMoved||i-r>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,n.map(e.changes),r,i):n}updateRange(e,n,r,i){for(let s of e.visibleRanges){let o=Math.max(s.from,r),l=Math.min(s.to,i);if(l>=o){let a=e.state.doc.lineAt(o),u=a.to<l?e.state.doc.lineAt(l):a,c=Math.max(s.from,a.from),h=Math.min(s.to,u.to);if(this.boundary){for(;o>a.from;o--)if(this.boundary.test(a.text[o-1-a.from])){c=o;break}for(;l<u.to;l++)if(this.boundary.test(u.text[l-u.from])){h=l;break}}let f=[],d,p=(y,w,m)=>f.push(m.range(y,w));if(a==u)for(this.regexp.lastIndex=c-a.from;(d=this.regexp.exec(a.text))&&d.index<h-a.from;)this.addMatch(d,e,d.index+a.from,p);else Ig(e.state.doc,this.regexp,c,h,(y,w)=>this.addMatch(w,e,y,p));n=n.update({filterFrom:c,filterTo:h,filter:(y,w)=>y<c||w>h,add:f})}}return n}}const Ff=/x/.unicode!=null?"gu":"g",hA=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,Ff),fA={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Rc=null;function dA(){var t;if(Rc==null&&typeof document<"u"&&document.body){let e=document.body.style;Rc=((t=e.tabSize)!==null&&t!==void 0?t:e.MozTabSize)!=null}return Rc||!1}const fa=I.define({combine(t){let e=An(t,{render:null,specialChars:hA,addSpecialChars:null});return(e.replaceTabs=!dA())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Ff)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Ff)),e}});function pA(t={}){return[fa.of(t),mA()]}let jg=null;function mA(){return jg||(jg=Ce.fromClass(class{constructor(t){this.view=t,this.decorations=$.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(fa)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new cA({regexp:t.specialChars,decoration:(e,n,r)=>{let{doc:i}=n.state,s=ht(e[0],0);if(s==9){let o=i.lineAt(r),l=n.state.tabSize,a=rs(o.text,l,r-o.from);return $.replace({widget:new wA((l-a%l)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=$.replace({widget:new vA(t,s)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(fa);t.startState.facet(fa)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))}const gA="";function yA(t){return t>=32?gA:t==10?"":String.fromCharCode(9216+t)}class vA extends Un{constructor(e,n){super(),this.options=e,this.code=n}eq(e){return e.code==this.code}toDOM(e){let n=yA(this.code),r=e.state.phrase("Control character")+" "+(fA[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,r,n);if(i)return i;let s=document.createElement("span");return s.textContent=n,s.title=r,s.setAttribute("aria-label",r),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class wA extends Un{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function xA(){return kA}const SA=$.line({class:"cm-activeLine"}),kA=Ce.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,n=[];for(let r of t.state.selection.ranges){let i=t.lineBlockAt(r.head);i.from>e&&(n.push(SA.range(i.from)),e=i.from)}return $.set(n)}},{decorations:t=>t.decorations});class bA extends Un{constructor(e){super(),this.content=e}toDOM(e){let n=document.createElement("span");return n.className="cm-placeholder",n.style.pointerEvents="none",n.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(e):this.content.cloneNode(!0)),n.setAttribute("aria-hidden","true"),n}coordsAt(e){let n=e.firstChild?qi(e.firstChild):[];if(!n.length)return null;let r=window.getComputedStyle(e.parentNode),i=Fo(n[0],r.direction!="rtl"),s=parseInt(r.lineHeight);return i.bottom-i.top>s*1.5?{left:i.left,right:i.right,top:i.top,bottom:i.top+s}:i}ignoreEvent(){return!1}}function CA(t){let e=Ce.fromClass(class{constructor(n){this.view=n,this.placeholder=t?$.set([$.widget({widget:new bA(t),side:1}).range(0)]):$.none}get decorations(){return this.view.state.doc.length?$.none:this.placeholder}},{decorations:n=>n.decorations});return typeof t=="string"?[e,B.contentAttributes.of({"aria-placeholder":t})]:e}const zf=2e3;function MA(t,e,n){let r=Math.min(e.line,n.line),i=Math.max(e.line,n.line),s=[];if(e.off>zf||n.off>zf||e.col<0||n.col<0){let o=Math.min(e.off,n.off),l=Math.max(e.off,n.off);for(let a=r;a<=i;a++){let u=t.doc.line(a);u.length<=l&&s.push(A.range(u.from+o,u.to+l))}}else{let o=Math.min(e.col,n.col),l=Math.max(e.col,n.col);for(let a=r;a<=i;a++){let u=t.doc.line(a),c=yf(u.text,o,t.tabSize,!0);if(c<0)s.push(A.cursor(u.to));else{let h=yf(u.text,l,t.tabSize);s.push(A.range(u.from+c,u.from+h))}}}return s}function AA(t,e){let n=t.coordsAtPos(t.viewport.from);return n?Math.round(Math.abs((n.left-e)/t.defaultCharacterWidth)):-1}function Fg(t,e){let n=t.posAtCoords({x:e.clientX,y:e.clientY},!1),r=t.state.doc.lineAt(n),i=n-r.from,s=i>zf?-1:i==r.length?AA(t,e.clientX):rs(r.text,t.state.tabSize,n-r.from);return{line:r.number,col:s,off:i}}function EA(t,e){let n=Fg(t,e),r=t.state.selection;return n?{update(i){if(i.docChanged){let s=i.changes.mapPos(i.startState.doc.line(n.line).from),o=i.state.doc.lineAt(s);n={line:o.number,col:n.col,off:Math.min(n.off,o.length)},r=r.map(i.changes)}},get(i,s,o){let l=Fg(t,i);if(!l)return r;let a=MA(t.state,n,l);return a.length?o?A.create(a.concat(r.ranges)):A.create(a):r}}:null}function PA(t){let e=n=>n.altKey&&n.button==0;return B.mouseSelectionStyle.of((n,r)=>e(r)?EA(n,r):null)}const DA={Alt:[18,t=>!!t.altKey],Control:[17,t=>!!t.ctrlKey],Shift:[16,t=>!!t.shiftKey],Meta:[91,t=>!!t.metaKey]},TA={style:"cursor: crosshair"};function OA(t={}){let[e,n]=DA[t.key||"Alt"],r=Ce.fromClass(class{constructor(i){this.view=i,this.isDown=!1}set(i){this.isDown!=i&&(this.isDown=i,this.view.update([]))}},{eventObservers:{keydown(i){this.set(i.keyCode==e||n(i))},keyup(i){(i.keyCode==e||!n(i))&&this.set(!1)},mousemove(i){this.set(n(i))}}});return[r,B.contentAttributes.of(i=>{var s;return!((s=i.plugin(r))===null||s===void 0)&&s.isDown?TA:null})]}const gs="-10000px";class Uw{constructor(e,n,r,i){this.facet=n,this.createTooltipView=r,this.removeTooltipView=i,this.input=e.state.facet(n),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=r(o,s))}update(e,n){var r;let i=e.state.facet(this.facet),s=i.filter(a=>a);if(i===this.input){for(let a of this.tooltipViews)a.update&&a.update(e);return!1}let o=[],l=n?[]:null;for(let a=0;a<s.length;a++){let u=s[a],c=-1;if(u){for(let h=0;h<this.tooltips.length;h++){let f=this.tooltips[h];f&&f.create==u.create&&(c=h)}if(c<0)o[a]=this.createTooltipView(u,a?o[a-1]:null),l&&(l[a]=!!u.above);else{let h=o[a]=this.tooltipViews[c];l&&(l[a]=n[c]),h.update&&h.update(e)}}}for(let a of this.tooltipViews)o.indexOf(a)<0&&(this.removeTooltipView(a),(r=a.destroy)===null||r===void 0||r.call(a));return n&&(l.forEach((a,u)=>n[u]=a),n.length=l.length),this.input=i,this.tooltips=s,this.tooltipViews=o,!0}}function RA(t){let e=t.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const Nc=I.define({combine:t=>{var e,n,r;return{position:_.ios?"absolute":((e=t.find(i=>i.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((n=t.find(i=>i.parent))===null||n===void 0?void 0:n.parent)||null,tooltipSpace:((r=t.find(i=>i.tooltipSpace))===null||r===void 0?void 0:r.tooltipSpace)||RA}}}),zg=new WeakMap,dp=Ce.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(Nc);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new Uw(t,pp,(n,r)=>this.createTooltip(n,r),n=>{this.resizeObserver&&this.resizeObserver.unobserve(n.dom),n.dom.remove()}),this.above=this.manager.tooltips.map(n=>!!n.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(n=>{Date.now()>this.lastTransaction-50&&n.length>0&&n[n.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let n=e||t.geometryChanged,r=t.state.facet(Nc);if(r.position!=this.position&&!this.madeAbsolute){this.position=r.position;for(let i of this.manager.tooltipViews)i.dom.style.position=this.position;n=!0}if(r.parent!=this.parent){this.parent&&this.container.remove(),this.parent=r.parent,this.createContainer();for(let i of this.manager.tooltipViews)this.container.appendChild(i.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(t,e){let n=t.create(this.view),r=e?e.dom:null;if(n.dom.classList.add("cm-tooltip"),t.arrow&&!n.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let i=document.createElement("div");i.className="cm-tooltip-arrow",n.dom.appendChild(i)}return n.dom.style.position=this.position,n.dom.style.top=gs,n.dom.style.left="0px",this.container.insertBefore(n.dom,r),n.mount&&n.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(n.dom),n}destroy(){var t,e,n;this.view.win.removeEventListener("resize",this.measureSoon);for(let r of this.manager.tooltipViews)r.dom.remove(),(t=r.destroy)===null||t===void 0||t.call(r);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(n=this.intersectionObserver)===null||n===void 0||n.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=1,e=1,n=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(_.gecko)n=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==gs&&s.style.left=="0px"){let o=s.getBoundingClientRect();n=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(n||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(t=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:e}=this.view.viewState);let r=this.view.scrollDOM.getBoundingClientRect(),i=up(this.view);return{visible:{left:r.left+i.left,top:r.top+i.top,right:r.right-i.right,bottom:r.bottom-i.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,o)=>{let l=this.manager.tooltipViews[o];return l.getCoords?l.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(Nc).tooltipSpace(this.view),scaleX:t,scaleY:e,makeAbsolute:n}}writeMeasure(t){var e;if(t.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let l of this.manager.tooltipViews)l.dom.style.position="absolute"}let{visible:n,space:r,scaleX:i,scaleY:s}=t,o=[];for(let l=0;l<this.manager.tooltips.length;l++){let a=this.manager.tooltips[l],u=this.manager.tooltipViews[l],{dom:c}=u,h=t.pos[l],f=t.size[l];if(!h||a.clip!==!1&&(h.bottom<=Math.max(n.top,r.top)||h.top>=Math.min(n.bottom,r.bottom)||h.right<Math.max(n.left,r.left)-.1||h.left>Math.min(n.right,r.right)+.1)){c.style.top=gs;continue}let d=a.arrow?u.dom.querySelector(".cm-tooltip-arrow"):null,p=d?7:0,y=f.right-f.left,w=(e=zg.get(u))!==null&&e!==void 0?e:f.bottom-f.top,m=u.offset||LA,g=this.view.textDirection==pe.LTR,v=f.width>r.right-r.left?g?r.left:r.right-f.width:g?Math.max(r.left,Math.min(h.left-(d?14:0)+m.x,r.right-y)):Math.min(Math.max(r.left,h.left-y+(d?14:0)-m.x),r.right-y),x=this.above[l];!a.strictSide&&(x?h.top-w-p-m.y<r.top:h.bottom+w+p+m.y>r.bottom)&&x==r.bottom-h.bottom>h.top-r.top&&(x=this.above[l]=!x);let k=(x?h.top-r.top:r.bottom-h.bottom)-p;if(k<w&&u.resize!==!1){if(k<this.view.defaultLineHeight){c.style.top=gs;continue}zg.set(u,w),c.style.height=(w=k)/s+"px"}else c.style.height&&(c.style.height="");let b=x?h.top-w-p-m.y:h.bottom+p+m.y,C=v+y;if(u.overlap!==!0)for(let E of o)E.left<C&&E.right>v&&E.top<b+w&&E.bottom>b&&(b=x?E.top-w-2-p:E.bottom+p+2);if(this.position=="absolute"?(c.style.top=(b-t.parent.top)/s+"px",Wg(c,(v-t.parent.left)/i)):(c.style.top=b/s+"px",Wg(c,v/i)),d){let E=h.left+(g?m.x:-m.x)-(v+14-7);d.style.left=E/i+"px"}u.overlap!==!0&&o.push({left:v,top:b,right:C,bottom:b+w}),c.classList.toggle("cm-tooltip-above",x),c.classList.toggle("cm-tooltip-below",!x),u.positioned&&u.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=gs}},{eventObservers:{scroll(){this.maybeMeasure()}}});function Wg(t,e){let n=parseInt(t.style.left,10);(isNaN(n)||Math.abs(e-n)>1)&&(t.style.left=e+"px")}const NA=B.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),LA={x:0,y:0},pp=I.define({enables:[dp,NA]}),qa=I.define({combine:t=>t.reduce((e,n)=>e.concat(n),[])});class _u{static create(e){return new _u(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Uw(e,qa,(n,r)=>this.createHostedView(n,r),n=>n.dom.remove())}createHostedView(e,n){let r=e.create(this.view);return r.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(r.dom,n?n.dom.nextSibling:this.dom.firstChild),this.mounted&&r.mount&&r.mount(this.view),r}mount(e){for(let n of this.manager.tooltipViews)n.mount&&n.mount(e);this.mounted=!0}positioned(e){for(let n of this.manager.tooltipViews)n.positioned&&n.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let n of this.manager.tooltipViews)(e=n.destroy)===null||e===void 0||e.call(n)}passProp(e){let n;for(let r of this.manager.tooltipViews){let i=r[e];if(i!==void 0){if(n===void 0)n=i;else if(n!==i)return}}return n}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const BA=pp.compute([qa],t=>{let e=t.facet(qa);return e.length===0?null:{pos:Math.min(...e.map(n=>n.pos)),end:Math.max(...e.map(n=>{var r;return(r=n.end)!==null&&r!==void 0?r:n.pos})),create:_u.create,above:e[0].above,arrow:e.some(n=>n.arrow)}});class _A{constructor(e,n,r,i,s){this.view=e,this.source=n,this.field=r,this.setHover=i,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:n}=this,r=e.docView.nearest(n.target);if(!r)return;let i,s=1;if(r instanceof ir)i=r.posAtStart;else{if(i=e.posAtCoords(n),i==null)return;let l=e.coordsAtPos(i);if(!l||n.y<l.top||n.y>l.bottom||n.x<l.left-e.defaultCharacterWidth||n.x>l.right+e.defaultCharacterWidth)return;let a=e.bidiSpans(e.state.doc.lineAt(i)).find(c=>c.from<=i&&c.to>=i),u=a&&a.dir==pe.RTL?-1:1;s=n.x<l.left?-u:u}let o=this.source(e,i,s);if(o!=null&&o.then){let l=this.pending={pos:i};o.then(a=>{this.pending==l&&(this.pending=null,a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])}))},a=>pt(e.state,a,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(dp),n=e?e.manager.tooltips.findIndex(r=>r.create==_u.create):-1;return n>-1?e.manager.tooltipViews[n]:null}mousemove(e){var n,r;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:i,tooltip:s}=this;if(i.length&&s&&!IA(s.dom,e)||this.pending){let{pos:o}=i[0]||this.pending,l=(r=(n=i[0])===null||n===void 0?void 0:n.end)!==null&&r!==void 0?r:o;(o==l?this.view.posAtCoords(this.lastMove)!=o:!jA(this.view,o,l,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:n}=this;if(n.length){let{tooltip:r}=this;r&&r.dom.contains(e.relatedTarget)?this.watchTooltipLeave(r.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let n=r=>{e.removeEventListener("mouseleave",n),this.active.length&&!this.view.dom.contains(r.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",n)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Al=4;function IA(t,e){let{left:n,right:r,top:i,bottom:s}=t.getBoundingClientRect(),o;if(o=t.querySelector(".cm-tooltip-arrow")){let l=o.getBoundingClientRect();i=Math.min(l.top,i),s=Math.max(l.bottom,s)}return e.clientX>=n-Al&&e.clientX<=r+Al&&e.clientY>=i-Al&&e.clientY<=s+Al}function jA(t,e,n,r,i,s){let o=t.scrollDOM.getBoundingClientRect(),l=t.documentTop+t.documentPadding.top+t.contentHeight;if(o.left>r||o.right<r||o.top>i||Math.min(o.bottom,l)<i)return!1;let a=t.posAtCoords({x:r,y:i},!1);return a>=e&&a<=n}function FA(t,e={}){let n=G.define(),r=We.define({create(){return[]},update(i,s){if(i.length&&(e.hideOnChange&&(s.docChanged||s.selection)?i=[]:e.hideOn&&(i=i.filter(o=>!e.hideOn(s,o))),s.docChanged)){let o=[];for(let l of i){let a=s.changes.mapPos(l.pos,-1,nt.TrackDel);if(a!=null){let u=Object.assign(Object.create(null),l);u.pos=a,u.end!=null&&(u.end=s.changes.mapPos(u.end)),o.push(u)}}i=o}for(let o of s.effects)o.is(n)&&(i=o.value),o.is(zA)&&(i=[]);return i},provide:i=>qa.from(i)});return{active:r,extension:[r,Ce.define(i=>new _A(i,t,r,n,e.hoverTime||300)),BA]}}function $w(t,e){let n=t.plugin(dp);if(!n)return null;let r=n.manager.tooltips.indexOf(e);return r<0?null:n.manager.tooltipViews[r]}const zA=G.define(),Vg=I.define({combine(t){let e,n;for(let r of t)e=e||r.topContainer,n=n||r.bottomContainer;return{topContainer:e,bottomContainer:n}}});function Co(t,e){let n=t.plugin(Kw),r=n?n.specs.indexOf(e):-1;return r>-1?n.panels[r]:null}const Kw=Ce.fromClass(class{constructor(t){this.input=t.state.facet(Mo),this.specs=this.input.filter(n=>n),this.panels=this.specs.map(n=>n(t));let e=t.state.facet(Vg);this.top=new El(t,!0,e.topContainer),this.bottom=new El(t,!1,e.bottomContainer),this.top.sync(this.panels.filter(n=>n.top)),this.bottom.sync(this.panels.filter(n=>!n.top));for(let n of this.panels)n.dom.classList.add("cm-panel"),n.mount&&n.mount()}update(t){let e=t.state.facet(Vg);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new El(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new El(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let n=t.state.facet(Mo);if(n!=this.input){let r=n.filter(a=>a),i=[],s=[],o=[],l=[];for(let a of r){let u=this.specs.indexOf(a),c;u<0?(c=a(t.view),l.push(c)):(c=this.panels[u],c.update&&c.update(t)),i.push(c),(c.top?s:o).push(c)}this.specs=r,this.panels=i,this.top.sync(s),this.bottom.sync(o);for(let a of l)a.dom.classList.add("cm-panel"),a.mount&&a.mount()}else for(let r of this.panels)r.update&&r.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>B.scrollMargins.of(e=>{let n=e.plugin(t);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}})});class El{constructor(e,n,r){this.view=e,this.top=n,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let n of this.panels)n.destroy&&e.indexOf(n)<0&&n.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let n=this.container||this.view.dom;n.insertBefore(this.dom,this.top?n.firstChild:null)}let e=this.dom.firstChild;for(let n of this.panels)if(n.dom.parentNode==this.dom){for(;e!=n.dom;)e=Hg(e);e=e.nextSibling}else this.dom.insertBefore(n.dom,e);for(;e;)e=Hg(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Hg(t){let e=t.nextSibling;return t.remove(),e}const Mo=I.define({enables:Kw});class Vn extends Gr{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Vn.prototype.elementClass="";Vn.prototype.toDOM=void 0;Vn.prototype.mapMode=nt.TrackBefore;Vn.prototype.startSide=Vn.prototype.endSide=-1;Vn.prototype.point=!0;const da=I.define(),WA=I.define(),VA={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>ne.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},Qs=I.define();function HA(t){return[qw(),Qs.of({...VA,...t})]}const Ug=I.define({combine:t=>t.some(e=>e)});function qw(t){return[UA]}const UA=Ce.fromClass(class{constructor(t){this.view=t,this.domAfter=null,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(Qs).map(e=>new Kg(t,e)),this.fixed=!t.state.facet(Ug);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(t){if(this.updateGutters(t)){let e=this.prevViewport,n=t.view.viewport,r=Math.min(e.to,n.to)-Math.max(e.from,n.from);this.syncGutters(r<(n.to-n.from)*.8)}if(t.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(Ug)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let n=ne.iter(this.view.state.facet(da),this.view.viewport.from),r=[],i=this.gutters.map(s=>new $A(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(r.length&&(r=[]),Array.isArray(s.type)){let o=!0;for(let l of s.type)if(l.type==it.Text&&o){Wf(n,r,l.from);for(let a of i)a.line(this.view,l,r);o=!1}else if(l.widget)for(let a of i)a.widget(this.view,l)}else if(s.type==it.Text){Wf(n,r,s.from);for(let o of i)o.line(this.view,s,r)}else if(s.widget)for(let o of i)o.widget(this.view,s);for(let s of i)s.finish();t&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(t){let e=t.startState.facet(Qs),n=t.state.facet(Qs),r=t.docChanged||t.heightChanged||t.viewportChanged||!ne.eq(t.startState.facet(da),t.state.facet(da),t.view.viewport.from,t.view.viewport.to);if(e==n)for(let i of this.gutters)i.update(t)&&(r=!0);else{r=!0;let i=[];for(let s of n){let o=e.indexOf(s);o<0?i.push(new Kg(this.view,s)):(this.gutters[o].update(t),i.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),i.indexOf(s)<0&&s.destroy();for(let s of i)s.config.side=="after"?this.getDOMAfter().appendChild(s.dom):this.dom.appendChild(s.dom);this.gutters=i}return r}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:t=>B.scrollMargins.of(e=>{let n=e.plugin(t);if(!n||n.gutters.length==0||!n.fixed)return null;let r=n.dom.offsetWidth*e.scaleX,i=n.domAfter?n.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==pe.LTR?{left:r,right:i}:{right:r,left:i}})});function $g(t){return Array.isArray(t)?t:[t]}function Wf(t,e,n){for(;t.value&&t.from<=n;)t.from==n&&e.push(t.value),t.next()}class $A{constructor(e,n,r){this.gutter=e,this.height=r,this.i=0,this.cursor=ne.iter(e.markers,n.from)}addElement(e,n,r){let{gutter:i}=this,s=(n.top-this.height)/e.scaleY,o=n.height/e.scaleY;if(this.i==i.elements.length){let l=new Gw(e,o,s,r);i.elements.push(l),i.dom.appendChild(l.dom)}else i.elements[this.i].update(e,o,s,r);this.height=n.bottom,this.i++}line(e,n,r){let i=[];Wf(this.cursor,i,n.from),r.length&&(i=i.concat(r));let s=this.gutter.config.lineMarker(e,n,i);s&&i.unshift(s);let o=this.gutter;i.length==0&&!o.config.renderEmptyElements||this.addElement(e,n,i)}widget(e,n){let r=this.gutter.config.widgetMarker(e,n.widget,n),i=r?[r]:null;for(let s of e.state.facet(WA)){let o=s(e,n.widget,n);o&&(i||(i=[])).push(o)}i&&this.addElement(e,n,i)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let n=e.elements.pop();e.dom.removeChild(n.dom),n.destroy()}}}class Kg{constructor(e,n){this.view=e,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let r in n.domEventHandlers)this.dom.addEventListener(r,i=>{let s=i.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let a=s.getBoundingClientRect();o=(a.top+a.bottom)/2}else o=i.clientY;let l=e.lineBlockAtHeight(o-e.documentTop);n.domEventHandlers[r](e,l,i)&&i.preventDefault()});this.markers=$g(n.markers(e)),n.initialSpacer&&(this.spacer=new Gw(e,0,0,[n.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let n=this.markers;if(this.markers=$g(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let i=this.config.updateSpacer(this.spacer.markers[0],e);i!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[i])}let r=e.view.viewport;return!ne.eq(this.markers,n,r.from,r.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class Gw{constructor(e,n,r,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,n,r,i)}update(e,n,r,i){this.height!=n&&(this.height=n,this.dom.style.height=n+"px"),this.above!=r&&(this.dom.style.marginTop=(this.above=r)?r+"px":""),KA(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,n){let r="cm-gutterElement",i=this.dom.firstChild;for(let s=0,o=0;;){let l=o,a=s<n.length?n[s++]:null,u=!1;if(a){let c=a.elementClass;c&&(r+=" "+c);for(let h=o;h<this.markers.length;h++)if(this.markers[h].compare(a)){l=h,u=!0;break}}else l=this.markers.length;for(;o<l;){let c=this.markers[o++];if(c.toDOM){c.destroy(i);let h=i.nextSibling;i.remove(),i=h}}if(!a)break;a.toDOM&&(u?i=i.nextSibling:this.dom.insertBefore(a.toDOM(e),i)),u&&o++}this.dom.className=r,this.markers=n}destroy(){this.setMarkers(null,[])}}function KA(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].compare(e[n]))return!1;return!0}const qA=I.define(),GA=I.define(),bi=I.define({combine(t){return An(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,n){let r=Object.assign({},e);for(let i in n){let s=r[i],o=n[i];r[i]=s?(l,a,u)=>s(l,a,u)||o(l,a,u):o}return r}})}});class Lc extends Vn{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Bc(t,e){return t.state.facet(bi).formatNumber(e,t.state)}const XA=Qs.compute([bi],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(qA)},lineMarker(e,n,r){return r.some(i=>i.toDOM)?null:new Lc(Bc(e,e.state.doc.lineAt(n.from).number))},widgetMarker:(e,n,r)=>{for(let i of e.state.facet(GA)){let s=i(e,n,r);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(bi)!=e.state.facet(bi),initialSpacer(e){return new Lc(Bc(e,qg(e.state.doc.lines)))},updateSpacer(e,n){let r=Bc(n.view,qg(n.view.state.doc.lines));return r==e.number?e:new Lc(r)},domEventHandlers:t.facet(bi).domEventHandlers,side:"before"}));function YA(t={}){return[bi.of(t),qw(),XA]}function qg(t){let e=9;for(;e<t;)e=e*10+9;return e}const QA=new class extends Vn{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},JA=da.compute(["selection"],t=>{let e=[],n=-1;for(let r of t.selection.ranges){let i=t.doc.lineAt(r.head).from;i>n&&(n=i,e.push(QA.range(i)))}return ne.of(e)});function ZA(){return JA}const eE=1024;let tE=0;class _c{constructor(e,n){this.from=e,this.to=n}}class te{constructor(e={}){this.id=tE++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")}),this.combine=e.combine||null}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Ht.match(e)),n=>{let r=e(n);return r===void 0?null:[this,r]}}}te.closedBy=new te({deserialize:t=>t.split(" ")});te.openedBy=new te({deserialize:t=>t.split(" ")});te.group=new te({deserialize:t=>t.split(" ")});te.isolate=new te({deserialize:t=>{if(t&&t!="rtl"&&t!="ltr"&&t!="auto")throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}});te.contextHash=new te({perNode:!0});te.lookAhead=new te({perNode:!0});te.mounted=new te({perNode:!0});class Ga{constructor(e,n,r){this.tree=e,this.overlay=n,this.parser=r}static get(e){return e&&e.props&&e.props[te.mounted.id]}}const nE=Object.create(null);class Ht{constructor(e,n,r,i=0){this.name=e,this.props=n,this.id=r,this.flags=i}static define(e){let n=e.props&&e.props.length?Object.create(null):nE,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new Ht(e.name||"",n,e.id,r);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");n[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let n=this.prop(te.group);return n?n.indexOf(e)>-1:!1}return this.id==e}static match(e){let n=Object.create(null);for(let r in e)for(let i of r.split(" "))n[i]=e[r];return r=>{for(let i=r.prop(te.group),s=-1;s<(i?i.length:0);s++){let o=n[s<0?r.name:i[s]];if(o)return o}}}}Ht.none=new Ht("",Object.create(null),0,8);const Pl=new WeakMap,Gg=new WeakMap;var Ie;(function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"})(Ie||(Ie={}));class qe{constructor(e,n,r,i,s){if(this.type=e,this.children=n,this.positions=r,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,l]of s)this.props[typeof o=="number"?o:o.id]=l}}toString(){let e=Ga.get(this);if(e&&!e.overlay)return e.tree.toString();let n="";for(let r of this.children){let i=r.toString();i&&(n&&(n+=","),n+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(n.length?"("+n+")":""):n}cursor(e=0){return new Hf(this.topNode,e)}cursorAt(e,n=0,r=0){let i=Pl.get(this)||this.topNode,s=new Hf(i);return s.moveTo(e,n),Pl.set(this,s._tree),s}get topNode(){return new Ft(this,0,0,null)}resolve(e,n=0){let r=Ao(Pl.get(this)||this.topNode,e,n,!1);return Pl.set(this,r),r}resolveInner(e,n=0){let r=Ao(Gg.get(this)||this.topNode,e,n,!0);return Gg.set(this,r),r}resolveStack(e,n=0){return sE(this,e,n)}iterate(e){let{enter:n,leave:r,from:i=0,to:s=this.length}=e,o=e.mode||0,l=(o&Ie.IncludeAnonymous)>0;for(let a=this.cursor(o|Ie.IncludeAnonymous);;){let u=!1;if(a.from<=s&&a.to>=i&&(!l&&a.type.isAnonymous||n(a)!==!1)){if(a.firstChild())continue;u=!0}for(;u&&r&&(l||!a.type.isAnonymous)&&r(a),!a.nextSibling();){if(!a.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let n in this.props)e.push([+n,this.props[n]]);return e}balance(e={}){return this.children.length<=8?this:yp(Ht.none,this.children,this.positions,0,this.children.length,0,this.length,(n,r,i)=>new qe(this.type,n,r,i,this.propValues),e.makeTree||((n,r,i)=>new qe(Ht.none,n,r,i)))}static build(e){return oE(e)}}qe.empty=new qe(Ht.none,[],[],0);class mp{constructor(e,n){this.buffer=e,this.index=n}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new mp(this.buffer,this.index)}}class Sr{constructor(e,n,r){this.buffer=e,this.length=n,this.set=r}get type(){return Ht.none}toString(){let e=[];for(let n=0;n<this.buffer.length;)e.push(this.childString(n)),n=this.buffer[n+3];return e.join(",")}childString(e){let n=this.buffer[e],r=this.buffer[e+3],i=this.set.types[n],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,r==e)return s;let o=[];for(;e<r;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,n,r,i,s){let{buffer:o}=this,l=-1;for(let a=e;a!=n&&!(Xw(s,i,o[a+1],o[a+2])&&(l=a,r>0));a=o[a+3]);return l}slice(e,n,r){let i=this.buffer,s=new Uint16Array(n-e),o=0;for(let l=e,a=0;l<n;){s[a++]=i[l++],s[a++]=i[l++]-r;let u=s[a++]=i[l++]-r;s[a++]=i[l++]-e,o=Math.max(o,u)}return new Sr(s,o,this.set)}}function Xw(t,e,n,r){switch(t){case-2:return n<e;case-1:return r>=e&&n<e;case 0:return n<e&&r>e;case 1:return n<=e&&r>e;case 2:return r>e;case 4:return!0}}function Ao(t,e,n,r){for(var i;t.from==t.to||(n<1?t.from>=e:t.from>e)||(n>-1?t.to<=e:t.to<e);){let o=!r&&t instanceof Ft&&t.index<0?null:t.parent;if(!o)return t;t=o}let s=r?0:Ie.IgnoreOverlays;if(r)for(let o=t,l=o.parent;l;o=l,l=o.parent)o instanceof Ft&&o.index<0&&((i=l.enter(e,n,s))===null||i===void 0?void 0:i.from)!=o.from&&(t=l);for(;;){let o=t.enter(e,n,s);if(!o)return t;t=o}}class Yw{cursor(e=0){return new Hf(this,e)}getChild(e,n=null,r=null){let i=Xg(this,e,n,r);return i.length?i[0]:null}getChildren(e,n=null,r=null){return Xg(this,e,n,r)}resolve(e,n=0){return Ao(this,e,n,!1)}resolveInner(e,n=0){return Ao(this,e,n,!0)}matchContext(e){return Vf(this.parent,e)}enterUnfinishedNodesBefore(e){let n=this.childBefore(e),r=this;for(;n;){let i=n.lastChild;if(!i||i.to!=n.to)break;i.type.isError&&i.from==i.to?(r=n,n=i.prevSibling):n=i}return r}get node(){return this}get next(){return this.parent}}class Ft extends Yw{constructor(e,n,r,i){super(),this._tree=e,this.from=n,this.index=r,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,n,r,i,s=0){for(let o=this;;){for(let{children:l,positions:a}=o._tree,u=n>0?l.length:-1;e!=u;e+=n){let c=l[e],h=a[e]+o.from;if(Xw(i,r,h,h+c.length)){if(c instanceof Sr){if(s&Ie.ExcludeBuffers)continue;let f=c.findChild(0,c.buffer.length,n,r-h,i);if(f>-1)return new or(new rE(o,c,e,h),null,f)}else if(s&Ie.IncludeAnonymous||!c.type.isAnonymous||gp(c)){let f;if(!(s&Ie.IgnoreMounts)&&(f=Ga.get(c))&&!f.overlay)return new Ft(f.tree,h,e,o);let d=new Ft(c,h,e,o);return s&Ie.IncludeAnonymous||!d.type.isAnonymous?d:d.nextChild(n<0?c.children.length-1:0,n,r,i)}}}if(s&Ie.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+n:e=n<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,n,r=0){let i;if(!(r&Ie.IgnoreOverlays)&&(i=Ga.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:o,to:l}of i.overlay)if((n>0?o<=s:o<s)&&(n<0?l>=s:l>s))return new Ft(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,n,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Xg(t,e,n,r){let i=t.cursor(),s=[];if(!i.firstChild())return s;if(n!=null){for(let o=!1;!o;)if(o=i.type.is(n),!i.nextSibling())return s}for(;;){if(r!=null&&i.type.is(r))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return r==null?s:[]}}function Vf(t,e,n=e.length-1){for(let r=t;n>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(e[n]&&e[n]!=r.name)return!1;n--}}return!0}class rE{constructor(e,n,r,i){this.parent=e,this.buffer=n,this.index=r,this.start=i}}class or extends Yw{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,n,r){super(),this.context=e,this._parent=n,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,n,r){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,n-this.context.start,r);return s<0?null:new or(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,n,r=0){if(r&Ie.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],n>0?1:-1,e-this.context.start,n);return s<0?null:new or(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,n=e.buffer[this.index+3];return n<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new or(this.context,this._parent,n):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,n=this._parent?this._parent.index+4:0;return this.index==n?this.externalSibling(-1):new or(this.context,this._parent,e.findChild(n,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],n=[],{buffer:r}=this.context,i=this.index+4,s=r.buffer[this.index+3];if(s>i){let o=r.buffer[this.index+1];e.push(r.slice(i,s,o)),n.push(0)}return new qe(this.type,e,n,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function Qw(t){if(!t.length)return null;let e=0,n=t[0];for(let s=1;s<t.length;s++){let o=t[s];(o.from>n.from||o.to<n.to)&&(n=o,e=s)}let r=n instanceof Ft&&n.index<0?null:n.parent,i=t.slice();return r?i[e]=r:i.splice(e,1),new iE(i,n)}class iE{constructor(e,n){this.heads=e,this.node=n}get next(){return Qw(this.heads)}}function sE(t,e,n){let r=t.resolveInner(e,n),i=null;for(let s=r instanceof Ft?r:r.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(i||(i=[r])).push(o.resolve(e,n)),s=o}else{let o=Ga.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let l=new Ft(o.tree,o.overlay[0].from+s.from,-1,s);(i||(i=[r])).push(Ao(l,e,n,!1))}}return i?Qw(i):r}class Hf{get name(){return this.type.name}constructor(e,n=0){if(this.mode=n,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Ft)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let r=e._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,n){this.index=e;let{start:r,buffer:i}=this.buffer;return this.type=n||i.set.types[i.buffer[e]],this.from=r+i.buffer[e+1],this.to=r+i.buffer[e+2],!0}yield(e){return e?e instanceof Ft?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,n,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,n,r,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,n-this.buffer.start,r);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,n,r=this.mode){return this.buffer?r&Ie.ExcludeBuffers?!1:this.enterChild(1,e,n):this.yield(this._tree.enter(e,n,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Ie.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Ie.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:n}=this.buffer,r=this.stack.length-1;if(e<0){let i=r<0?0:this.stack[r]+4;if(this.index!=i)return this.yieldBuf(n.findChild(i,this.index,-1,0,4))}else{let i=n.buffer[this.index+3];if(i<(r<0?n.buffer.length:n.buffer[this.stack[r]+3]))return this.yieldBuf(i)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let n,r,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:n,parent:r}=i)}else({index:n,_parent:r}=this._tree);for(;r;{index:n,_parent:r}=r)if(n>-1)for(let s=n+e,o=e<0?-1:r._tree.children.length;s!=o;s+=e){let l=r._tree.children[s];if(this.mode&Ie.IncludeAnonymous||l instanceof Sr||!l.type.isAnonymous||gp(l))return!1}return!0}move(e,n){if(n&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,n=0){for(;(this.from==this.to||(n<1?this.from>=e:this.from>e)||(n>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,n););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,n=null,r=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==i){if(i==this.index)return o;n=o,r=s+1;break e}i=this.stack[--s]}for(let i=r;i<this.stack.length;i++)n=new or(this.buffer,n,this.stack[i]);return this.bufferNode=new or(this.buffer,n,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,n){for(let r=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&n&&n(this),i=this.type.isAnonymous,!r)return;if(this.nextSibling())break;this.parent(),r--,i=!0}}}matchContext(e){if(!this.buffer)return Vf(this.node.parent,e);let{buffer:n}=this.buffer,{types:r}=n.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return Vf(this._tree,e,i);let o=r[n.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[i]&&e[i]!=o.name)return!1;i--}}return!0}}function gp(t){return t.children.some(e=>e instanceof Sr||!e.type.isAnonymous||gp(e))}function oE(t){var e;let{buffer:n,nodeSet:r,maxBufferLength:i=eE,reused:s=[],minRepeatType:o=r.types.length}=t,l=Array.isArray(n)?new mp(n,n.length):n,a=r.types,u=0,c=0;function h(k,b,C,E,O,N){let{id:V,start:j,end:D,size:H}=l,Y=c,U=u;if(H<0)if(l.next(),H==-1){let K=s[V];C.push(K),E.push(j-k);return}else if(H==-3){u=V;return}else if(H==-4){c=V;return}else throw new RangeError(`Unrecognized record size: ${H}`);let X=a[V],T,L,z=j-k;if(D-j<=i&&(L=w(l.pos-b,O))){let K=new Uint16Array(L.size-L.skip),q=l.pos-L.size,Je=K.length;for(;l.pos>q;)Je=m(L.start,K,Je);T=new Sr(K,D-L.start,r),z=L.start-k}else{let K=l.pos-H;l.next();let q=[],Je=[],Ze=V>=o?V:-1,on=0,Pt=D;for(;l.pos>K;)Ze>=0&&l.id==Ze&&l.size>=0?(l.end<=Pt-i&&(p(q,Je,j,on,l.end,Pt,Ze,Y,U),on=q.length,Pt=l.end),l.next()):N>2500?f(j,K,q,Je):h(j,K,q,Je,Ze,N+1);if(Ze>=0&&on>0&&on<q.length&&p(q,Je,j,on,j,Pt,Ze,Y,U),q.reverse(),Je.reverse(),Ze>-1&&on>0){let Er=d(X,U);T=yp(X,q,Je,0,q.length,0,D-j,Er,Er)}else T=y(X,q,Je,D-j,Y-D,U)}C.push(T),E.push(z)}function f(k,b,C,E){let O=[],N=0,V=-1;for(;l.pos>b;){let{id:j,start:D,end:H,size:Y}=l;if(Y>4)l.next();else{if(V>-1&&D<V)break;V<0&&(V=H-i),O.push(j,D,H),N++,l.next()}}if(N){let j=new Uint16Array(N*4),D=O[O.length-2];for(let H=O.length-3,Y=0;H>=0;H-=3)j[Y++]=O[H],j[Y++]=O[H+1]-D,j[Y++]=O[H+2]-D,j[Y++]=Y;C.push(new Sr(j,O[2]-D,r)),E.push(D-k)}}function d(k,b){return(C,E,O)=>{let N=0,V=C.length-1,j,D;if(V>=0&&(j=C[V])instanceof qe){if(!V&&j.type==k&&j.length==O)return j;(D=j.prop(te.lookAhead))&&(N=E[V]+j.length+D)}return y(k,C,E,O,N,b)}}function p(k,b,C,E,O,N,V,j,D){let H=[],Y=[];for(;k.length>E;)H.push(k.pop()),Y.push(b.pop()+C-O);k.push(y(r.types[V],H,Y,N-O,j-N,D)),b.push(O-C)}function y(k,b,C,E,O,N,V){if(N){let j=[te.contextHash,N];V=V?[j].concat(V):[j]}if(O>25){let j=[te.lookAhead,O];V=V?[j].concat(V):[j]}return new qe(k,b,C,E,V)}function w(k,b){let C=l.fork(),E=0,O=0,N=0,V=C.end-i,j={size:0,start:0,skip:0};e:for(let D=C.pos-k;C.pos>D;){let H=C.size;if(C.id==b&&H>=0){j.size=E,j.start=O,j.skip=N,N+=4,E+=4,C.next();continue}let Y=C.pos-H;if(H<0||Y<D||C.start<V)break;let U=C.id>=o?4:0,X=C.start;for(C.next();C.pos>Y;){if(C.size<0)if(C.size==-3)U+=4;else break e;else C.id>=o&&(U+=4);C.next()}O=X,E+=H,N+=U}return(b<0||E==k)&&(j.size=E,j.start=O,j.skip=N),j.size>4?j:void 0}function m(k,b,C){let{id:E,start:O,end:N,size:V}=l;if(l.next(),V>=0&&E<o){let j=C;if(V>4){let D=l.pos-(V-4);for(;l.pos>D;)C=m(k,b,C)}b[--C]=j,b[--C]=N-k,b[--C]=O-k,b[--C]=E}else V==-3?u=E:V==-4&&(c=E);return C}let g=[],v=[];for(;l.pos>0;)h(t.start||0,t.bufferStart||0,g,v,-1,0);let x=(e=t.length)!==null&&e!==void 0?e:g.length?v[0]+g[0].length:0;return new qe(a[t.topID],g.reverse(),v.reverse(),x)}const Yg=new WeakMap;function pa(t,e){if(!t.isAnonymous||e instanceof Sr||e.type!=t)return 1;let n=Yg.get(e);if(n==null){n=1;for(let r of e.children){if(r.type!=t||!(r instanceof qe)){n=1;break}n+=pa(t,r)}Yg.set(e,n)}return n}function yp(t,e,n,r,i,s,o,l,a){let u=0;for(let p=r;p<i;p++)u+=pa(t,e[p]);let c=Math.ceil(u*1.5/8),h=[],f=[];function d(p,y,w,m,g){for(let v=w;v<m;){let x=v,k=y[v],b=pa(t,p[v]);for(v++;v<m;v++){let C=pa(t,p[v]);if(b+C>=c)break;b+=C}if(v==x+1){if(b>c){let C=p[x];d(C.children,C.positions,0,C.children.length,y[x]+g);continue}h.push(p[x])}else{let C=y[v-1]+p[v-1].length-k;h.push(yp(t,p,y,x,v,k,C,null,a))}f.push(k+g-s)}}return d(e,n,r,i,0),(l||a)(h,f,o)}class Wr{constructor(e,n,r,i,s=!1,o=!1){this.from=e,this.to=n,this.tree=r,this.offset=i,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,n=[],r=!1){let i=[new Wr(0,e.length,e,0,!1,r)];for(let s of n)s.to>e.length&&i.push(s);return i}static applyChanges(e,n,r=128){if(!n.length)return e;let i=[],s=1,o=e.length?e[0]:null;for(let l=0,a=0,u=0;;l++){let c=l<n.length?n[l]:null,h=c?c.fromA:1e9;if(h-a>=r)for(;o&&o.from<h;){let f=o;if(a>=f.from||h<=f.to||u){let d=Math.max(f.from,a)-u,p=Math.min(f.to,h)-u;f=d>=p?null:new Wr(d,p,f.tree,f.offset+u,l>0,!!c)}if(f&&i.push(f),o.to>h)break;o=s<e.length?e[s++]:null}if(!c)break;a=c.toA,u=c.toA-c.toB}return i}}class lE{startParse(e,n,r){return typeof e=="string"&&(e=new aE(e)),r=r?r.length?r.map(i=>new _c(i.from,i.to)):[new _c(0,0)]:[new _c(0,e.length)],this.createParse(e,n||[],r)}parse(e,n,r){let i=this.startParse(e,n,r);for(;;){let s=i.advance();if(s)return s}}}class aE{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,n){return this.string.slice(e,n)}}new te({perNode:!0});let uE=0;class Nt{constructor(e,n,r,i){this.name=e,this.set=n,this.base=r,this.modified=i,this.id=uE++}toString(){let{name:e}=this;for(let n of this.modified)n.name&&(e=`${n.name}(${e})`);return e}static define(e,n){let r=typeof e=="string"?e:"?";if(e instanceof Nt&&(n=e),n!=null&&n.base)throw new Error("Can not derive from a modified tag");let i=new Nt(r,[],null,[]);if(i.set.push(i),n)for(let s of n.set)i.set.push(s);return i}static defineModifier(e){let n=new Xa(e);return r=>r.modified.indexOf(n)>-1?r:Xa.get(r.base||r,r.modified.concat(n).sort((i,s)=>i.id-s.id))}}let cE=0;class Xa{constructor(e){this.name=e,this.instances=[],this.id=cE++}static get(e,n){if(!n.length)return e;let r=n[0].instances.find(l=>l.base==e&&hE(n,l.modified));if(r)return r;let i=[],s=new Nt(e.name,i,e,n);for(let l of n)l.instances.push(s);let o=fE(n);for(let l of e.set)if(!l.modified.length)for(let a of o)i.push(Xa.get(l,a));return s}}function hE(t,e){return t.length==e.length&&t.every((n,r)=>n==e[r])}function fE(t){let e=[[]];for(let n=0;n<t.length;n++)for(let r=0,i=e.length;r<i;r++)e.push(e[r].concat(t[n]));return e.sort((n,r)=>r.length-n.length)}function dE(t){let e=Object.create(null);for(let n in t){let r=t[n];Array.isArray(r)||(r=[r]);for(let i of n.split(" "))if(i){let s=[],o=2,l=i;for(let h=0;;){if(l=="..."&&h>0&&h+3==i.length){o=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!f)throw new RangeError("Invalid path: "+i);if(s.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),h+=f[0].length,h==i.length)break;let d=i[h++];if(h==i.length&&d=="!"){o=0;break}if(d!="/")throw new RangeError("Invalid path: "+i);l=i.slice(h)}let a=s.length-1,u=s[a];if(!u)throw new RangeError("Invalid path: "+i);let c=new Eo(r,o,a>0?s.slice(0,a):null);e[u]=c.sort(e[u])}}return Jw.add(e)}const Jw=new te({combine(t,e){let n,r,i;for(;t||e;){if(!t||e&&t.depth>=e.depth?(i=e,e=e.next):(i=t,t=t.next),n&&n.mode==i.mode&&!i.context&&!n.context)continue;let s=new Eo(i.tags,i.mode,i.context);n?n.next=s:r=s,n=s}return r}});class Eo{constructor(e,n,r,i){this.tags=e,this.mode=n,this.context=r,this.next=i}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Eo.empty=new Eo([],2,null);function Zw(t,e){let n=Object.create(null);for(let s of t)if(!Array.isArray(s.tag))n[s.tag.id]=s.class;else for(let o of s.tag)n[o.id]=s.class;let{scope:r,all:i=null}=e||{};return{style:s=>{let o=i;for(let l of s)for(let a of l.set){let u=n[a.id];if(u){o=o?o+" "+u:u;break}}return o},scope:r}}function pE(t,e){let n=null;for(let r of t){let i=r.style(e);i&&(n=n?n+" "+i:i)}return n}function mE(t,e,n,r=0,i=t.length){let s=new gE(r,Array.isArray(e)?e:[e],n);s.highlightRange(t.cursor(),r,i,"",s.highlighters),s.flush(i)}class gE{constructor(e,n,r){this.at=e,this.highlighters=n,this.span=r,this.class=""}startSpan(e,n){n!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=n)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,n,r,i,s){let{type:o,from:l,to:a}=e;if(l>=r||a<=n)return;o.isTop&&(s=this.highlighters.filter(d=>!d.scope||d.scope(o)));let u=i,c=yE(e)||Eo.empty,h=pE(s,c.tags);if(h&&(u&&(u+=" "),u+=h,c.mode==1&&(i+=(i?" ":"")+h)),this.startSpan(Math.max(n,l),u),c.opaque)return;let f=e.tree&&e.tree.prop(te.mounted);if(f&&f.overlay){let d=e.node.enter(f.overlay[0].from+l,1),p=this.highlighters.filter(w=>!w.scope||w.scope(f.tree.type)),y=e.firstChild();for(let w=0,m=l;;w++){let g=w<f.overlay.length?f.overlay[w]:null,v=g?g.from+l:a,x=Math.max(n,m),k=Math.min(r,v);if(x<k&&y)for(;e.from<k&&(this.highlightRange(e,x,k,i,s),this.startSpan(Math.min(k,e.to),u),!(e.to>=v||!e.nextSibling())););if(!g||v>r)break;m=g.to+l,m>n&&(this.highlightRange(d.cursor(),Math.max(n,g.from+l),Math.min(r,m),"",p),this.startSpan(Math.min(r,m),u))}y&&e.parent()}else if(e.firstChild()){f&&(i="");do if(!(e.to<=n)){if(e.from>=r)break;this.highlightRange(e,n,r,i,s),this.startSpan(Math.min(r,e.to),u)}while(e.nextSibling());e.parent()}}}function yE(t){let e=t.type.prop(Jw);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}const R=Nt.define,Dl=R(),Yn=R(),Qg=R(Yn),Jg=R(Yn),Qn=R(),Tl=R(Qn),Ic=R(Qn),hn=R(),Pr=R(hn),un=R(),cn=R(),Uf=R(),ys=R(Uf),Ol=R(),M={comment:Dl,lineComment:R(Dl),blockComment:R(Dl),docComment:R(Dl),name:Yn,variableName:R(Yn),typeName:Qg,tagName:R(Qg),propertyName:Jg,attributeName:R(Jg),className:R(Yn),labelName:R(Yn),namespace:R(Yn),macroName:R(Yn),literal:Qn,string:Tl,docString:R(Tl),character:R(Tl),attributeValue:R(Tl),number:Ic,integer:R(Ic),float:R(Ic),bool:R(Qn),regexp:R(Qn),escape:R(Qn),color:R(Qn),url:R(Qn),keyword:un,self:R(un),null:R(un),atom:R(un),unit:R(un),modifier:R(un),operatorKeyword:R(un),controlKeyword:R(un),definitionKeyword:R(un),moduleKeyword:R(un),operator:cn,derefOperator:R(cn),arithmeticOperator:R(cn),logicOperator:R(cn),bitwiseOperator:R(cn),compareOperator:R(cn),updateOperator:R(cn),definitionOperator:R(cn),typeOperator:R(cn),controlOperator:R(cn),punctuation:Uf,separator:R(Uf),bracket:ys,angleBracket:R(ys),squareBracket:R(ys),paren:R(ys),brace:R(ys),content:hn,heading:Pr,heading1:R(Pr),heading2:R(Pr),heading3:R(Pr),heading4:R(Pr),heading5:R(Pr),heading6:R(Pr),contentSeparator:R(hn),list:R(hn),quote:R(hn),emphasis:R(hn),strong:R(hn),link:R(hn),monospace:R(hn),strikethrough:R(hn),inserted:R(),deleted:R(),changed:R(),invalid:R(),meta:Ol,documentMeta:R(Ol),annotation:R(Ol),processingInstruction:R(Ol),definition:Nt.defineModifier("definition"),constant:Nt.defineModifier("constant"),function:Nt.defineModifier("function"),standard:Nt.defineModifier("standard"),local:Nt.defineModifier("local"),special:Nt.defineModifier("special")};for(let t in M){let e=M[t];e instanceof Nt&&(e.name=t)}Zw([{tag:M.link,class:"tok-link"},{tag:M.heading,class:"tok-heading"},{tag:M.emphasis,class:"tok-emphasis"},{tag:M.strong,class:"tok-strong"},{tag:M.keyword,class:"tok-keyword"},{tag:M.atom,class:"tok-atom"},{tag:M.bool,class:"tok-bool"},{tag:M.url,class:"tok-url"},{tag:M.labelName,class:"tok-labelName"},{tag:M.inserted,class:"tok-inserted"},{tag:M.deleted,class:"tok-deleted"},{tag:M.literal,class:"tok-literal"},{tag:M.string,class:"tok-string"},{tag:M.number,class:"tok-number"},{tag:[M.regexp,M.escape,M.special(M.string)],class:"tok-string2"},{tag:M.variableName,class:"tok-variableName"},{tag:M.local(M.variableName),class:"tok-variableName tok-local"},{tag:M.definition(M.variableName),class:"tok-variableName tok-definition"},{tag:M.special(M.variableName),class:"tok-variableName2"},{tag:M.definition(M.propertyName),class:"tok-propertyName tok-definition"},{tag:M.typeName,class:"tok-typeName"},{tag:M.namespace,class:"tok-namespace"},{tag:M.className,class:"tok-className"},{tag:M.macroName,class:"tok-macroName"},{tag:M.propertyName,class:"tok-propertyName"},{tag:M.operator,class:"tok-operator"},{tag:M.comment,class:"tok-comment"},{tag:M.meta,class:"tok-meta"},{tag:M.invalid,class:"tok-invalid"},{tag:M.punctuation,class:"tok-punctuation"}]);var jc;const _s=new te,vE=new te;class yn{constructor(e,n,r=[],i=""){this.data=e,this.name=i,ee.prototype.hasOwnProperty("tree")||Object.defineProperty(ee.prototype,"tree",{get(){return Xe(this)}}),this.parser=n,this.extension=[kr.of(this),ee.languageData.of((s,o,l)=>{let a=Zg(s,o,l),u=a.type.prop(_s);if(!u)return[];let c=s.facet(u),h=a.type.prop(vE);if(h){let f=a.resolve(o-a.from,l);for(let d of h)if(d.test(f,s)){let p=s.facet(d.facet);return d.type=="replace"?p:p.concat(c)}}return c})].concat(r)}isActiveAt(e,n,r=-1){return Zg(e,n,r).type.prop(_s)==this.data}findRegions(e){let n=e.facet(kr);if((n==null?void 0:n.data)==this.data)return[{from:0,to:e.doc.length}];if(!n||!n.allowsNesting)return[];let r=[],i=(s,o)=>{if(s.prop(_s)==this.data){r.push({from:o,to:o+s.length});return}let l=s.prop(te.mounted);if(l){if(l.tree.prop(_s)==this.data){if(l.overlay)for(let a of l.overlay)r.push({from:a.from+o,to:a.to+o});else r.push({from:o,to:o+s.length});return}else if(l.overlay){let a=r.length;if(i(l.tree,l.overlay[0].from+o),r.length>a)return}}for(let a=0;a<s.children.length;a++){let u=s.children[a];u instanceof qe&&i(u,s.positions[a]+o)}};return i(Xe(e),0),r}get allowsNesting(){return!0}}yn.setState=G.define();function Zg(t,e,n){let r=t.facet(kr),i=Xe(t).topNode;if(!r||r.allowsNesting)for(let s=i;s;s=s.enter(e,n,Ie.ExcludeBuffers))s.type.isTop&&(i=s);return i}function Xe(t){let e=t.field(yn.state,!1);return e?e.tree:qe.empty}class wE{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,n){let r=this.cursorPos-this.string.length;return e<r||n>=this.cursorPos?this.doc.sliceString(e,n):this.string.slice(e-r,n-r)}}let vs=null;class Ya{constructor(e,n,r=[],i,s,o,l,a){this.parser=e,this.state=n,this.fragments=r,this.tree=i,this.treeLen=s,this.viewport=o,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,n,r){return new Ya(e,n,[],qe.empty,0,r,[],null)}startParse(){return this.parser.startParse(new wE(this.state.doc),this.fragments)}work(e,n){return n!=null&&n>=this.state.doc.length&&(n=void 0),this.tree!=qe.empty&&this.isDone(n??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),n!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>n)&&n<this.state.doc.length&&this.parse.stopAt(n);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(Wr.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(n??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,n;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(n=this.parse.advance()););}),this.treeLen=e,this.tree=n,this.fragments=this.withoutTempSkipped(Wr.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let n=vs;vs=this;try{return e()}finally{vs=n}}withoutTempSkipped(e){for(let n;n=this.tempSkipped.pop();)e=e0(e,n.from,n.to);return e}changes(e,n){let{fragments:r,tree:i,treeLen:s,viewport:o,skipped:l}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((u,c,h,f)=>a.push({fromA:u,toA:c,fromB:h,toB:f})),r=Wr.applyChanges(r,a),i=qe.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){l=[];for(let u of this.skipped){let c=e.mapPos(u.from,1),h=e.mapPos(u.to,-1);c<h&&l.push({from:c,to:h})}}}return new Ya(this.parser,n,r,i,s,o,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let n=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:i,to:s}=this.skipped[r];i<e.to&&s>e.from&&(this.fragments=e0(this.fragments,i,s),this.skipped.splice(r--,1))}return this.skipped.length>=n?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,n){this.skipped.push({from:e,to:n})}static getSkippingParser(e){return new class extends lE{createParse(n,r,i){let s=i[0].from,o=i[i.length-1].to;return{parsedPos:s,advance(){let a=vs;if(a){for(let u of i)a.tempSkipped.push(u);e&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,e]):e)}return this.parsedPos=o,new qe(Ht.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let n=this.fragments;return this.treeLen>=e&&n.length&&n[0].from==0&&n[0].to>=e}static get(){return vs}}function e0(t,e,n){return Wr.applyChanges(t,[{fromA:e,toA:n,fromB:e,toB:n}])}class Qi{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let n=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),n.viewport.to);return n.work(20,r)||n.takeTree(),new Qi(n)}static init(e){let n=Math.min(3e3,e.doc.length),r=Ya.create(e.facet(kr).parser,e,{from:0,to:n});return r.work(20,n)||r.takeTree(),new Qi(r)}}yn.state=We.define({create:Qi.init,update(t,e){for(let n of e.effects)if(n.is(yn.setState))return n.value;return e.startState.facet(kr)!=e.state.facet(kr)?Qi.init(e.state):t.apply(e)}});let ex=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(ex=t=>{let e=-1,n=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(n):cancelIdleCallback(e)});const Fc=typeof navigator<"u"&&(!((jc=navigator.scheduling)===null||jc===void 0)&&jc.isInputPending)?()=>navigator.scheduling.isInputPending():null,xE=Ce.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let n=this.view.state.field(yn.state).context;(n.updateViewport(e.view.viewport)||this.view.viewport.to>n.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(n)}scheduleWork(){if(this.working)return;let{state:e}=this.view,n=e.field(yn.state);(n.tree!=n.context.tree||!n.context.isDone(e.doc.length))&&(this.working=ex(this.work))}work(e){this.working=null;let n=Date.now();if(this.chunkEnd<n&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=n+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:i}}=this.view,s=r.field(yn.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Fc?Math.max(25,e.timeRemaining()-5):1e9),l=s.context.treeLen<i&&r.doc.length>i+1e3,a=s.context.work(()=>Fc&&Fc()||Date.now()>o,i+(l?0:1e5));this.chunkBudget-=Date.now()-n,(a||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:yn.setState.of(new Qi(s.context))})),this.chunkBudget>0&&!(a&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(n=>pt(this.view.state,n)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),kr=I.define({combine(t){return t.length?t[0]:null},enables:t=>[yn.state,xE,B.contentAttributes.compute([t],e=>{let n=e.facet(t);return n&&n.name?{"data-language":n.name}:{}})]}),SE=I.define(),Iu=I.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(n=>n!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function Qa(t){let e=t.facet(Iu);return e.charCodeAt(0)==9?t.tabSize*e.length:e.length}function Po(t,e){let n="",r=t.tabSize,i=t.facet(Iu)[0];if(i=="	"){for(;e>=r;)n+="	",e-=r;i=" "}for(let s=0;s<e;s++)n+=i;return n}function vp(t,e){t instanceof ee&&(t=new ju(t));for(let r of t.state.facet(SE)){let i=r(t,e);if(i!==void 0)return i}let n=Xe(t.state);return n.length>=e?bE(t,n,e):null}class ju{constructor(e,n={}){this.state=e,this.options=n,this.unit=Qa(e)}lineAt(e,n=1){let r=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:s}=this.options;return i!=null&&i>=r.from&&i<=r.to?s&&i==e?{text:"",from:e}:(n<0?i<e:i<=e)?{text:r.text.slice(i-r.from),from:i}:{text:r.text.slice(0,i-r.from),from:r.from}:r}textAfterPos(e,n=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:r,from:i}=this.lineAt(e,n);return r.slice(e-i,Math.min(r.length,e+100-i))}column(e,n=1){let{text:r,from:i}=this.lineAt(e,n),s=this.countColumn(r,e-i),o=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return o>-1&&(s+=o-this.countColumn(r,r.search(/\S|$/))),s}countColumn(e,n=e.length){return rs(e,this.state.tabSize,n)}lineIndent(e,n=1){let{text:r,from:i}=this.lineAt(e,n),s=this.options.overrideIndentation;if(s){let o=s(i);if(o>-1)return o}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const kE=new te;function bE(t,e,n){let r=e.resolveStack(n),i=e.resolveInner(n,-1).resolve(n,0).enterUnfinishedNodesBefore(n);if(i!=r.node){let s=[];for(let o=i;o&&!(o.from<r.node.from||o.to>r.node.to||o.from==r.node.from&&o.type==r.node.type);o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)r={node:s[o],next:r}}return tx(r,t,n)}function tx(t,e,n){for(let r=t;r;r=r.next){let i=ME(r.node);if(i)return i(wp.create(e,n,r))}return 0}function CE(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function ME(t){let e=t.type.prop(kE);if(e)return e;let n=t.firstChild,r;if(n&&(r=n.type.prop(te.closedBy))){let i=t.lastChild,s=i&&r.indexOf(i.name)>-1;return o=>DE(o,!0,1,void 0,s&&!CE(o)?i.from:void 0)}return t.parent==null?AE:null}function AE(){return 0}class wp extends ju{constructor(e,n,r){super(e.state,e.options),this.base=e,this.pos=n,this.context=r}get node(){return this.context.node}static create(e,n,r){return new wp(e,n,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let n=this.state.doc.lineAt(e.from);for(;;){let r=e.resolve(n.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(EE(r,e))break;n=this.state.doc.lineAt(r.from)}return this.lineIndent(n.from)}continue(){return tx(this.context.next,this.base,this.pos)}}function EE(t,e){for(let n=e;n;n=n.parent)if(t==n)return!0;return!1}function PE(t){let e=t.node,n=e.childAfter(e.from),r=e.lastChild;if(!n)return null;let i=t.options.simulateBreak,s=t.state.doc.lineAt(n.from),o=i==null||i<=s.from?s.to:Math.min(s.to,i);for(let l=n.to;;){let a=e.childAfter(l);if(!a||a==r)return null;if(!a.type.isSkipped){if(a.from>=o)return null;let u=/^ */.exec(s.text.slice(n.to-s.from))[0].length;return{from:n.from,to:n.to+u}}l=a.to}}function DE(t,e,n,r,i){let s=t.textAfter,o=s.match(/^\s*/)[0].length,l=r&&s.slice(o,o+r.length)==r||i==t.pos+o,a=PE(t);return a?l?t.column(a.from):t.column(a.to):t.baseIndent+(l?0:t.unit*n)}const TE=200;function OE(){return ee.transactionFilter.of(t=>{if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;let e=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head);if(!e.length)return t;let n=t.newDoc,{head:r}=t.newSelection.main,i=n.lineAt(r);if(r>i.from+TE)return t;let s=n.sliceString(i.from,r);if(!e.some(u=>u.test(s)))return t;let{state:o}=t,l=-1,a=[];for(let{head:u}of o.selection.ranges){let c=o.doc.lineAt(u);if(c.from==l)continue;l=c.from;let h=vp(o,c.from);if(h==null)continue;let f=/^\s*/.exec(c.text)[0],d=Po(o,h);f!=d&&a.push({from:c.from,to:c.from+f.length,insert:d})}return a.length?[t,{changes:a,sequential:!0}]:t})}const RE=I.define(),NE=new te;function LE(t,e,n){let r=Xe(t);if(r.length<n)return null;let i=r.resolveStack(n,1),s=null;for(let o=i;o;o=o.next){let l=o.node;if(l.to<=n||l.from>n)continue;if(s&&l.from<e)break;let a=l.type.prop(NE);if(a&&(l.to<r.length-50||r.length==t.doc.length||!BE(l))){let u=a(l,t);u&&u.from<=n&&u.from>=e&&u.to>n&&(s=u)}}return s}function BE(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function Ja(t,e,n){for(let r of t.facet(RE)){let i=r(t,e,n);if(i)return i}return LE(t,e,n)}function nx(t,e){let n=e.mapPos(t.from,1),r=e.mapPos(t.to,-1);return n>=r?void 0:{from:n,to:r}}const Fu=G.define({map:nx}),Uo=G.define({map:nx});function rx(t){let e=[];for(let{head:n}of t.state.selection.ranges)e.some(r=>r.from<=n&&r.to>=n)||e.push(t.lineBlockAt(n));return e}const Jr=We.define({create(){return $.none},update(t,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((n,r)=>t=t0(t,n,r)),t=t.map(e.changes);for(let n of e.effects)if(n.is(Fu)&&!_E(t,n.value.from,n.value.to)){let{preparePlaceholder:r}=e.state.facet(ox),i=r?$.replace({widget:new HE(r(e.state,n.value))}):n0;t=t.update({add:[i.range(n.value.from,n.value.to)]})}else n.is(Uo)&&(t=t.update({filter:(r,i)=>n.value.from!=r||n.value.to!=i,filterFrom:n.value.from,filterTo:n.value.to}));return e.selection&&(t=t0(t,e.selection.main.head)),t},provide:t=>B.decorations.from(t),toJSON(t,e){let n=[];return t.between(0,e.doc.length,(r,i)=>{n.push(r,i)}),n},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let n=0;n<t.length;){let r=t[n++],i=t[n++];if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid JSON for fold state");e.push(n0.range(r,i))}return $.set(e,!0)}});function t0(t,e,n=e){let r=!1;return t.between(e,n,(i,s)=>{i<n&&s>e&&(r=!0)}),r?t.update({filterFrom:e,filterTo:n,filter:(i,s)=>i>=n||s<=e}):t}function Za(t,e,n){var r;let i=null;return(r=t.field(Jr,!1))===null||r===void 0||r.between(e,n,(s,o)=>{(!i||i.from>s)&&(i={from:s,to:o})}),i}function _E(t,e,n){let r=!1;return t.between(e,e,(i,s)=>{i==e&&s==n&&(r=!0)}),r}function ix(t,e){return t.field(Jr,!1)?e:e.concat(G.appendConfig.of(lx()))}const IE=t=>{for(let e of rx(t)){let n=Ja(t.state,e.from,e.to);if(n)return t.dispatch({effects:ix(t.state,[Fu.of(n),sx(t,n)])}),!0}return!1},jE=t=>{if(!t.state.field(Jr,!1))return!1;let e=[];for(let n of rx(t)){let r=Za(t.state,n.from,n.to);r&&e.push(Uo.of(r),sx(t,r,!1))}return e.length&&t.dispatch({effects:e}),e.length>0};function sx(t,e,n=!0){let r=t.state.doc.lineAt(e.from).number,i=t.state.doc.lineAt(e.to).number;return B.announce.of(`${t.state.phrase(n?"Folded lines":"Unfolded lines")} ${r} ${t.state.phrase("to")} ${i}.`)}const FE=t=>{let{state:e}=t,n=[];for(let r=0;r<e.doc.length;){let i=t.lineBlockAt(r),s=Ja(e,i.from,i.to);s&&n.push(Fu.of(s)),r=(s?t.lineBlockAt(s.to):i).to+1}return n.length&&t.dispatch({effects:ix(t.state,n)}),!!n.length},zE=t=>{let e=t.state.field(Jr,!1);if(!e||!e.size)return!1;let n=[];return e.between(0,t.state.doc.length,(r,i)=>{n.push(Uo.of({from:r,to:i}))}),t.dispatch({effects:n}),!0},WE=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:IE},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:jE},{key:"Ctrl-Alt-[",run:FE},{key:"Ctrl-Alt-]",run:zE}],VE={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},ox=I.define({combine(t){return An(t,VE)}});function lx(t){return[Jr,KE]}function ax(t,e){let{state:n}=t,r=n.facet(ox),i=o=>{let l=t.lineBlockAt(t.posAtDOM(o.target)),a=Za(t.state,l.from,l.to);a&&t.dispatch({effects:Uo.of(a)}),o.preventDefault()};if(r.placeholderDOM)return r.placeholderDOM(t,i,e);let s=document.createElement("span");return s.textContent=r.placeholderText,s.setAttribute("aria-label",n.phrase("folded code")),s.title=n.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=i,s}const n0=$.replace({widget:new class extends Un{toDOM(t){return ax(t,null)}}});class HE extends Un{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return ax(e,this.value)}}const UE={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class zc extends Vn{constructor(e,n){super(),this.config=e,this.open=n}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let n=document.createElement("span");return n.textContent=this.open?this.config.openText:this.config.closedText,n.title=e.state.phrase(this.open?"Fold line":"Unfold line"),n}}function $E(t={}){let e={...UE,...t},n=new zc(e,!0),r=new zc(e,!1),i=Ce.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(kr)!=o.state.facet(kr)||o.startState.field(Jr,!1)!=o.state.field(Jr,!1)||Xe(o.startState)!=Xe(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let l=new zn;for(let a of o.viewportLineBlocks){let u=Za(o.state,a.from,a.to)?r:Ja(o.state,a.from,a.to)?n:null;u&&l.add(a.from,a.from,u)}return l.finish()}}),{domEventHandlers:s}=e;return[i,HA({class:"cm-foldGutter",markers(o){var l;return((l=o.plugin(i))===null||l===void 0?void 0:l.markers)||ne.empty},initialSpacer(){return new zc(e,!1)},domEventHandlers:{...s,click:(o,l,a)=>{if(s.click&&s.click(o,l,a))return!0;let u=Za(o.state,l.from,l.to);if(u)return o.dispatch({effects:Uo.of(u)}),!0;let c=Ja(o.state,l.from,l.to);return c?(o.dispatch({effects:Fu.of(c)}),!0):!1}}}),lx()]}const KE=B.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class $o{constructor(e,n){this.specs=e;let r;function i(l){let a=vr.newName();return(r||(r=Object.create(null)))["."+a]=l,a}const s=typeof n.all=="string"?n.all:n.all?i(n.all):void 0,o=n.scope;this.scope=o instanceof yn?l=>l.prop(_s)==o.data:o?l=>l==o:void 0,this.style=Zw(e.map(l=>({tag:l.tag,class:l.class||i(Object.assign({},l,{tag:null}))})),{all:s}).style,this.module=r?new vr(r):null,this.themeType=n.themeType}static define(e,n){return new $o(e,n||{})}}const $f=I.define(),ux=I.define({combine(t){return t.length?[t[0]]:null}});function Wc(t){let e=t.facet($f);return e.length?e:t.facet(ux)}function cx(t,e){let n=[GE],r;return t instanceof $o&&(t.module&&n.push(B.styleModule.of(t.module)),r=t.themeType),e!=null&&e.fallback?n.push(ux.of(t)):r?n.push($f.computeN([B.darkTheme],i=>i.facet(B.darkTheme)==(r=="dark")?[t]:[])):n.push($f.of(t)),n}class qE{constructor(e){this.markCache=Object.create(null),this.tree=Xe(e.state),this.decorations=this.buildDeco(e,Wc(e.state)),this.decoratedTo=e.viewport.to}update(e){let n=Xe(e.state),r=Wc(e.state),i=r!=Wc(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);n.length<s.to&&!i&&n.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(n!=this.tree||e.viewportChanged||i)&&(this.tree=n,this.decorations=this.buildDeco(e.view,r),this.decoratedTo=s.to)}buildDeco(e,n){if(!n||!this.tree.length)return $.none;let r=new zn;for(let{from:i,to:s}of e.visibleRanges)mE(this.tree,n,(o,l,a)=>{r.add(o,l,this.markCache[a]||(this.markCache[a]=$.mark({class:a})))},i,s);return r.finish()}}const GE=ni.high(Ce.fromClass(qE,{decorations:t=>t.decorations})),XE=$o.define([{tag:M.meta,color:"#404740"},{tag:M.link,textDecoration:"underline"},{tag:M.heading,textDecoration:"underline",fontWeight:"bold"},{tag:M.emphasis,fontStyle:"italic"},{tag:M.strong,fontWeight:"bold"},{tag:M.strikethrough,textDecoration:"line-through"},{tag:M.keyword,color:"#708"},{tag:[M.atom,M.bool,M.url,M.contentSeparator,M.labelName],color:"#219"},{tag:[M.literal,M.inserted],color:"#164"},{tag:[M.string,M.deleted],color:"#a11"},{tag:[M.regexp,M.escape,M.special(M.string)],color:"#e40"},{tag:M.definition(M.variableName),color:"#00f"},{tag:M.local(M.variableName),color:"#30a"},{tag:[M.typeName,M.namespace],color:"#085"},{tag:M.className,color:"#167"},{tag:[M.special(M.variableName),M.macroName],color:"#256"},{tag:M.definition(M.propertyName),color:"#00c"},{tag:M.comment,color:"#940"},{tag:M.invalid,color:"#f00"}]),YE=B.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),hx=1e4,fx="()[]{}",dx=I.define({combine(t){return An(t,{afterCursor:!0,brackets:fx,maxScanDistance:hx,renderMatch:ZE})}}),QE=$.mark({class:"cm-matchingBracket"}),JE=$.mark({class:"cm-nonmatchingBracket"});function ZE(t){let e=[],n=t.matched?QE:JE;return e.push(n.range(t.start.from,t.start.to)),t.end&&e.push(n.range(t.end.from,t.end.to)),e}const eP=We.define({create(){return $.none},update(t,e){if(!e.docChanged&&!e.selection)return t;let n=[],r=e.state.facet(dx);for(let i of e.state.selection.ranges){if(!i.empty)continue;let s=vn(e.state,i.head,-1,r)||i.head>0&&vn(e.state,i.head-1,1,r)||r.afterCursor&&(vn(e.state,i.head,1,r)||i.head<e.state.doc.length&&vn(e.state,i.head+1,-1,r));s&&(n=n.concat(r.renderMatch(s,e.state)))}return $.set(n,!0)},provide:t=>B.decorations.from(t)}),tP=[eP,YE];function nP(t={}){return[dx.of(t),tP]}const rP=new te;function Kf(t,e,n){let r=t.prop(e<0?te.openedBy:te.closedBy);if(r)return r;if(t.name.length==1){let i=n.indexOf(t.name);if(i>-1&&i%2==(e<0?1:0))return[n[i+e]]}return null}function qf(t){let e=t.type.prop(rP);return e?e(t.node):t}function vn(t,e,n,r={}){let i=r.maxScanDistance||hx,s=r.brackets||fx,o=Xe(t),l=o.resolveInner(e,n);for(let a=l;a;a=a.parent){let u=Kf(a.type,n,s);if(u&&a.from<a.to){let c=qf(a);if(c&&(n>0?e>=c.from&&e<c.to:e>c.from&&e<=c.to))return iP(t,e,n,a,c,u,s)}}return sP(t,e,n,o,l.type,i,s)}function iP(t,e,n,r,i,s,o){let l=r.parent,a={from:i.from,to:i.to},u=0,c=l==null?void 0:l.cursor();if(c&&(n<0?c.childBefore(r.from):c.childAfter(r.to)))do if(n<0?c.to<=r.from:c.from>=r.to){if(u==0&&s.indexOf(c.type.name)>-1&&c.from<c.to){let h=qf(c);return{start:a,end:h?{from:h.from,to:h.to}:void 0,matched:!0}}else if(Kf(c.type,n,o))u++;else if(Kf(c.type,-n,o)){if(u==0){let h=qf(c);return{start:a,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}u--}}while(n<0?c.prevSibling():c.nextSibling());return{start:a,matched:!1}}function sP(t,e,n,r,i,s,o){let l=n<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=n>0)return null;let u={from:n<0?e-1:e,to:n>0?e+1:e},c=t.doc.iterRange(e,n>0?t.doc.length:0),h=0;for(let f=0;!c.next().done&&f<=s;){let d=c.value;n<0&&(f+=d.length);let p=e+f*n;for(let y=n>0?0:d.length-1,w=n>0?d.length:-1;y!=w;y+=n){let m=o.indexOf(d[y]);if(!(m<0||r.resolveInner(p+y,1).type!=i))if(m%2==0==n>0)h++;else{if(h==1)return{start:u,end:{from:p+y,to:p+y+1},matched:m>>1==a>>1};h--}}n>0&&(f+=d.length)}return c.done?{start:u,matched:!1}:null}const oP=Object.create(null),r0=[Ht.none],i0=[],s0=Object.create(null),lP=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])lP[t]=aP(oP,e);function Vc(t,e){i0.indexOf(t)>-1||(i0.push(t),console.warn(e))}function aP(t,e){let n=[];for(let l of e.split(" ")){let a=[];for(let u of l.split(".")){let c=t[u]||M[u];c?typeof c=="function"?a.length?a=a.map(c):Vc(u,`Modifier ${u} used at start of tag`):a.length?Vc(u,`Tag ${u} used as modifier`):a=Array.isArray(c)?c:[c]:Vc(u,`Unknown highlighting tag ${u}`)}for(let u of a)n.push(u)}if(!n.length)return 0;let r=e.replace(/ /g,"_"),i=r+" "+n.map(l=>l.id),s=s0[i];if(s)return s.id;let o=s0[i]=Ht.define({id:r0.length,name:r,props:[dE({[r]:n})]});return r0.push(o),o.id}pe.RTL,pe.LTR;const uP=t=>{let{state:e}=t,n=e.doc.lineAt(e.selection.main.from),r=Sp(t.state,n.from);return r.line?cP(t):r.block?fP(t):!1};function xp(t,e){return({state:n,dispatch:r})=>{if(n.readOnly)return!1;let i=t(e,n);return i?(r(n.update(i)),!0):!1}}const cP=xp(mP,0),hP=xp(px,0),fP=xp((t,e)=>px(t,e,pP(e)),0);function Sp(t,e){let n=t.languageDataAt("commentTokens",e,1);return n.length?n[0]:{}}const ws=50;function dP(t,{open:e,close:n},r,i){let s=t.sliceDoc(r-ws,r),o=t.sliceDoc(i,i+ws),l=/\s*$/.exec(s)[0].length,a=/^\s*/.exec(o)[0].length,u=s.length-l;if(s.slice(u-e.length,u)==e&&o.slice(a,a+n.length)==n)return{open:{pos:r-l,margin:l&&1},close:{pos:i+a,margin:a&&1}};let c,h;i-r<=2*ws?c=h=t.sliceDoc(r,i):(c=t.sliceDoc(r,r+ws),h=t.sliceDoc(i-ws,i));let f=/^\s*/.exec(c)[0].length,d=/\s*$/.exec(h)[0].length,p=h.length-d-n.length;return c.slice(f,f+e.length)==e&&h.slice(p,p+n.length)==n?{open:{pos:r+f+e.length,margin:/\s/.test(c.charAt(f+e.length))?1:0},close:{pos:i-d-n.length,margin:/\s/.test(h.charAt(p-1))?1:0}}:null}function pP(t){let e=[];for(let n of t.selection.ranges){let r=t.doc.lineAt(n.from),i=n.to<=r.to?r:t.doc.lineAt(n.to);i.from>r.from&&i.from==n.to&&(i=n.to==r.to+1?r:t.doc.lineAt(n.to-1));let s=e.length-1;s>=0&&e[s].to>r.from?e[s].to=i.to:e.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:i.to})}return e}function px(t,e,n=e.selection.ranges){let r=n.map(s=>Sp(e,s.from).block);if(!r.every(s=>s))return null;let i=n.map((s,o)=>dP(e,r[o],s.from,s.to));if(t!=2&&!i.every(s=>s))return{changes:e.changes(n.map((s,o)=>i[o]?[]:[{from:s.from,insert:r[o].open+" "},{from:s.to,insert:" "+r[o].close}]))};if(t!=1&&i.some(s=>s)){let s=[];for(let o=0,l;o<i.length;o++)if(l=i[o]){let a=r[o],{open:u,close:c}=l;s.push({from:u.pos-a.open.length,to:u.pos+u.margin},{from:c.pos-c.margin,to:c.pos+a.close.length})}return{changes:s}}return null}function mP(t,e,n=e.selection.ranges){let r=[],i=-1;for(let{from:s,to:o}of n){let l=r.length,a=1e9,u=Sp(e,s).line;if(u){for(let c=s;c<=o;){let h=e.doc.lineAt(c);if(h.from>i&&(s==o||o>h.from)){i=h.from;let f=/^\s*/.exec(h.text)[0].length,d=f==h.length,p=h.text.slice(f,f+u.length)==u?f:-1;f<h.text.length&&f<a&&(a=f),r.push({line:h,comment:p,token:u,indent:f,empty:d,single:!1})}c=h.to+1}if(a<1e9)for(let c=l;c<r.length;c++)r[c].indent<r[c].line.text.length&&(r[c].indent=a);r.length==l+1&&(r[l].single=!0)}}if(t!=2&&r.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:l,token:a,indent:u,empty:c,single:h}of r)(h||!c)&&s.push({from:l.from+u,insert:a+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(t!=1&&r.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:l,token:a}of r)if(l>=0){let u=o.from+l,c=u+a.length;o.text[c-o.from]==" "&&c++,s.push({from:u,to:c})}return{changes:s}}return null}const Gf=Mn.define(),gP=Mn.define(),yP=I.define(),mx=I.define({combine(t){return An(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,n)=>(r,i)=>e(r,i)||n(r,i)})}}),gx=We.define({create(){return wn.empty},update(t,e){let n=e.state.facet(mx),r=e.annotation(Gf);if(r){let a=mt.fromTransaction(e,r.selection),u=r.side,c=u==0?t.undone:t.done;return a?c=eu(c,c.length,n.minDepth,a):c=wx(c,e.startState.selection),new wn(u==0?r.rest:c,u==0?c:r.rest)}let i=e.annotation(gP);if((i=="full"||i=="before")&&(t=t.isolate()),e.annotation(Te.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let s=mt.fromTransaction(e),o=e.annotation(Te.time),l=e.annotation(Te.userEvent);return s?t=t.addChanges(s,o,l,n,e):e.selection&&(t=t.addSelection(e.startState.selection,o,l,n.newGroupDelay)),(i=="full"||i=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new wn(t.done.map(mt.fromJSON),t.undone.map(mt.fromJSON))}});function vP(t={}){return[gx,mx.of(t),B.domEventHandlers({beforeinput(e,n){let r=e.inputType=="historyUndo"?yx:e.inputType=="historyRedo"?Xf:null;return r?(e.preventDefault(),r(n)):!1}})]}function zu(t,e){return function({state:n,dispatch:r}){if(!e&&n.readOnly)return!1;let i=n.field(gx,!1);if(!i)return!1;let s=i.pop(t,n,e);return s?(r(s),!0):!1}}const yx=zu(0,!1),Xf=zu(1,!1),wP=zu(0,!0),xP=zu(1,!0);class mt{constructor(e,n,r,i,s){this.changes=e,this.effects=n,this.mapped=r,this.startSelection=i,this.selectionsAfter=s}setSelAfter(e){return new mt(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,n,r;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(r=this.startSelection)===null||r===void 0?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(i=>i.toJSON())}}static fromJSON(e){return new mt(e.changes&&Pe.fromJSON(e.changes),[],e.mapped&&bn.fromJSON(e.mapped),e.startSelection&&A.fromJSON(e.startSelection),e.selectionsAfter.map(A.fromJSON))}static fromTransaction(e,n){let r=Bt;for(let i of e.startState.facet(yP)){let s=i(e);s.length&&(r=r.concat(s))}return!r.length&&e.changes.empty?null:new mt(e.changes.invert(e.startState.doc),r,void 0,n||e.startState.selection,Bt)}static selection(e){return new mt(void 0,Bt,void 0,void 0,e)}}function eu(t,e,n,r){let i=e+1>n+20?e-n-1:0,s=t.slice(i,e);return s.push(r),s}function SP(t,e){let n=[],r=!1;return t.iterChangedRanges((i,s)=>n.push(i,s)),e.iterChangedRanges((i,s,o,l)=>{for(let a=0;a<n.length;){let u=n[a++],c=n[a++];l>=u&&o<=c&&(r=!0)}}),r}function kP(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((n,r)=>n.empty!=e.ranges[r].empty).length===0}function vx(t,e){return t.length?e.length?t.concat(e):t:e}const Bt=[],bP=200;function wx(t,e){if(t.length){let n=t[t.length-1],r=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-bP));return r.length&&r[r.length-1].eq(e)?t:(r.push(e),eu(t,t.length-1,1e9,n.setSelAfter(r)))}else return[mt.selection([e])]}function CP(t){let e=t[t.length-1],n=t.slice();return n[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),n}function Hc(t,e){if(!t.length)return t;let n=t.length,r=Bt;for(;n;){let i=MP(t[n-1],e,r);if(i.changes&&!i.changes.empty||i.effects.length){let s=t.slice(0,n);return s[n-1]=i,s}else e=i.mapped,n--,r=i.selectionsAfter}return r.length?[mt.selection(r)]:Bt}function MP(t,e,n){let r=vx(t.selectionsAfter.length?t.selectionsAfter.map(l=>l.map(e)):Bt,n);if(!t.changes)return mt.selection(r);let i=t.changes.map(e),s=e.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(s):s;return new mt(i,G.mapEffects(t.effects,e),o,t.startSelection.map(s),r)}const AP=/^(input\.type|delete)($|\.)/;class wn{constructor(e,n,r=0,i=void 0){this.done=e,this.undone=n,this.prevTime=r,this.prevUserEvent=i}isolate(){return this.prevTime?new wn(this.done,this.undone):this}addChanges(e,n,r,i,s){let o=this.done,l=o[o.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!r||AP.test(r))&&(!l.selectionsAfter.length&&n-this.prevTime<i.newGroupDelay&&i.joinToEvent(s,SP(l.changes,e.changes))||r=="input.type.compose")?o=eu(o,o.length-1,i.minDepth,new mt(e.changes.compose(l.changes),vx(G.mapEffects(e.effects,l.changes),l.effects),l.mapped,l.startSelection,Bt)):o=eu(o,o.length,i.minDepth,e),new wn(o,Bt,n,r)}addSelection(e,n,r,i){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:Bt;return s.length>0&&n-this.prevTime<i&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&kP(s[s.length-1],e)?this:new wn(wx(this.done,e),this.undone,n,r)}addMapping(e){return new wn(Hc(this.done,e),Hc(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,n,r){let i=e==0?this.done:this.undone;if(i.length==0)return null;let s=i[i.length-1],o=s.selectionsAfter[0]||n.selection;if(r&&s.selectionsAfter.length)return n.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:Gf.of({side:e,rest:CP(i),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let l=i.length==1?Bt:i.slice(0,i.length-1);return s.mapped&&(l=Hc(l,s.mapped)),n.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:Gf.of({side:e,rest:l,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}wn.empty=new wn(Bt,Bt);const EP=[{key:"Mod-z",run:yx,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Xf,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Xf,preventDefault:!0},{key:"Mod-u",run:wP,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:xP,preventDefault:!0}];function is(t,e){return A.create(t.ranges.map(e),t.mainIndex)}function rn(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function sn({state:t,dispatch:e},n){let r=is(t.selection,n);return r.eq(t.selection,!0)?!1:(e(rn(t,r)),!0)}function Wu(t,e){return A.cursor(e?t.to:t.from)}function xx(t,e){return sn(t,n=>n.empty?t.moveByChar(n,e):Wu(n,e))}function Qe(t){return t.textDirectionAt(t.state.selection.main.head)==pe.LTR}const Sx=t=>xx(t,!Qe(t)),kx=t=>xx(t,Qe(t));function bx(t,e){return sn(t,n=>n.empty?t.moveByGroup(n,e):Wu(n,e))}const PP=t=>bx(t,!Qe(t)),DP=t=>bx(t,Qe(t));function TP(t,e,n){if(e.type.prop(n))return!0;let r=e.to-e.from;return r&&(r>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function Vu(t,e,n){let r=Xe(t).resolveInner(e.head),i=n?te.closedBy:te.openedBy;for(let a=e.head;;){let u=n?r.childAfter(a):r.childBefore(a);if(!u)break;TP(t,u,i)?r=u:a=n?u.to:u.from}let s=r.type.prop(i),o,l;return s&&(o=n?vn(t,r.from,1):vn(t,r.to,-1))&&o.matched?l=n?o.end.to:o.end.from:l=n?r.to:r.from,A.cursor(l,n?-1:1)}const OP=t=>sn(t,e=>Vu(t.state,e,!Qe(t))),RP=t=>sn(t,e=>Vu(t.state,e,Qe(t)));function Cx(t,e){return sn(t,n=>{if(!n.empty)return Wu(n,e);let r=t.moveVertically(n,e);return r.head!=n.head?r:t.moveToLineBoundary(n,e)})}const Mx=t=>Cx(t,!1),Ax=t=>Cx(t,!0);function Ex(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,n=0,r=0,i;if(e){for(let s of t.state.facet(B.scrollMargins)){let o=s(t);o!=null&&o.top&&(n=Math.max(o==null?void 0:o.top,n)),o!=null&&o.bottom&&(r=Math.max(o==null?void 0:o.bottom,r))}i=t.scrollDOM.clientHeight-n-r}else i=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:r,selfScroll:e,height:Math.max(t.defaultLineHeight,i-5)}}function Px(t,e){let n=Ex(t),{state:r}=t,i=is(r.selection,o=>o.empty?t.moveVertically(o,e,n.height):Wu(o,e));if(i.eq(r.selection))return!1;let s;if(n.selfScroll){let o=t.coordsAtPos(r.selection.main.head),l=t.scrollDOM.getBoundingClientRect(),a=l.top+n.marginTop,u=l.bottom-n.marginBottom;o&&o.top>a&&o.bottom<u&&(s=B.scrollIntoView(i.main.head,{y:"start",yMargin:o.top-a}))}return t.dispatch(rn(r,i),{effects:s}),!0}const o0=t=>Px(t,!1),Yf=t=>Px(t,!0);function Ar(t,e,n){let r=t.lineBlockAt(e.head),i=t.moveToLineBoundary(e,n);if(i.head==e.head&&i.head!=(n?r.to:r.from)&&(i=t.moveToLineBoundary(e,n,!1)),!n&&i.head==r.from&&r.length){let s=/^\s*/.exec(t.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;s&&e.head!=r.from+s&&(i=A.cursor(r.from+s))}return i}const NP=t=>sn(t,e=>Ar(t,e,!0)),LP=t=>sn(t,e=>Ar(t,e,!1)),BP=t=>sn(t,e=>Ar(t,e,!Qe(t))),_P=t=>sn(t,e=>Ar(t,e,Qe(t))),IP=t=>sn(t,e=>A.cursor(t.lineBlockAt(e.head).from,1)),jP=t=>sn(t,e=>A.cursor(t.lineBlockAt(e.head).to,-1));function FP(t,e,n){let r=!1,i=is(t.selection,s=>{let o=vn(t,s.head,-1)||vn(t,s.head,1)||s.head>0&&vn(t,s.head-1,1)||s.head<t.doc.length&&vn(t,s.head+1,-1);if(!o||!o.end)return s;r=!0;let l=o.start.from==s.head?o.end.to:o.end.from;return A.cursor(l)});return r?(e(rn(t,i)),!0):!1}const zP=({state:t,dispatch:e})=>FP(t,e);function $t(t,e){let n=is(t.state.selection,r=>{let i=e(r);return A.range(r.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)});return n.eq(t.state.selection)?!1:(t.dispatch(rn(t.state,n)),!0)}function Dx(t,e){return $t(t,n=>t.moveByChar(n,e))}const Tx=t=>Dx(t,!Qe(t)),Ox=t=>Dx(t,Qe(t));function Rx(t,e){return $t(t,n=>t.moveByGroup(n,e))}const WP=t=>Rx(t,!Qe(t)),VP=t=>Rx(t,Qe(t)),HP=t=>$t(t,e=>Vu(t.state,e,!Qe(t))),UP=t=>$t(t,e=>Vu(t.state,e,Qe(t)));function Nx(t,e){return $t(t,n=>t.moveVertically(n,e))}const Lx=t=>Nx(t,!1),Bx=t=>Nx(t,!0);function _x(t,e){return $t(t,n=>t.moveVertically(n,e,Ex(t).height))}const l0=t=>_x(t,!1),a0=t=>_x(t,!0),$P=t=>$t(t,e=>Ar(t,e,!0)),KP=t=>$t(t,e=>Ar(t,e,!1)),qP=t=>$t(t,e=>Ar(t,e,!Qe(t))),GP=t=>$t(t,e=>Ar(t,e,Qe(t))),XP=t=>$t(t,e=>A.cursor(t.lineBlockAt(e.head).from)),YP=t=>$t(t,e=>A.cursor(t.lineBlockAt(e.head).to)),u0=({state:t,dispatch:e})=>(e(rn(t,{anchor:0})),!0),c0=({state:t,dispatch:e})=>(e(rn(t,{anchor:t.doc.length})),!0),h0=({state:t,dispatch:e})=>(e(rn(t,{anchor:t.selection.main.anchor,head:0})),!0),f0=({state:t,dispatch:e})=>(e(rn(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),QP=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),JP=({state:t,dispatch:e})=>{let n=Hu(t).map(({from:r,to:i})=>A.range(r,Math.min(i+1,t.doc.length)));return e(t.update({selection:A.create(n),userEvent:"select"})),!0},ZP=({state:t,dispatch:e})=>{let n=is(t.selection,r=>{let i=Xe(t),s=i.resolveStack(r.from,1);if(r.empty){let o=i.resolveStack(r.from,-1);o.node.from>=s.node.from&&o.node.to<=s.node.to&&(s=o)}for(let o=s;o;o=o.next){let{node:l}=o;if((l.from<r.from&&l.to>=r.to||l.to>r.to&&l.from<=r.from)&&o.next)return A.range(l.to,l.from)}return r});return n.eq(t.selection)?!1:(e(rn(t,n)),!0)};function Ix(t,e){let{state:n}=t,r=n.selection,i=n.selection.ranges.slice();for(let s of n.selection.ranges){let o=n.doc.lineAt(s.head);if(e?o.to<t.state.doc.length:o.from>0)for(let l=s;;){let a=t.moveVertically(l,e);if(a.head<o.from||a.head>o.to){i.some(u=>u.head==a.head)||i.push(a);break}else{if(a.head==l.head)break;l=a}}}return i.length==r.ranges.length?!1:(t.dispatch(rn(n,A.create(i,i.length-1))),!0)}const eD=t=>Ix(t,!1),tD=t=>Ix(t,!0),nD=({state:t,dispatch:e})=>{let n=t.selection,r=null;return n.ranges.length>1?r=A.create([n.main]):n.main.empty||(r=A.create([A.cursor(n.main.head)])),r?(e(rn(t,r)),!0):!1};function Ko(t,e){if(t.state.readOnly)return!1;let n="delete.selection",{state:r}=t,i=r.changeByRange(s=>{let{from:o,to:l}=s;if(o==l){let a=e(s);a<o?(n="delete.backward",a=Rl(t,a,!1)):a>o&&(n="delete.forward",a=Rl(t,a,!0)),o=Math.min(o,a),l=Math.max(l,a)}else o=Rl(t,o,!1),l=Rl(t,l,!0);return o==l?{range:s}:{changes:{from:o,to:l},range:A.cursor(o,o<s.head?-1:1)}});return i.changes.empty?!1:(t.dispatch(r.update(i,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?B.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function Rl(t,e,n){if(t instanceof B)for(let r of t.state.facet(B.atomicRanges).map(i=>i(t)))r.between(e,e,(i,s)=>{i<e&&s>e&&(e=n?s:i)});return e}const jx=(t,e,n)=>Ko(t,r=>{let i=r.from,{state:s}=t,o=s.doc.lineAt(i),l,a;if(n&&!e&&i>o.from&&i<o.from+200&&!/[^ \t]/.test(l=o.text.slice(0,i-o.from))){if(l[l.length-1]=="	")return i-1;let u=rs(l,s.tabSize),c=u%Qa(s)||Qa(s);for(let h=0;h<c&&l[l.length-1-h]==" ";h++)i--;a=i}else a=je(o.text,i-o.from,e,e)+o.from,a==i&&o.number!=(e?s.doc.lines:1)?a+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(a-o.from,i-o.from))&&(a=je(o.text,a-o.from,!1,!1)+o.from);return a}),Qf=t=>jx(t,!1,!0),Fx=t=>jx(t,!0,!1),zx=(t,e)=>Ko(t,n=>{let r=n.head,{state:i}=t,s=i.doc.lineAt(r),o=i.charCategorizer(r);for(let l=null;;){if(r==(e?s.to:s.from)){r==n.head&&s.number!=(e?i.doc.lines:1)&&(r+=e?1:-1);break}let a=je(s.text,r-s.from,e)+s.from,u=s.text.slice(Math.min(r,a)-s.from,Math.max(r,a)-s.from),c=o(u);if(l!=null&&c!=l)break;(u!=" "||r!=n.head)&&(l=c),r=a}return r}),Wx=t=>zx(t,!1),rD=t=>zx(t,!0),iD=t=>Ko(t,e=>{let n=t.lineBlockAt(e.head).to;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),sD=t=>Ko(t,e=>{let n=t.moveToLineBoundary(e,!1).head;return e.head>n?n:Math.max(0,e.head-1)}),oD=t=>Ko(t,e=>{let n=t.moveToLineBoundary(e,!0).head;return e.head<n?n:Math.min(t.state.doc.length,e.head+1)}),lD=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:re.of(["",""])},range:A.cursor(r.from)}));return e(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},aD=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(r=>{if(!r.empty||r.from==0||r.from==t.doc.length)return{range:r};let i=r.from,s=t.doc.lineAt(i),o=i==s.from?i-1:je(s.text,i-s.from,!1)+s.from,l=i==s.to?i+1:je(s.text,i-s.from,!0)+s.from;return{changes:{from:o,to:l,insert:t.doc.slice(i,l).append(t.doc.slice(o,i))},range:A.cursor(l)}});return n.changes.empty?!1:(e(t.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Hu(t){let e=[],n=-1;for(let r of t.selection.ranges){let i=t.doc.lineAt(r.from),s=t.doc.lineAt(r.to);if(!r.empty&&r.to==s.from&&(s=t.doc.lineAt(r.to-1)),n>=i.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(r)}else e.push({from:i.from,to:s.to,ranges:[r]});n=s.number+1}return e}function Vx(t,e,n){if(t.readOnly)return!1;let r=[],i=[];for(let s of Hu(t)){if(n?s.to==t.doc.length:s.from==0)continue;let o=t.doc.lineAt(n?s.to+1:s.from-1),l=o.length+1;if(n){r.push({from:s.to,to:o.to},{from:s.from,insert:o.text+t.lineBreak});for(let a of s.ranges)i.push(A.range(Math.min(t.doc.length,a.anchor+l),Math.min(t.doc.length,a.head+l)))}else{r.push({from:o.from,to:s.from},{from:s.to,insert:t.lineBreak+o.text});for(let a of s.ranges)i.push(A.range(a.anchor-l,a.head-l))}}return r.length?(e(t.update({changes:r,scrollIntoView:!0,selection:A.create(i,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const uD=({state:t,dispatch:e})=>Vx(t,e,!1),cD=({state:t,dispatch:e})=>Vx(t,e,!0);function Hx(t,e,n){if(t.readOnly)return!1;let r=[];for(let i of Hu(t))n?r.push({from:i.from,insert:t.doc.slice(i.from,i.to)+t.lineBreak}):r.push({from:i.to,insert:t.lineBreak+t.doc.slice(i.from,i.to)});return e(t.update({changes:r,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const hD=({state:t,dispatch:e})=>Hx(t,e,!1),fD=({state:t,dispatch:e})=>Hx(t,e,!0),dD=t=>{if(t.state.readOnly)return!1;let{state:e}=t,n=e.changes(Hu(e).map(({from:i,to:s})=>(i>0?i--:s<e.doc.length&&s++,{from:i,to:s}))),r=is(e.selection,i=>{let s;if(t.lineWrapping){let o=t.lineBlockAt(i.head),l=t.coordsAtPos(i.head,i.assoc||1);l&&(s=o.bottom+t.documentTop-l.bottom+t.defaultLineHeight/2)}return t.moveVertically(i,!0,s)}).map(n);return t.dispatch({changes:n,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0};function pD(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let n=Xe(t).resolveInner(e),r=n.childBefore(e),i=n.childAfter(e),s;return r&&i&&r.to<=e&&i.from>=e&&(s=r.type.prop(te.closedBy))&&s.indexOf(i.name)>-1&&t.doc.lineAt(r.to).from==t.doc.lineAt(i.from).from&&!/\S/.test(t.sliceDoc(r.to,i.from))?{from:r.to,to:i.from}:null}const d0=Ux(!1),mD=Ux(!0);function Ux(t){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let r=e.changeByRange(i=>{let{from:s,to:o}=i,l=e.doc.lineAt(s),a=!t&&s==o&&pD(e,s);t&&(s=o=(o<=l.to?l:e.doc.lineAt(o)).to);let u=new ju(e,{simulateBreak:s,simulateDoubleBreak:!!a}),c=vp(u,s);for(c==null&&(c=rs(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<l.to&&/\s/.test(l.text[o-l.from]);)o++;a?{from:s,to:o}=a:s>l.from&&s<l.from+100&&!/\S/.test(l.text.slice(0,s))&&(s=l.from);let h=["",Po(e,c)];return a&&h.push(Po(e,u.lineIndent(l.from,-1))),{changes:{from:s,to:o,insert:re.of(h)},range:A.cursor(s+1+h[1].length)}});return n(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function kp(t,e){let n=-1;return t.changeByRange(r=>{let i=[];for(let o=r.from;o<=r.to;){let l=t.doc.lineAt(o);l.number>n&&(r.empty||r.to>l.from)&&(e(l,i,r),n=l.number),o=l.to+1}let s=t.changes(i);return{changes:i,range:A.range(s.mapPos(r.anchor,1),s.mapPos(r.head,1))}})}const gD=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=Object.create(null),r=new ju(t,{overrideIndentation:s=>{let o=n[s];return o??-1}}),i=kp(t,(s,o,l)=>{let a=vp(r,s.from);if(a==null)return;/\S/.test(s.text)||(a=0);let u=/^\s*/.exec(s.text)[0],c=Po(t,a);(u!=c||l.from<s.from+u.length)&&(n[s.from]=a,o.push({from:s.from,to:s.from+u.length,insert:c}))});return i.changes.empty||e(t.update(i,{userEvent:"indent"})),!0},$x=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(kp(t,(n,r)=>{r.push({from:n.from,insert:t.facet(Iu)})}),{userEvent:"input.indent"})),!0),Kx=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(kp(t,(n,r)=>{let i=/^\s*/.exec(n.text)[0];if(!i)return;let s=rs(i,t.tabSize),o=0,l=Po(t,Math.max(0,s-Qa(t)));for(;o<i.length&&o<l.length&&i.charCodeAt(o)==l.charCodeAt(o);)o++;r.push({from:n.from+o,to:n.from+i.length,insert:l.slice(o)})}),{userEvent:"delete.dedent"})),!0),yD=t=>(t.setTabFocusMode(),!0),vD=[{key:"Ctrl-b",run:Sx,shift:Tx,preventDefault:!0},{key:"Ctrl-f",run:kx,shift:Ox},{key:"Ctrl-p",run:Mx,shift:Lx},{key:"Ctrl-n",run:Ax,shift:Bx},{key:"Ctrl-a",run:IP,shift:XP},{key:"Ctrl-e",run:jP,shift:YP},{key:"Ctrl-d",run:Fx},{key:"Ctrl-h",run:Qf},{key:"Ctrl-k",run:iD},{key:"Ctrl-Alt-h",run:Wx},{key:"Ctrl-o",run:lD},{key:"Ctrl-t",run:aD},{key:"Ctrl-v",run:Yf}],wD=[{key:"ArrowLeft",run:Sx,shift:Tx,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:PP,shift:WP,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:BP,shift:qP,preventDefault:!0},{key:"ArrowRight",run:kx,shift:Ox,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:DP,shift:VP,preventDefault:!0},{mac:"Cmd-ArrowRight",run:_P,shift:GP,preventDefault:!0},{key:"ArrowUp",run:Mx,shift:Lx,preventDefault:!0},{mac:"Cmd-ArrowUp",run:u0,shift:h0},{mac:"Ctrl-ArrowUp",run:o0,shift:l0},{key:"ArrowDown",run:Ax,shift:Bx,preventDefault:!0},{mac:"Cmd-ArrowDown",run:c0,shift:f0},{mac:"Ctrl-ArrowDown",run:Yf,shift:a0},{key:"PageUp",run:o0,shift:l0},{key:"PageDown",run:Yf,shift:a0},{key:"Home",run:LP,shift:KP,preventDefault:!0},{key:"Mod-Home",run:u0,shift:h0},{key:"End",run:NP,shift:$P,preventDefault:!0},{key:"Mod-End",run:c0,shift:f0},{key:"Enter",run:d0,shift:d0},{key:"Mod-a",run:QP},{key:"Backspace",run:Qf,shift:Qf,preventDefault:!0},{key:"Delete",run:Fx,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Wx,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:rD,preventDefault:!0},{mac:"Mod-Backspace",run:sD,preventDefault:!0},{mac:"Mod-Delete",run:oD,preventDefault:!0}].concat(vD.map(t=>({mac:t.key,run:t.run,shift:t.shift}))),xD=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:OP,shift:HP},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:RP,shift:UP},{key:"Alt-ArrowUp",run:uD},{key:"Shift-Alt-ArrowUp",run:hD},{key:"Alt-ArrowDown",run:cD},{key:"Shift-Alt-ArrowDown",run:fD},{key:"Mod-Alt-ArrowUp",run:eD},{key:"Mod-Alt-ArrowDown",run:tD},{key:"Escape",run:nD},{key:"Mod-Enter",run:mD},{key:"Alt-l",mac:"Ctrl-l",run:JP},{key:"Mod-i",run:ZP,preventDefault:!0},{key:"Mod-[",run:Kx},{key:"Mod-]",run:$x},{key:"Mod-Alt-\\",run:gD},{key:"Shift-Mod-k",run:dD},{key:"Shift-Mod-\\",run:zP},{key:"Mod-/",run:uP},{key:"Alt-A",run:hP},{key:"Ctrl-m",mac:"Shift-Alt-m",run:yD}].concat(wD),SD={key:"Tab",run:$x,shift:Kx},p0=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class Ji{constructor(e,n,r=0,i=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,i),this.bufferStart=r,this.normalize=s?l=>s(p0(l)):p0,this.query=this.normalize(n)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return ht(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=ep(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=mn(e);let i=this.normalize(n);if(i.length)for(let s=0,o=r;;s++){let l=i.charCodeAt(s),a=this.match(l,o,this.bufferPos+this.bufferStart);if(s==i.length-1){if(a)return this.value=a,this;break}o==r&&s<n.length&&n.charCodeAt(s)==l&&o++}}}match(e,n,r){let i=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],l=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?i={from:this.matches[s+1],to:r}:(this.matches[s]++,l=!0)),l||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:n,to:r}:this.matches.push(1,n)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)&&(i=null),i}}typeof Symbol<"u"&&(Ji.prototype[Symbol.iterator]=function(){return this});const qx={from:-1,to:-1,match:/.*/.exec("")},bp="gm"+(/x/.unicode==null?"":"u");class Gx{constructor(e,n,r,i=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=qx,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new Xx(e,n,r,i,s);this.re=new RegExp(n,bp+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.iter=e.iter();let o=e.lineAt(i);this.curLineStart=o.from,this.matchPos=tu(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let n=this.matchPos<=this.to&&this.re.exec(this.curLine);if(n){let r=this.curLineStart+n.index,i=r+n[0].length;if(this.matchPos=tu(this.text,i+(r==i?1:0)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<i||r>this.value.to)&&(!this.test||this.test(r,i,n)))return this.value={from:r,to:i,match:n},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Uc=new WeakMap;class Li{constructor(e,n){this.from=e,this.text=n}get to(){return this.from+this.text.length}static get(e,n,r){let i=Uc.get(e);if(!i||i.from>=r||i.to<=n){let l=new Li(n,e.sliceString(n,r));return Uc.set(e,l),l}if(i.from==n&&i.to==r)return i;let{text:s,from:o}=i;return o>n&&(s=e.sliceString(n,o)+s,o=n),i.to<r&&(s+=e.sliceString(i.to,r)),Uc.set(e,new Li(o,s)),new Li(n,s.slice(n-o,r-o))}}class Xx{constructor(e,n,r,i,s){this.text=e,this.to=s,this.done=!1,this.value=qx,this.matchPos=tu(e,i),this.re=new RegExp(n,bp+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.flat=Li.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,n=this.re.exec(this.flat.text);if(n&&!n[0]&&n.index==e&&(this.re.lastIndex=e+1,n=this.re.exec(this.flat.text)),n){let r=this.flat.from+n.index,i=r+n[0].length;if((this.flat.to>=this.to||n.index+n[0].length<=this.flat.text.length-10)&&(!this.test||this.test(r,i,n)))return this.value={from:r,to:i,match:n},this.matchPos=tu(this.text,i+(r==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Li.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(Gx.prototype[Symbol.iterator]=Xx.prototype[Symbol.iterator]=function(){return this});function kD(t){try{return new RegExp(t,bp),!0}catch{return!1}}function tu(t,e){if(e>=t.length)return e;let n=t.lineAt(e),r;for(;e<n.to&&(r=n.text.charCodeAt(e-n.from))>=56320&&r<57344;)e++;return e}function Jf(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),n=ae("input",{class:"cm-textfield",name:"line",value:e}),r=ae("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),t.dispatch({effects:Js.of(!1)}),t.focus()):s.keyCode==13&&(s.preventDefault(),i())},onsubmit:s=>{s.preventDefault(),i()}},ae("label",t.state.phrase("Go to line"),": ",n)," ",ae("button",{class:"cm-button",type:"submit"},t.state.phrase("go")),ae("button",{name:"close",onclick:()=>{t.dispatch({effects:Js.of(!1)}),t.focus()},"aria-label":t.state.phrase("close"),type:"button"},[""]));function i(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(n.value);if(!s)return;let{state:o}=t,l=o.doc.lineAt(o.selection.main.head),[,a,u,c,h]=s,f=c?+c.slice(1):0,d=u?+u:l.number;if(u&&h){let w=d/100;a&&(w=w*(a=="-"?-1:1)+l.number/o.doc.lines),d=Math.round(o.doc.lines*w)}else u&&a&&(d=d*(a=="-"?-1:1)+l.number);let p=o.doc.line(Math.max(1,Math.min(o.doc.lines,d))),y=A.cursor(p.from+Math.max(0,Math.min(f,p.length)));t.dispatch({effects:[Js.of(!1),B.scrollIntoView(y.from,{y:"center"})],selection:y}),t.focus()}return{dom:r}}const Js=G.define(),m0=We.define({create(){return!0},update(t,e){for(let n of e.effects)n.is(Js)&&(t=n.value);return t},provide:t=>Mo.from(t,e=>e?Jf:null)}),bD=t=>{let e=Co(t,Jf);if(!e){let n=[Js.of(!0)];t.state.field(m0,!1)==null&&n.push(G.appendConfig.of([m0,CD])),t.dispatch({effects:n}),e=Co(t,Jf)}return e&&e.dom.querySelector("input").select(),!0},CD=B.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),MD={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},AD=I.define({combine(t){return An(t,MD,{highlightWordAroundCursor:(e,n)=>e||n,minSelectionLength:Math.min,maxMatches:Math.min})}});function ED(t){return[RD,OD]}const PD=$.mark({class:"cm-selectionMatch"}),DD=$.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function g0(t,e,n,r){return(n==0||t(e.sliceDoc(n-1,n))!=ye.Word)&&(r==e.doc.length||t(e.sliceDoc(r,r+1))!=ye.Word)}function TD(t,e,n,r){return t(e.sliceDoc(n,n+1))==ye.Word&&t(e.sliceDoc(r-1,r))==ye.Word}const OD=Ce.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(AD),{state:n}=t,r=n.selection;if(r.ranges.length>1)return $.none;let i=r.main,s,o=null;if(i.empty){if(!e.highlightWordAroundCursor)return $.none;let a=n.wordAt(i.head);if(!a)return $.none;o=n.charCategorizer(i.head),s=n.sliceDoc(a.from,a.to)}else{let a=i.to-i.from;if(a<e.minSelectionLength||a>200)return $.none;if(e.wholeWords){if(s=n.sliceDoc(i.from,i.to),o=n.charCategorizer(i.head),!(g0(o,n,i.from,i.to)&&TD(o,n,i.from,i.to)))return $.none}else if(s=n.sliceDoc(i.from,i.to),!s)return $.none}let l=[];for(let a of t.visibleRanges){let u=new Ji(n.doc,s,a.from,a.to);for(;!u.next().done;){let{from:c,to:h}=u.value;if((!o||g0(o,n,c,h))&&(i.empty&&c<=i.from&&h>=i.to?l.push(DD.range(c,h)):(c>=i.to||h<=i.from)&&l.push(PD.range(c,h)),l.length>e.maxMatches))return $.none}}return $.set(l)}},{decorations:t=>t.decorations}),RD=B.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),ND=({state:t,dispatch:e})=>{let{selection:n}=t,r=A.create(n.ranges.map(i=>t.wordAt(i.head)||A.cursor(i.head)),n.mainIndex);return r.eq(n)?!1:(e(t.update({selection:r})),!0)};function LD(t,e){let{main:n,ranges:r}=t.selection,i=t.wordAt(n.head),s=i&&i.from==n.from&&i.to==n.to;for(let o=!1,l=new Ji(t.doc,e,r[r.length-1].to);;)if(l.next(),l.done){if(o)return null;l=new Ji(t.doc,e,0,Math.max(0,r[r.length-1].from-1)),o=!0}else{if(o&&r.some(a=>a.from==l.value.from))continue;if(s){let a=t.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const BD=({state:t,dispatch:e})=>{let{ranges:n}=t.selection;if(n.some(s=>s.from===s.to))return ND({state:t,dispatch:e});let r=t.sliceDoc(n[0].from,n[0].to);if(t.selection.ranges.some(s=>t.sliceDoc(s.from,s.to)!=r))return!1;let i=LD(t,r);return i?(e(t.update({selection:t.selection.addRange(A.range(i.from,i.to),!1),effects:B.scrollIntoView(i.to)})),!0):!1},ss=I.define({combine(t){return An(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new qD(e),scrollToMatch:e=>B.scrollIntoView(e)})}});class Yx{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||kD(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(n,r)=>r=="n"?`
`:r=="r"?"\r":r=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new FD(this):new ID(this)}getCursor(e,n=0,r){let i=e.doc?e:ee.create({doc:e});return r==null&&(r=i.doc.length),this.regexp?li(this,i,n,r):oi(this,i,n,r)}}class Qx{constructor(e){this.spec=e}}function oi(t,e,n,r){return new Ji(e.doc,t.unquoted,n,r,t.caseSensitive?void 0:i=>i.toLowerCase(),t.wholeWord?_D(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function _D(t,e){return(n,r,i,s)=>((s>n||s+i.length<r)&&(s=Math.max(0,n-2),i=t.sliceString(s,Math.min(t.length,r+2))),(e(nu(i,n-s))!=ye.Word||e(ru(i,n-s))!=ye.Word)&&(e(ru(i,r-s))!=ye.Word||e(nu(i,r-s))!=ye.Word))}class ID extends Qx{constructor(e){super(e)}nextMatch(e,n,r){let i=oi(this.spec,e,r,e.doc.length).nextOverlapping();if(i.done){let s=Math.min(e.doc.length,n+this.spec.unquoted.length);i=oi(this.spec,e,0,s).nextOverlapping()}return i.done||i.value.from==n&&i.value.to==r?null:i.value}prevMatchInRange(e,n,r){for(let i=r;;){let s=Math.max(n,i-1e4-this.spec.unquoted.length),o=oi(this.spec,e,s,i),l=null;for(;!o.nextOverlapping().done;)l=o.value;if(l)return l;if(s==n)return null;i-=1e4}}prevMatch(e,n,r){let i=this.prevMatchInRange(e,0,n);return i||(i=this.prevMatchInRange(e,Math.max(0,r-this.spec.unquoted.length),e.doc.length)),i&&(i.from!=n||i.to!=r)?i:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,n){let r=oi(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=n)return null;i.push(r.value)}return i}highlight(e,n,r,i){let s=oi(this.spec,e,Math.max(0,n-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}function li(t,e,n,r){return new Gx(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?jD(e.charCategorizer(e.selection.main.head)):void 0},n,r)}function nu(t,e){return t.slice(je(t,e,!1),e)}function ru(t,e){return t.slice(e,je(t,e))}function jD(t){return(e,n,r)=>!r[0].length||(t(nu(r.input,r.index))!=ye.Word||t(ru(r.input,r.index))!=ye.Word)&&(t(ru(r.input,r.index+r[0].length))!=ye.Word||t(nu(r.input,r.index+r[0].length))!=ye.Word)}class FD extends Qx{nextMatch(e,n,r){let i=li(this.spec,e,r,e.doc.length).next();return i.done&&(i=li(this.spec,e,0,n).next()),i.done?null:i.value}prevMatchInRange(e,n,r){for(let i=1;;i++){let s=Math.max(n,r-i*1e4),o=li(this.spec,e,s,r),l=null;for(;!o.next().done;)l=o.value;if(l&&(s==n||l.from>s+10))return l;if(s==n)return null}}prevMatch(e,n,r){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(n,r)=>{if(r=="&")return e.match[0];if(r=="$")return"$";for(let i=r.length;i>0;i--){let s=+r.slice(0,i);if(s>0&&s<e.match.length)return e.match[s]+r.slice(i)}return n})}matchAll(e,n){let r=li(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=n)return null;i.push(r.value)}return i}highlight(e,n,r,i){let s=li(this.spec,e,Math.max(0,n-250),Math.min(r+250,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}const Do=G.define(),Cp=G.define(),mr=We.define({create(t){return new $c(Zf(t).create(),null)},update(t,e){for(let n of e.effects)n.is(Do)?t=new $c(n.value.create(),t.panel):n.is(Cp)&&(t=new $c(t.query,n.value?Mp:null));return t},provide:t=>Mo.from(t,e=>e.panel)});class $c{constructor(e,n){this.query=e,this.panel=n}}const zD=$.mark({class:"cm-searchMatch"}),WD=$.mark({class:"cm-searchMatch cm-searchMatch-selected"}),VD=Ce.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(mr))}update(t){let e=t.state.field(mr);(e!=t.startState.field(mr)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return $.none;let{view:n}=this,r=new zn;for(let i=0,s=n.visibleRanges,o=s.length;i<o;i++){let{from:l,to:a}=s[i];for(;i<o-1&&a>s[i+1].from-2*250;)a=s[++i].to;t.highlight(n.state,l,a,(u,c)=>{let h=n.state.selection.ranges.some(f=>f.from==u&&f.to==c);r.add(u,c,h?WD:zD)})}return r.finish()}},{decorations:t=>t.decorations});function qo(t){return e=>{let n=e.state.field(mr,!1);return n&&n.query.spec.valid?t(e,n):eS(e)}}const iu=qo((t,{query:e})=>{let{to:n}=t.state.selection.main,r=e.nextMatch(t.state,n,n);if(!r)return!1;let i=A.single(r.from,r.to),s=t.state.facet(ss);return t.dispatch({selection:i,effects:[Ap(t,r),s.scrollToMatch(i.main,t)],userEvent:"select.search"}),Zx(t),!0}),su=qo((t,{query:e})=>{let{state:n}=t,{from:r}=n.selection.main,i=e.prevMatch(n,r,r);if(!i)return!1;let s=A.single(i.from,i.to),o=t.state.facet(ss);return t.dispatch({selection:s,effects:[Ap(t,i),o.scrollToMatch(s.main,t)],userEvent:"select.search"}),Zx(t),!0}),HD=qo((t,{query:e})=>{let n=e.matchAll(t.state,1e3);return!n||!n.length?!1:(t.dispatch({selection:A.create(n.map(r=>A.range(r.from,r.to))),userEvent:"select.search.matches"}),!0)}),UD=({state:t,dispatch:e})=>{let n=t.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:r,to:i}=n.main,s=[],o=0;for(let l=new Ji(t.doc,t.sliceDoc(r,i));!l.next().done;){if(s.length>1e3)return!1;l.value.from==r&&(o=s.length),s.push(A.range(l.value.from,l.value.to))}return e(t.update({selection:A.create(s,o),userEvent:"select.search.matches"})),!0},y0=qo((t,{query:e})=>{let{state:n}=t,{from:r,to:i}=n.selection.main;if(n.readOnly)return!1;let s=e.nextMatch(n,r,r);if(!s)return!1;let o=s,l=[],a,u,c=[];o.from==r&&o.to==i&&(u=n.toText(e.getReplacement(o)),l.push({from:o.from,to:o.to,insert:u}),o=e.nextMatch(n,o.from,o.to),c.push(B.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(r).number)+".")));let h=t.state.changes(l);return o&&(a=A.single(o.from,o.to).map(h),c.push(Ap(t,o)),c.push(n.facet(ss).scrollToMatch(a.main,t))),t.dispatch({changes:h,selection:a,effects:c,userEvent:"input.replace"}),!0}),$D=qo((t,{query:e})=>{if(t.state.readOnly)return!1;let n=e.matchAll(t.state,1e9).map(i=>{let{from:s,to:o}=i;return{from:s,to:o,insert:e.getReplacement(i)}});if(!n.length)return!1;let r=t.state.phrase("replaced $ matches",n.length)+".";return t.dispatch({changes:n,effects:B.announce.of(r),userEvent:"input.replace.all"}),!0});function Mp(t){return t.state.facet(ss).createPanel(t)}function Zf(t,e){var n,r,i,s,o;let l=t.selection.main,a=l.empty||l.to>l.from+100?"":t.sliceDoc(l.from,l.to);if(e&&!a)return e;let u=t.facet(ss);return new Yx({search:((n=e==null?void 0:e.literal)!==null&&n!==void 0?n:u.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:(r=e==null?void 0:e.caseSensitive)!==null&&r!==void 0?r:u.caseSensitive,literal:(i=e==null?void 0:e.literal)!==null&&i!==void 0?i:u.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:u.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:u.wholeWord})}function Jx(t){let e=Co(t,Mp);return e&&e.dom.querySelector("[main-field]")}function Zx(t){let e=Jx(t);e&&e==t.root.activeElement&&e.select()}const eS=t=>{let e=t.state.field(mr,!1);if(e&&e.panel){let n=Jx(t);if(n&&n!=t.root.activeElement){let r=Zf(t.state,e.query.spec);r.valid&&t.dispatch({effects:Do.of(r)}),n.focus(),n.select()}}else t.dispatch({effects:[Cp.of(!0),e?Do.of(Zf(t.state,e.query.spec)):G.appendConfig.of(XD)]});return!0},tS=t=>{let e=t.state.field(mr,!1);if(!e||!e.panel)return!1;let n=Co(t,Mp);return n&&n.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:Cp.of(!1)}),!0},KD=[{key:"Mod-f",run:eS,scope:"editor search-panel"},{key:"F3",run:iu,shift:su,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:iu,shift:su,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:tS,scope:"editor search-panel"},{key:"Mod-Shift-l",run:UD},{key:"Mod-Alt-g",run:bD},{key:"Mod-d",run:BD,preventDefault:!0}];class qD{constructor(e){this.view=e;let n=this.query=e.state.field(mr).query.spec;this.commit=this.commit.bind(this),this.searchField=ae("input",{value:n.search,placeholder:wt(e,"Find"),"aria-label":wt(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ae("input",{value:n.replace,placeholder:wt(e,"Replace"),"aria-label":wt(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=ae("input",{type:"checkbox",name:"case",form:"",checked:n.caseSensitive,onchange:this.commit}),this.reField=ae("input",{type:"checkbox",name:"re",form:"",checked:n.regexp,onchange:this.commit}),this.wordField=ae("input",{type:"checkbox",name:"word",form:"",checked:n.wholeWord,onchange:this.commit});function r(i,s,o){return ae("button",{class:"cm-button",name:i,onclick:s,type:"button"},o)}this.dom=ae("div",{onkeydown:i=>this.keydown(i),class:"cm-search"},[this.searchField,r("next",()=>iu(e),[wt(e,"next")]),r("prev",()=>su(e),[wt(e,"previous")]),r("select",()=>HD(e),[wt(e,"all")]),ae("label",null,[this.caseField,wt(e,"match case")]),ae("label",null,[this.reField,wt(e,"regexp")]),ae("label",null,[this.wordField,wt(e,"by word")]),...e.state.readOnly?[]:[ae("br"),this.replaceField,r("replace",()=>y0(e),[wt(e,"replace")]),r("replaceAll",()=>$D(e),[wt(e,"replace all")])],ae("button",{name:"close",onclick:()=>tS(e),"aria-label":wt(e,"close"),type:"button"},[""])])}commit(){let e=new Yx({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Do.of(e)}))}keydown(e){QM(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?su:iu)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),y0(this.view))}update(e){for(let n of e.transactions)for(let r of n.effects)r.is(Do)&&!r.value.eq(this.query)&&this.setQuery(r.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(ss).top}}function wt(t,e){return t.state.phrase(e)}const Nl=30,Ll=/[\s\.,:;?!]/;function Ap(t,{from:e,to:n}){let r=t.state.doc.lineAt(e),i=t.state.doc.lineAt(n).to,s=Math.max(r.from,e-Nl),o=Math.min(i,n+Nl),l=t.state.sliceDoc(s,o);if(s!=r.from){for(let a=0;a<Nl;a++)if(!Ll.test(l[a+1])&&Ll.test(l[a])){l=l.slice(a);break}}if(o!=i){for(let a=l.length-1;a>l.length-Nl;a--)if(!Ll.test(l[a-1])&&Ll.test(l[a])){l=l.slice(0,a);break}}return B.announce.of(`${t.state.phrase("current match")}. ${l} ${t.state.phrase("on line")} ${r.number}.`)}const GD=B.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),XD=[mr,ni.low(VD),GD];class nS{constructor(e,n,r,i){this.state=e,this.pos=n,this.explicit=r,this.view=i,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let n=Xe(this.state).resolveInner(this.pos,-1);for(;n&&e.indexOf(n.name)<0;)n=n.parent;return n?{from:n.from,to:this.pos,text:this.state.sliceDoc(n.from,this.pos),type:n.type}:null}matchBefore(e){let n=this.state.doc.lineAt(this.pos),r=Math.max(n.from,this.pos-250),i=n.text.slice(r-n.from,this.pos-n.from),s=i.search(rS(e,!1));return s<0?null:{from:r+s,to:this.pos,text:i.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,n,r){e=="abort"&&this.abortListeners&&(this.abortListeners.push(n),r&&r.onDocChange&&(this.abortOnDocChange=!0))}}function v0(t){let e=Object.keys(t).join(""),n=/\w/.test(e);return n&&(e=e.replace(/\w/g,"")),`[${n?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function YD(t){let e=Object.create(null),n=Object.create(null);for(let{label:i}of t){e[i[0]]=!0;for(let s=1;s<i.length;s++)n[i[s]]=!0}let r=v0(e)+v0(n)+"*$";return[new RegExp("^"+r),new RegExp(r)]}function QD(t){let e=t.map(i=>typeof i=="string"?{label:i}:i),[n,r]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:YD(e);return i=>{let s=i.matchBefore(r);return s||i.explicit?{from:s?s.from:i.pos,options:e,validFor:n}:null}}class w0{constructor(e,n,r,i){this.completion=e,this.source=n,this.match=r,this.score=i}}function Vr(t){return t.selection.main.from}function rS(t,e){var n;let{source:r}=t,i=e&&r[0]!="^",s=r[r.length-1]!="$";return!i&&!s?t:new RegExp(`${i?"^":""}(?:${r})${s?"$":""}`,(n=t.flags)!==null&&n!==void 0?n:t.ignoreCase?"i":"")}const iS=Mn.define();function JD(t,e,n,r){let{main:i}=t.selection,s=n-i.from,o=r-i.from;return{...t.changeByRange(l=>{if(l!=i&&n!=r&&t.sliceDoc(l.from+s,l.from+o)!=t.sliceDoc(n,r))return{range:l};let a=t.toText(e);return{changes:{from:l.from+s,to:r==i.from?l.to:l.from+o,insert:a},range:A.cursor(l.from+s+a.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const x0=new WeakMap;function ZD(t){if(!Array.isArray(t))return t;let e=x0.get(t);return e||x0.set(t,e=QD(t)),e}const ou=G.define(),To=G.define();class eT{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let n=0;n<e.length;){let r=ht(e,n),i=mn(r);this.chars.push(r);let s=e.slice(n,n+i),o=s.toUpperCase();this.folded.push(ht(o==s?s.toLowerCase():o,0)),n+=i}this.astral=e.length!=this.chars.length}ret(e,n){return this.score=e,this.matched=n,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:n,folded:r,any:i,precise:s,byWord:o}=this;if(n.length==1){let g=ht(e,0),v=mn(g),x=v==e.length?0:-100;if(g!=n[0])if(g==r[0])x+=-200;else return null;return this.ret(x,[0,v])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=n.length,u=0;if(l<0){for(let g=0,v=Math.min(e.length,200);g<v&&u<a;){let x=ht(e,g);(x==n[u]||x==r[u])&&(i[u++]=g),g+=mn(x)}if(u<a)return null}let c=0,h=0,f=!1,d=0,p=-1,y=-1,w=/[a-z]/.test(e),m=!0;for(let g=0,v=Math.min(e.length,200),x=0;g<v&&h<a;){let k=ht(e,g);l<0&&(c<a&&k==n[c]&&(s[c++]=g),d<a&&(k==n[d]||k==r[d]?(d==0&&(p=g),y=g+1,d++):d=0));let b,C=k<255?k>=48&&k<=57||k>=97&&k<=122?2:k>=65&&k<=90?1:0:(b=ep(k))!=b.toLowerCase()?1:b!=b.toUpperCase()?2:0;(!g||C==1&&w||x==0&&C!=0)&&(n[h]==k||r[h]==k&&(f=!0)?o[h++]=g:o.length&&(m=!1)),x=C,g+=mn(k)}return h==a&&o[0]==0&&m?this.result(-100+(f?-200:0),o,e):d==a&&p==0?this.ret(-200-e.length+(y==e.length?0:-100),[0,y]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):d==a?this.ret(-900-e.length,[p,y]):h==a?this.result(-100+(f?-200:0)+-700+(m?0:-1100),o,e):n.length==2?null:this.result((i[0]?-700:0)+-200+-1100,i,e)}result(e,n,r){let i=[],s=0;for(let o of n){let l=o+(this.astral?mn(ht(r,o)):1);s&&i[s-1]==o?i[s-1]=l:(i[s++]=o,i[s++]=l)}return this.ret(e-r.length,i)}}class tT{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let n=e.slice(0,this.pattern.length),r=n==this.pattern?0:n.toLowerCase()==this.folded?-200:null;return r==null?null:(this.matched=[0,n.length],this.score=r+(e.length==this.pattern.length?0:-100),this)}}const Re=I.define({combine(t){return An(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:nT,filterStrict:!1,compareCompletions:(e,n)=>e.label.localeCompare(n.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,n)=>e&&n,closeOnBlur:(e,n)=>e&&n,icons:(e,n)=>e&&n,tooltipClass:(e,n)=>r=>S0(e(r),n(r)),optionClass:(e,n)=>r=>S0(e(r),n(r)),addToOptions:(e,n)=>e.concat(n),filterStrict:(e,n)=>e||n})}});function S0(t,e){return t?e?t+" "+e:t:e}function nT(t,e,n,r,i,s){let o=t.textDirection==pe.RTL,l=o,a=!1,u="top",c,h,f=e.left-i.left,d=i.right-e.right,p=r.right-r.left,y=r.bottom-r.top;if(l&&f<Math.min(p,d)?l=!1:!l&&d<Math.min(p,f)&&(l=!0),p<=(l?f:d))c=Math.max(i.top,Math.min(n.top,i.bottom-y))-e.top,h=Math.min(400,l?f:d);else{a=!0,h=Math.min(400,(o?e.right:i.right-e.left)-30);let g=i.bottom-e.bottom;g>=y||g>e.top?c=n.bottom-e.top:(u="bottom",c=e.bottom-n.top)}let w=(e.bottom-e.top)/s.offsetHeight,m=(e.right-e.left)/s.offsetWidth;return{style:`${u}: ${c/w}px; max-width: ${h/m}px`,class:"cm-completionInfo-"+(a?o?"left-narrow":"right-narrow":l?"left":"right")}}function rT(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(n){let r=document.createElement("div");return r.classList.add("cm-completionIcon"),n.type&&r.classList.add(...n.type.split(/\s+/g).map(i=>"cm-completionIcon-"+i)),r.setAttribute("aria-hidden","true"),r},position:20}),e.push({render(n,r,i,s){let o=document.createElement("span");o.className="cm-completionLabel";let l=n.displayLabel||n.label,a=0;for(let u=0;u<s.length;){let c=s[u++],h=s[u++];c>a&&o.appendChild(document.createTextNode(l.slice(a,c)));let f=o.appendChild(document.createElement("span"));f.appendChild(document.createTextNode(l.slice(c,h))),f.className="cm-completionMatchedText",a=h}return a<l.length&&o.appendChild(document.createTextNode(l.slice(a))),o},position:50},{render(n){if(!n.detail)return null;let r=document.createElement("span");return r.className="cm-completionDetail",r.textContent=n.detail,r},position:80}),e.sort((n,r)=>n.position-r.position).map(n=>n.render)}function Kc(t,e,n){if(t<=n)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let i=Math.floor(e/n);return{from:i*n,to:(i+1)*n}}let r=Math.floor((t-e)/n);return{from:t-(r+1)*n,to:t-r*n}}class iT{constructor(e,n,r){this.view=e,this.stateField=n,this.applyCompletion=r,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let i=e.state.field(n),{options:s,selected:o}=i.open,l=e.state.facet(Re);this.optionContent=rT(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=Kc(s.length,o,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",a=>{let{options:u}=e.state.field(n).open;for(let c=a.target,h;c&&c!=this.dom;c=c.parentNode)if(c.nodeName=="LI"&&(h=/-(\d+)$/.exec(c.id))&&+h[1]<u.length){this.applyCompletion(e,u[+h[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let u=e.state.field(this.stateField,!1);u&&u.tooltip&&e.state.facet(Re).closeOnBlur&&a.relatedTarget!=e.contentDOM&&e.dispatch({effects:To.of(null)})}),this.showOptions(s,i.id)}mount(){this.updateSel()}showOptions(e,n){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,n,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var n;let r=e.state.field(this.stateField),i=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),r!=i){let{options:s,selected:o,disabled:l}=r.open;(!i.open||i.open.options!=s)&&(this.range=Kc(s.length,o,e.state.facet(Re).maxRenderedOptions),this.showOptions(s,r.id)),this.updateSel(),l!=((n=i.open)===null||n===void 0?void 0:n.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let n=this.tooltipClass(e);if(n!=this.currentClass){for(let r of this.currentClass.split(" "))r&&this.dom.classList.remove(r);for(let r of n.split(" "))r&&this.dom.classList.add(r);this.currentClass=n}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),n=e.open;(n.selected>-1&&n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=Kc(n.options.length,n.selected,this.view.state.facet(Re).maxRenderedOptions),this.showOptions(n.options,e.id));let r=this.updateSelectedOption(n.selected);if(r){this.destroyInfo();let{completion:i}=n.options[n.selected],{info:s}=i;if(!s)return;let o=typeof s=="string"?document.createTextNode(s):s(i);if(!o)return;"then"in o?o.then(l=>{l&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(l,i)}).catch(l=>pt(this.view.state,l,"completion info")):(this.addInfoPane(o,i),r.setAttribute("aria-describedby",this.info.id))}}addInfoPane(e,n){this.destroyInfo();let r=this.info=document.createElement("div");if(r.className="cm-tooltip cm-completionInfo",r.id="cm-completionInfo-"+Math.floor(Math.random()*65535).toString(16),e.nodeType!=null)r.appendChild(e),this.infoDestroy=null;else{let{dom:i,destroy:s}=e;r.appendChild(i),this.infoDestroy=s||null}this.dom.appendChild(r),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let n=null;for(let r=this.list.firstChild,i=this.range.from;r;r=r.nextSibling,i++)r.nodeName!="LI"||!r.id?i--:i==e?r.hasAttribute("aria-selected")||(r.setAttribute("aria-selected","true"),n=r):r.hasAttribute("aria-selected")&&(r.removeAttribute("aria-selected"),r.removeAttribute("aria-describedby"));return n&&oT(this.list,n),n}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let n=this.dom.getBoundingClientRect(),r=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.documentElement;s={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return i.top>Math.min(s.bottom,n.bottom)-10||i.bottom<Math.max(s.top,n.top)+10?null:this.view.state.facet(Re).positionInfo(this.view,n,i,r,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,n,r){const i=document.createElement("ul");i.id=n,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions")),i.addEventListener("mousedown",o=>{o.target==i&&o.preventDefault()});let s=null;for(let o=r.from;o<r.to;o++){let{completion:l,match:a}=e[o],{section:u}=l;if(u){let f=typeof u=="string"?u:u.name;if(f!=s&&(o>r.from||r.from==0))if(s=f,typeof u!="string"&&u.header)i.appendChild(u.header(u));else{let d=i.appendChild(document.createElement("completion-section"));d.textContent=f}}const c=i.appendChild(document.createElement("li"));c.id=n+"-"+o,c.setAttribute("role","option");let h=this.optionClass(l);h&&(c.className=h);for(let f of this.optionContent){let d=f(l,this.view.state,this.view,a);d&&c.appendChild(d)}}return r.from&&i.classList.add("cm-completionListIncompleteTop"),r.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function sT(t,e){return n=>new iT(n,t,e)}function oT(t,e){let n=t.getBoundingClientRect(),r=e.getBoundingClientRect(),i=n.height/t.offsetHeight;r.top<n.top?t.scrollTop-=(n.top-r.top)/i:r.bottom>n.bottom&&(t.scrollTop+=(r.bottom-n.bottom)/i)}function k0(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function lT(t,e){let n=[],r=null,i=null,s=c=>{n.push(c);let{section:h}=c.completion;if(h){r||(r=[]);let f=typeof h=="string"?h:h.name;r.some(d=>d.name==f)||r.push(typeof h=="string"?{name:f}:h)}},o=e.facet(Re);for(let c of t)if(c.hasResult()){let h=c.result.getMatch;if(c.result.filter===!1)for(let f of c.result.options)s(new w0(f,c.source,h?h(f):[],1e9-n.length));else{let f=e.sliceDoc(c.from,c.to),d,p=o.filterStrict?new tT(f):new eT(f);for(let y of c.result.options)if(d=p.match(y.label)){let w=y.displayLabel?h?h(y,d.matched):[]:d.matched,m=d.score+(y.boost||0);if(s(new w0(y,c.source,w,m)),typeof y.section=="object"&&y.section.rank==="dynamic"){let{name:g}=y.section;i||(i=Object.create(null)),i[g]=Math.max(m,i[g]||-1e9)}}}}if(r){let c=Object.create(null),h=0,f=(d,p)=>(d.rank==="dynamic"&&p.rank==="dynamic"?i[p.name]-i[d.name]:0)||(typeof d.rank=="number"?d.rank:1e9)-(typeof p.rank=="number"?p.rank:1e9)||(d.name<p.name?-1:1);for(let d of r.sort(f))h-=1e5,c[d.name]=h;for(let d of n){let{section:p}=d.completion;p&&(d.score+=c[typeof p=="string"?p:p.name])}}let l=[],a=null,u=o.compareCompletions;for(let c of n.sort((h,f)=>f.score-h.score||u(h.completion,f.completion))){let h=c.completion;!a||a.label!=h.label||a.detail!=h.detail||a.type!=null&&h.type!=null&&a.type!=h.type||a.apply!=h.apply||a.boost!=h.boost?l.push(c):k0(c.completion)>k0(a)&&(l[l.length-1]=c),a=c.completion}return l}class Ci{constructor(e,n,r,i,s,o){this.options=e,this.attrs=n,this.tooltip=r,this.timestamp=i,this.selected=s,this.disabled=o}setSelected(e,n){return e==this.selected||e>=this.options.length?this:new Ci(this.options,b0(n,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,n,r,i,s,o){if(i&&!o&&e.some(u=>u.isPending))return i.setDisabled();let l=lT(e,n);if(!l.length)return i&&e.some(u=>u.isPending)?i.setDisabled():null;let a=n.facet(Re).selectOnOpen?0:-1;if(i&&i.selected!=a&&i.selected!=-1){let u=i.options[i.selected].completion;for(let c=0;c<l.length;c++)if(l[c].completion==u){a=c;break}}return new Ci(l,b0(r,a),{pos:e.reduce((u,c)=>c.hasResult()?Math.min(u,c.from):u,1e8),create:dT,above:s.aboveCursor},i?i.timestamp:Date.now(),a,!1)}map(e){return new Ci(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new Ci(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class lu{constructor(e,n,r){this.active=e,this.id=n,this.open=r}static start(){return new lu(hT,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:n}=e,r=n.facet(Re),s=(r.override||n.languageDataAt("autocomplete",Vr(n)).map(ZD)).map(a=>(this.active.find(c=>c.source==a)||new _t(a,this.active.some(c=>c.state!=0)?1:0)).update(e,r));s.length==this.active.length&&s.every((a,u)=>a==this.active[u])&&(s=this.active);let o=this.open,l=e.effects.some(a=>a.is(Ep));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(a=>a.hasResult()&&e.changes.touchesRange(a.from,a.to))||!aT(s,this.active)||l?o=Ci.build(s,n,this.id,o,r,l):o&&o.disabled&&!s.some(a=>a.isPending)&&(o=null),!o&&s.every(a=>!a.isPending)&&s.some(a=>a.hasResult())&&(s=s.map(a=>a.hasResult()?new _t(a.source,0):a));for(let a of e.effects)a.is(oS)&&(o=o&&o.setSelected(a.value,this.id));return s==this.active&&o==this.open?this:new lu(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?uT:cT}}function aT(t,e){if(t==e)return!0;for(let n=0,r=0;;){for(;n<t.length&&!t[n].hasResult();)n++;for(;r<e.length&&!e[r].hasResult();)r++;let i=n==t.length,s=r==e.length;if(i||s)return i==s;if(t[n++].result!=e[r++].result)return!1}}const uT={"aria-autocomplete":"list"},cT={};function b0(t,e){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(n["aria-activedescendant"]=t+"-"+e),n}const hT=[];function sS(t,e){if(t.isUserEvent("input.complete")){let r=t.annotation(iS);if(r&&e.activateOnCompletion(r))return 12}let n=t.isUserEvent("input.type");return n&&e.activateOnTyping?5:n?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}class _t{constructor(e,n,r=!1){this.source=e,this.state=n,this.explicit=r}hasResult(){return!1}get isPending(){return this.state==1}update(e,n){let r=sS(e,n),i=this;(r&8||r&16&&this.touches(e))&&(i=new _t(i.source,0)),r&4&&i.state==0&&(i=new _t(this.source,1)),i=i.updateFor(e,r);for(let s of e.effects)if(s.is(ou))i=new _t(i.source,1,s.value);else if(s.is(To))i=new _t(i.source,0);else if(s.is(Ep))for(let o of s.value)o.source==i.source&&(i=o);return i}updateFor(e,n){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Vr(e.state))}}class Bi extends _t{constructor(e,n,r,i,s,o){super(e,3,n),this.limit=r,this.result=i,this.from=s,this.to=o}hasResult(){return!0}updateFor(e,n){var r;if(!(n&3))return this.map(e.changes);let i=this.result;i.map&&!e.changes.empty&&(i=i.map(i,e.changes));let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),l=Vr(e.state);if(l>o||!i||n&2&&(Vr(e.startState)==this.from||l<this.limit))return new _t(this.source,n&4?1:0);let a=e.changes.mapPos(this.limit);return fT(i.validFor,e.state,s,o)?new Bi(this.source,this.explicit,a,i,s,o):i.update&&(i=i.update(i,s,o,new nS(e.state,l,!1)))?new Bi(this.source,this.explicit,a,i,i.from,(r=i.to)!==null&&r!==void 0?r:Vr(e.state)):new _t(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new Bi(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new _t(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function fT(t,e,n,r){if(!t)return!1;let i=e.sliceDoc(n,r);return typeof t=="function"?t(i,n,r,e):rS(t,!0).test(i)}const Ep=G.define({map(t,e){return t.map(n=>n.map(e))}}),oS=G.define(),ft=We.define({create(){return lu.start()},update(t,e){return t.update(e)},provide:t=>[pp.from(t,e=>e.tooltip),B.contentAttributes.from(t,e=>e.attrs)]});function Pp(t,e){const n=e.completion.apply||e.completion.label;let r=t.state.field(ft).active.find(i=>i.source==e.source);return r instanceof Bi?(typeof n=="string"?t.dispatch({...JD(t.state,n,r.from,r.to),annotations:iS.of(e.completion)}):n(t,e.completion,r.from,r.to),!0):!1}const dT=sT(ft,Pp);function Bl(t,e="option"){return n=>{let r=n.state.field(ft,!1);if(!r||!r.open||r.open.disabled||Date.now()-r.open.timestamp<n.state.facet(Re).interactionDelay)return!1;let i=1,s;e=="page"&&(s=$w(n,r.open.tooltip))&&(i=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=r.open.options,l=r.open.selected>-1?r.open.selected+i*(t?1:-1):t?0:o-1;return l<0?l=e=="page"?0:o-1:l>=o&&(l=e=="page"?o-1:0),n.dispatch({effects:oS.of(l)}),!0}}const pT=t=>{let e=t.state.field(ft,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(Re).interactionDelay?!1:Pp(t,e.open.options[e.open.selected])},qc=t=>t.state.field(ft,!1)?(t.dispatch({effects:ou.of(!0)}),!0):!1,mT=t=>{let e=t.state.field(ft,!1);return!e||!e.active.some(n=>n.state!=0)?!1:(t.dispatch({effects:To.of(null)}),!0)};class gT{constructor(e,n){this.active=e,this.context=n,this.time=Date.now(),this.updates=[],this.done=void 0}}const yT=50,vT=1e3,wT=Ce.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of t.state.field(ft).active)e.isPending&&this.startQuery(e)}update(t){let e=t.state.field(ft),n=t.state.facet(Re);if(!t.selectionSet&&!t.docChanged&&t.startState.field(ft)==e)return;let r=t.transactions.some(s=>{let o=sS(s,n);return o&8||(s.selection||s.docChanged)&&!(o&3)});for(let s=0;s<this.running.length;s++){let o=this.running[s];if(r||o.context.abortOnDocChange&&t.docChanged||o.updates.length+t.transactions.length>yT&&Date.now()-o.time>vT){for(let l of o.context.abortListeners)try{l()}catch(a){pt(this.view.state,a)}o.context.abortListeners=null,this.running.splice(s--,1)}else o.updates.push(...t.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),t.transactions.some(s=>s.effects.some(o=>o.is(ou)))&&(this.pendingStart=!0);let i=this.pendingStart?50:n.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(s=>s.isPending&&!this.running.some(o=>o.active.source==s.source))?setTimeout(()=>this.startUpdate(),i):-1,this.composing!=0)for(let s of t.transactions)s.isUserEvent("input.type")?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:t}=this.view,e=t.field(ft);for(let n of e.active)n.isPending&&!this.running.some(r=>r.active.source==n.source)&&this.startQuery(n);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Re).updateSyncTime))}startQuery(t){let{state:e}=this.view,n=Vr(e),r=new nS(e,n,t.explicit,this.view),i=new gT(t,r);this.running.push(i),Promise.resolve(t.source(r)).then(s=>{i.context.aborted||(i.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:To.of(null)}),pt(this.view.state,s)})}scheduleAccept(){this.running.every(t=>t.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Re).updateSyncTime))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],n=this.view.state.facet(Re),r=this.view.state.field(ft);for(let i=0;i<this.running.length;i++){let s=this.running[i];if(s.done===void 0)continue;if(this.running.splice(i--,1),s.done){let l=Vr(s.updates.length?s.updates[0].startState:this.view.state),a=Math.min(l,s.done.from+(s.active.explicit?0:1)),u=new Bi(s.active.source,s.active.explicit,a,s.done,s.done.from,(t=s.done.to)!==null&&t!==void 0?t:l);for(let c of s.updates)u=u.update(c,n);if(u.hasResult()){e.push(u);continue}}let o=r.active.find(l=>l.source==s.active.source);if(o&&o.isPending)if(s.done==null){let l=new _t(s.active.source,0);for(let a of s.updates)l=l.update(a,n);l.isPending||e.push(l)}else this.startQuery(o)}(e.length||r.open&&r.open.disabled)&&this.view.dispatch({effects:Ep.of(e)})}},{eventHandlers:{blur(t){let e=this.view.state.field(ft,!1);if(e&&e.tooltip&&this.view.state.facet(Re).closeOnBlur){let n=e.open&&$w(this.view,e.open.tooltip);(!n||!n.dom.contains(t.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:To.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:ou.of(!1)}),20),this.composing=0}}}),xT=typeof navigator=="object"&&/Win/.test(navigator.platform),ST=ni.highest(B.domEventHandlers({keydown(t,e){let n=e.state.field(ft,!1);if(!n||!n.open||n.open.disabled||n.open.selected<0||t.key.length>1||t.ctrlKey&&!(xT&&t.altKey)||t.metaKey)return!1;let r=n.open.options[n.open.selected],i=n.active.find(o=>o.source==r.source),s=r.completion.commitCharacters||i.result.commitCharacters;return s&&s.indexOf(t.key)>-1&&Pp(e,r),!1}})),kT=B.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Oo={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},jr=G.define({map(t,e){let n=e.mapPos(t,-1,nt.TrackAfter);return n??void 0}}),Dp=new class extends Gr{};Dp.startSide=1;Dp.endSide=-1;const lS=We.define({create(){return ne.empty},update(t,e){if(t=t.map(e.changes),e.selection){let n=e.state.doc.lineAt(e.selection.main.head);t=t.update({filter:r=>r>=n.from&&r<=n.to})}for(let n of e.effects)n.is(jr)&&(t=t.update({add:[Dp.range(n.value,n.value+1)]}));return t}});function bT(){return[MT,lS]}const Gc="()[]{}<>";function aS(t){for(let e=0;e<Gc.length;e+=2)if(Gc.charCodeAt(e)==t)return Gc.charAt(e+1);return ep(t<128?t:t+1)}function uS(t,e){return t.languageDataAt("closeBrackets",e)[0]||Oo}const CT=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),MT=B.inputHandler.of((t,e,n,r)=>{if((CT?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let i=t.state.selection.main;if(r.length>2||r.length==2&&mn(ht(r,0))==1||e!=i.from||n!=i.to)return!1;let s=PT(t.state,r);return s?(t.dispatch(s),!0):!1}),AT=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=uS(t,t.selection.main.head).brackets||Oo.brackets,i=null,s=t.changeByRange(o=>{if(o.empty){let l=DT(t.doc,o.head);for(let a of r)if(a==l&&Uu(t.doc,o.head)==aS(ht(a,0)))return{changes:{from:o.head-a.length,to:o.head+a.length},range:A.cursor(o.head-a.length)}}return{range:i=o}});return i||e(t.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!i},ET=[{key:"Backspace",run:AT}];function PT(t,e){let n=uS(t,t.selection.main.head),r=n.brackets||Oo.brackets;for(let i of r){let s=aS(ht(i,0));if(e==i)return s==i?RT(t,i,r.indexOf(i+i+i)>-1,n):TT(t,i,s,n.before||Oo.before);if(e==s&&cS(t,t.selection.main.from))return OT(t,i,s)}return null}function cS(t,e){let n=!1;return t.field(lS).between(0,t.doc.length,r=>{r==e&&(n=!0)}),n}function Uu(t,e){let n=t.sliceString(e,e+2);return n.slice(0,mn(ht(n,0)))}function DT(t,e){let n=t.sliceString(e-2,e);return mn(ht(n,0))==n.length?n:n.slice(1)}function TT(t,e,n,r){let i=null,s=t.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:n,from:o.to}],effects:jr.of(o.to+e.length),range:A.range(o.anchor+e.length,o.head+e.length)};let l=Uu(t.doc,o.head);return!l||/\s/.test(l)||r.indexOf(l)>-1?{changes:{insert:e+n,from:o.head},effects:jr.of(o.head+e.length),range:A.cursor(o.head+e.length)}:{range:i=o}});return i?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function OT(t,e,n){let r=null,i=t.changeByRange(s=>s.empty&&Uu(t.doc,s.head)==n?{changes:{from:s.head,to:s.head+n.length,insert:n},range:A.cursor(s.head+n.length)}:r={range:s});return r?null:t.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function RT(t,e,n,r){let i=r.stringPrefixes||Oo.stringPrefixes,s=null,o=t.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:jr.of(l.to+e.length),range:A.range(l.anchor+e.length,l.head+e.length)};let a=l.head,u=Uu(t.doc,a),c;if(u==e){if(C0(t,a))return{changes:{insert:e+e,from:a},effects:jr.of(a+e.length),range:A.cursor(a+e.length)};if(cS(t,a)){let f=n&&t.sliceDoc(a,a+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+f.length,insert:f},range:A.cursor(a+f.length)}}}else{if(n&&t.sliceDoc(a-2*e.length,a)==e+e&&(c=M0(t,a-2*e.length,i))>-1&&C0(t,c))return{changes:{insert:e+e+e+e,from:a},effects:jr.of(a+e.length),range:A.cursor(a+e.length)};if(t.charCategorizer(a)(u)!=ye.Word&&M0(t,a,i)>-1&&!NT(t,a,e,i))return{changes:{insert:e+e,from:a},effects:jr.of(a+e.length),range:A.cursor(a+e.length)}}return{range:s=l}});return s?null:t.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function C0(t,e){let n=Xe(t).resolveInner(e+1);return n.parent&&n.from==e}function NT(t,e,n,r){let i=Xe(t).resolveInner(e,-1),s=r.reduce((o,l)=>Math.max(o,l.length),0);for(let o=0;o<5;o++){let l=t.sliceDoc(i.from,Math.min(i.to,i.from+n.length+s)),a=l.indexOf(n);if(!a||a>-1&&r.indexOf(l.slice(0,a))>-1){let c=i.firstChild;for(;c&&c.from==i.from&&c.to-c.from>n.length+a;){if(t.sliceDoc(c.to-n.length,c.to)==n)return!1;c=c.firstChild}return!0}let u=i.to==e&&i.parent;if(!u)break;i=u}return!1}function M0(t,e,n){let r=t.charCategorizer(e);if(r(t.sliceDoc(e-1,e))!=ye.Word)return e;for(let i of n){let s=e-i.length;if(t.sliceDoc(s,e)==i&&r(t.sliceDoc(s-1,s))!=ye.Word)return s}return-1}function LT(t={}){return[ST,ft,Re.of(t),wT,BT,kT]}const hS=[{key:"Ctrl-Space",run:qc},{mac:"Alt-`",run:qc},{mac:"Alt-i",run:qc},{key:"Escape",run:mT},{key:"ArrowDown",run:Bl(!0)},{key:"ArrowUp",run:Bl(!1)},{key:"PageDown",run:Bl(!0,"page")},{key:"PageUp",run:Bl(!1,"page")},{key:"Enter",run:pT}],BT=ni.highest(Bu.computeN([Re],t=>t.facet(Re).defaultKeymap?[hS]:[]));class A0{constructor(e,n,r){this.from=e,this.to=n,this.diagnostic=r}}class Nr{constructor(e,n,r){this.diagnostics=e,this.panel=n,this.selected=r}static init(e,n,r){let i=r.facet(Ro).markerFilter;i&&(e=i(e,r));let s=e.slice().sort((d,p)=>d.from-p.from||d.to-p.to),o=new zn,l=[],a=0,u=r.doc.iter(),c=0,h=r.doc.length;for(let d=0;;){let p=d==s.length?null:s[d];if(!p&&!l.length)break;let y,w;if(l.length)y=a,w=l.reduce((v,x)=>Math.min(v,x.to),p&&p.from>y?p.from:1e8);else{if(y=p.from,y>h)break;w=p.to,l.push(p),d++}for(;d<s.length;){let v=s[d];if(v.from==y&&(v.to>v.from||v.to==y))l.push(v),d++,w=Math.min(v.to,w);else{w=Math.min(v.from,w);break}}w=Math.min(w,h);let m=!1;if(l.some(v=>v.from==y&&(v.to==w||w==h))&&(m=y==w,!m&&w-y<10)){let v=y-(c+u.value.length);v>0&&(u.next(v),c=y);for(let x=y;;){if(x>=w){m=!0;break}if(!u.lineBreak&&c+u.value.length>x)break;x=c+u.value.length,c+=u.value.length,u.next()}}let g=GT(l);if(m)o.add(y,y,$.widget({widget:new UT(g),diagnostics:l.slice()}));else{let v=l.reduce((x,k)=>k.markClass?x+" "+k.markClass:x,"");o.add(y,w,$.mark({class:"cm-lintRange cm-lintRange-"+g+v,diagnostics:l.slice(),inclusiveEnd:l.some(x=>x.to>w)}))}if(a=w,a==h)break;for(let v=0;v<l.length;v++)l[v].to<=a&&l.splice(v--,1)}let f=o.finish();return new Nr(f,n,Zi(f))}}function Zi(t,e=null,n=0){let r=null;return t.between(n,1e9,(i,s,{spec:o})=>{if(!(e&&o.diagnostics.indexOf(e)<0))if(!r)r=new A0(i,s,e||o.diagnostics[0]);else{if(o.diagnostics.indexOf(r.diagnostic)<0)return!1;r=new A0(r.from,s,r.diagnostic)}}),r}function _T(t,e){let n=e.pos,r=e.end||n,i=t.state.facet(Ro).hideOn(t,n,r);if(i!=null)return i;let s=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(o=>o.is(fS))||t.changes.touchesRange(s.from,Math.max(s.to,r)))}function IT(t,e){return t.field(bt,!1)?e:e.concat(G.appendConfig.of(XT))}const fS=G.define(),Tp=G.define(),dS=G.define(),bt=We.define({create(){return new Nr($.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let n=t.diagnostics.map(e.changes),r=null,i=t.panel;if(t.selected){let s=e.changes.mapPos(t.selected.from,1);r=Zi(n,t.selected.diagnostic,s)||Zi(n,null,s)}!n.size&&i&&e.state.facet(Ro).autoPanel&&(i=null),t=new Nr(n,i,r)}for(let n of e.effects)if(n.is(fS)){let r=e.state.facet(Ro).autoPanel?n.value.length?No.open:null:t.panel;t=Nr.init(n.value,r,e.state)}else n.is(Tp)?t=new Nr(t.diagnostics,n.value?No.open:null,t.selected):n.is(dS)&&(t=new Nr(t.diagnostics,t.panel,n.value));return t},provide:t=>[Mo.from(t,e=>e.panel),B.decorations.from(t,e=>e.diagnostics)]}),jT=$.mark({class:"cm-lintRange cm-lintRange-active"});function FT(t,e,n){let{diagnostics:r}=t.state.field(bt),i,s=-1,o=-1;r.between(e-(n<0?1:0),e+(n>0?1:0),(a,u,{spec:c})=>{if(e>=a&&e<=u&&(a==u||(e>a||n>0)&&(e<u||n<0)))return i=c.diagnostics,s=a,o=u,!1});let l=t.state.facet(Ro).tooltipFilter;return i&&l&&(i=l(i,t.state)),i?{pos:s,end:o,above:t.state.doc.lineAt(s).to<o,create(){return{dom:zT(t,i)}}}:null}function zT(t,e){return ae("ul",{class:"cm-tooltip-lint"},e.map(n=>mS(t,n,!1)))}const WT=t=>{let e=t.state.field(bt,!1);(!e||!e.panel)&&t.dispatch({effects:IT(t.state,[Tp.of(!0)])});let n=Co(t,No.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},E0=t=>{let e=t.state.field(bt,!1);return!e||!e.panel?!1:(t.dispatch({effects:Tp.of(!1)}),!0)},VT=t=>{let e=t.state.field(bt,!1);if(!e)return!1;let n=t.state.selection.main,r=e.diagnostics.iter(n.to+1);return!r.value&&(r=e.diagnostics.iter(0),!r.value||r.from==n.from&&r.to==n.to)?!1:(t.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),!0)},HT=[{key:"Mod-Shift-m",run:WT,preventDefault:!0},{key:"F8",run:VT}],Ro=I.define({combine(t){return{sources:t.map(e=>e.source).filter(e=>e!=null),...An(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:P0,tooltipFilter:P0,needsRefresh:(e,n)=>e?n?r=>e(r)||n(r):e:n,hideOn:(e,n)=>e?n?(r,i,s)=>e(r,i,s)||n(r,i,s):e:n,autoPanel:(e,n)=>e||n})}}});function P0(t,e){return t?e?(n,r)=>e(t(n,r),r):t:e}function pS(t){let e=[];if(t)e:for(let{name:n}of t){for(let r=0;r<n.length;r++){let i=n[r];if(/[a-zA-Z]/.test(i)&&!e.some(s=>s.toLowerCase()==i.toLowerCase())){e.push(i);continue e}}e.push("")}return e}function mS(t,e,n){var r;let i=n?pS(e.actions):[];return ae("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},ae("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),(r=e.actions)===null||r===void 0?void 0:r.map((s,o)=>{let l=!1,a=d=>{if(d.preventDefault(),l)return;l=!0;let p=Zi(t.state.field(bt).diagnostics,e);p&&s.apply(t,p.from,p.to)},{name:u}=s,c=i[o]?u.indexOf(i[o]):-1,h=c<0?u:[u.slice(0,c),ae("u",u.slice(c,c+1)),u.slice(c+1)],f=s.markClass?" "+s.markClass:"";return ae("button",{type:"button",class:"cm-diagnosticAction"+f,onclick:a,onmousedown:a,"aria-label":` Action: ${u}${c<0?"":` (access key "${i[o]})"`}.`},h)}),e.source&&ae("div",{class:"cm-diagnosticSource"},e.source))}class UT extends Un{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return ae("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class D0{constructor(e,n){this.diagnostic=n,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=mS(e,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class No{constructor(e){this.view=e,this.items=[];let n=i=>{if(i.keyCode==27)E0(this.view),this.view.focus();else if(i.keyCode==38||i.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(i.keyCode==40||i.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(i.keyCode==36)this.moveSelection(0);else if(i.keyCode==35)this.moveSelection(this.items.length-1);else if(i.keyCode==13)this.view.focus();else if(i.keyCode>=65&&i.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=pS(s.actions);for(let l=0;l<o.length;l++)if(o[l].toUpperCase().charCodeAt(0)==i.keyCode){let a=Zi(this.view.state.field(bt).diagnostics,s);a&&s.actions[l].apply(e,a.from,a.to)}}else return;i.preventDefault()},r=i=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(i.target)&&this.moveSelection(s)};this.list=ae("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:n,onclick:r}),this.dom=ae("div",{class:"cm-panel-lint"},this.list,ae("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>E0(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(bt).selected;if(!e)return-1;for(let n=0;n<this.items.length;n++)if(this.items[n].diagnostic==e.diagnostic)return n;return-1}update(){let{diagnostics:e,selected:n}=this.view.state.field(bt),r=0,i=!1,s=null,o=new Set;for(e.between(0,this.view.state.doc.length,(l,a,{spec:u})=>{for(let c of u.diagnostics){if(o.has(c))continue;o.add(c);let h=-1,f;for(let d=r;d<this.items.length;d++)if(this.items[d].diagnostic==c){h=d;break}h<0?(f=new D0(this.view,c),this.items.splice(r,0,f),i=!0):(f=this.items[h],h>r&&(this.items.splice(r,h-r),i=!0)),n&&f.diagnostic==n.diagnostic?f.dom.hasAttribute("aria-selected")||(f.dom.setAttribute("aria-selected","true"),s=f):f.dom.hasAttribute("aria-selected")&&f.dom.removeAttribute("aria-selected"),r++}});r<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();this.items.length==0&&(this.items.push(new D0(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:l,panel:a})=>{let u=a.height/this.list.offsetHeight;l.top<a.top?this.list.scrollTop-=(a.top-l.top)/u:l.bottom>a.bottom&&(this.list.scrollTop+=(l.bottom-a.bottom)/u)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let e=this.list.firstChild;function n(){let r=e;e=r.nextSibling,r.remove()}for(let r of this.items)if(r.dom.parentNode==this.list){for(;e!=r.dom;)n();e=r.dom.nextSibling}else this.list.insertBefore(r.dom,e);for(;e;)n()}moveSelection(e){if(this.selectedIndex<0)return;let n=this.view.state.field(bt),r=Zi(n.diagnostics,this.items[e].diagnostic);r&&this.view.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:dS.of(r)})}static open(e){return new No(e)}}function $T(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function _l(t){return $T(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const KT=B.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:_l("#d11")},".cm-lintRange-warning":{backgroundImage:_l("orange")},".cm-lintRange-info":{backgroundImage:_l("#999")},".cm-lintRange-hint":{backgroundImage:_l("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function qT(t){return t=="error"?4:t=="warning"?3:t=="info"?2:1}function GT(t){let e="hint",n=1;for(let r of t){let i=qT(r.severity);i>n&&(n=i,e=r.severity)}return e}const XT=[bt,B.decorations.compute([bt],t=>{let{selected:e,panel:n}=t.field(bt);return!e||!n||e.from==e.to?$.none:$.set([jT.range(e.from,e.to)])}),FA(FT,{hideOn:_T}),KT];var T0=function(e){e===void 0&&(e={});var{crosshairCursor:n=!1}=e,r=[];e.closeBracketsKeymap!==!1&&(r=r.concat(ET)),e.defaultKeymap!==!1&&(r=r.concat(xD)),e.searchKeymap!==!1&&(r=r.concat(KD)),e.historyKeymap!==!1&&(r=r.concat(EP)),e.foldKeymap!==!1&&(r=r.concat(WE)),e.completionKeymap!==!1&&(r=r.concat(hS)),e.lintKeymap!==!1&&(r=r.concat(HT));var i=[];return e.lineNumbers!==!1&&i.push(YA()),e.highlightActiveLineGutter!==!1&&i.push(ZA()),e.highlightSpecialChars!==!1&&i.push(pA()),e.history!==!1&&i.push(vP()),e.foldGutter!==!1&&i.push($E()),e.drawSelection!==!1&&i.push(rA()),e.dropCursor!==!1&&i.push(aA()),e.allowMultipleSelections!==!1&&i.push(ee.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&i.push(OE()),e.syntaxHighlighting!==!1&&i.push(cx(XE,{fallback:!0})),e.bracketMatching!==!1&&i.push(nP()),e.closeBrackets!==!1&&i.push(bT()),e.autocompletion!==!1&&i.push(LT()),e.rectangularSelection!==!1&&i.push(PA()),n!==!1&&i.push(OA()),e.highlightActiveLine!==!1&&i.push(xA()),e.highlightSelectionMatches!==!1&&i.push(ED()),e.tabSize&&typeof e.tabSize=="number"&&i.push(Iu.of(" ".repeat(e.tabSize))),i.concat([Bu.of(r.flat())]).filter(Boolean)};const YT="#e5c07b",O0="#e06c75",QT="#56b6c2",JT="#ffffff",ma="#abb2bf",ed="#7d8799",ZT="#61afef",eO="#98c379",R0="#d19a66",tO="#c678dd",nO="#21252b",N0="#2c313a",L0="#282c34",Xc="#353a42",rO="#3E4451",B0="#528bff",iO=B.theme({"&":{color:ma,backgroundColor:L0},".cm-content":{caretColor:B0},".cm-cursor, .cm-dropCursor":{borderLeftColor:B0},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:rO},".cm-panels":{backgroundColor:nO,color:ma},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:L0,color:ed,border:"none"},".cm-activeLineGutter":{backgroundColor:N0},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Xc},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Xc,borderBottomColor:Xc},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:N0,color:ma}}},{dark:!0}),sO=$o.define([{tag:M.keyword,color:tO},{tag:[M.name,M.deleted,M.character,M.propertyName,M.macroName],color:O0},{tag:[M.function(M.variableName),M.labelName],color:ZT},{tag:[M.color,M.constant(M.name),M.standard(M.name)],color:R0},{tag:[M.definition(M.name),M.separator],color:ma},{tag:[M.typeName,M.className,M.number,M.changed,M.annotation,M.modifier,M.self,M.namespace],color:YT},{tag:[M.operator,M.operatorKeyword,M.url,M.escape,M.regexp,M.link,M.special(M.string)],color:QT},{tag:[M.meta,M.comment],color:ed},{tag:M.strong,fontWeight:"bold"},{tag:M.emphasis,fontStyle:"italic"},{tag:M.strikethrough,textDecoration:"line-through"},{tag:M.link,color:ed,textDecoration:"underline"},{tag:M.heading,fontWeight:"bold",color:O0},{tag:[M.atom,M.bool,M.special(M.variableName)],color:R0},{tag:[M.processingInstruction,M.string,M.inserted],color:eO},{tag:M.invalid,color:JT}]),oO=[iO,cx(sO)];var lO=B.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),aO=function(e){e===void 0&&(e={});var{indentWithTab:n=!0,editable:r=!0,readOnly:i=!1,theme:s="light",placeholder:o="",basicSetup:l=!0}=e,a=[];switch(n&&a.unshift(Bu.of([SD])),l&&(typeof l=="boolean"?a.unshift(T0()):a.unshift(T0(l))),o&&a.unshift(CA(o)),s){case"light":a.push(lO);break;case"dark":a.push(oO);break;case"none":break;default:a.push(s);break}return r===!1&&a.push(B.editable.of(!1)),i&&a.push(ee.readOnly.of(!0)),[...a]},uO=t=>({line:t.state.doc.lineAt(t.state.selection.main.from),lineCount:t.state.doc.lines,lineBreak:t.state.lineBreak,length:t.state.doc.length,readOnly:t.state.readOnly,tabSize:t.state.tabSize,selection:t.state.selection,selectionAsSingle:t.state.selection.asSingle().main,ranges:t.state.selection.ranges,selectionCode:t.state.sliceDoc(t.state.selection.main.from,t.state.selection.main.to),selections:t.state.selection.ranges.map(e=>t.state.sliceDoc(e.from,e.to)),selectedText:t.state.selection.ranges.some(e=>!e.empty)});class cO{constructor(e,n){this.timeLeftMS=void 0,this.timeoutMS=void 0,this.isCancelled=!1,this.isTimeExhausted=!1,this.callbacks=[],this.timeLeftMS=n,this.timeoutMS=n,this.callbacks.push(e)}tick(){if(!this.isCancelled&&!this.isTimeExhausted&&(this.timeLeftMS--,this.timeLeftMS<=0)){this.isTimeExhausted=!0;var e=this.callbacks.slice();this.callbacks.length=0,e.forEach(n=>{try{n()}catch(r){console.error("TimeoutLatch callback error:",r)}})}}cancel(){this.isCancelled=!0,this.callbacks.length=0}reset(){this.timeLeftMS=this.timeoutMS,this.isCancelled=!1,this.isTimeExhausted=!1}get isDone(){return this.isCancelled||this.isTimeExhausted}}class _0{constructor(){this.interval=null,this.latches=new Set}add(e){this.latches.add(e),this.start()}remove(e){this.latches.delete(e),this.latches.size===0&&this.stop()}start(){this.interval===null&&(this.interval=setInterval(()=>{this.latches.forEach(e=>{e.tick(),e.isDone&&this.remove(e)})},1))}stop(){this.interval!==null&&(clearInterval(this.interval),this.interval=null)}}var Yc=null,hO=()=>typeof window>"u"?new _0:(Yc||(Yc=new _0),Yc),I0=Mn.define(),fO=200,dO=[];function pO(t){var{value:e,selection:n,onChange:r,onStatistics:i,onCreateEditor:s,onUpdate:o,extensions:l=dO,autoFocus:a,theme:u="light",height:c=null,minHeight:h=null,maxHeight:f=null,width:d=null,minWidth:p=null,maxWidth:y=null,placeholder:w="",editable:m=!0,readOnly:g=!1,indentWithTab:v=!0,basicSetup:x=!0,root:k,initialState:b}=t,[C,E]=W.useState(),[O,N]=W.useState(),[V,j]=W.useState(),D=W.useState(()=>({current:null}))[0],H=W.useState(()=>({current:null}))[0],Y=B.theme({"&":{height:c,minHeight:h,maxHeight:f,width:d,minWidth:p,maxWidth:y},"& .cm-scroller":{height:"100% !important"}}),U=B.updateListener.of(L=>{if(L.docChanged&&typeof r=="function"&&!L.transactions.some(q=>q.annotation(I0))){D.current?D.current.reset():(D.current=new cO(()=>{if(H.current){var q=H.current;H.current=null,q()}D.current=null},fO),hO().add(D.current));var z=L.state.doc,K=z.toString();r(K,L)}i&&i(uO(L))}),X=aO({theme:u,editable:m,readOnly:g,placeholder:w,indentWithTab:v,basicSetup:x}),T=[U,Y,...X];return o&&typeof o=="function"&&T.push(B.updateListener.of(o)),T=T.concat(l),W.useLayoutEffect(()=>{if(C&&!V){var L={doc:e,selection:n,extensions:T},z=b?ee.fromJSON(b.json,L,b.fields):ee.create(L);if(j(z),!O){var K=new B({state:z,parent:C,root:k});N(K),s&&s(K,z)}}return()=>{O&&(j(void 0),N(void 0))}},[C,V]),W.useEffect(()=>{t.container&&E(t.container)},[t.container]),W.useEffect(()=>()=>{O&&(O.destroy(),N(void 0)),D.current&&(D.current.cancel(),D.current=null)},[O]),W.useEffect(()=>{a&&O&&O.focus()},[a,O]),W.useEffect(()=>{O&&O.dispatch({effects:G.reconfigure.of(T)})},[u,l,c,h,f,d,p,y,w,m,g,v,x,r,o]),W.useEffect(()=>{if(e!==void 0){var L=O?O.state.doc.toString():"";if(O&&e!==L){var z=D.current&&!D.current.isDone,K=()=>{O&&e!==O.state.doc.toString()&&O.dispatch({changes:{from:0,to:O.state.doc.toString().length,insert:e||""},annotations:[I0.of(!0)]})};z?H.current=K:K()}}},[e,O]),{state:V,setState:j,view:O,setView:N,container:C,setContainer:E}}var mO=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],gS=W.forwardRef((t,e)=>{var{className:n,value:r="",selection:i,extensions:s=[],onChange:o,onStatistics:l,onCreateEditor:a,onUpdate:u,autoFocus:c,theme:h="light",height:f,minHeight:d,maxHeight:p,width:y,minWidth:w,maxWidth:m,basicSetup:g,placeholder:v,indentWithTab:x,editable:k,readOnly:b,root:C,initialState:E}=t,O=JC(t,mO),N=W.useRef(null),{state:V,view:j,container:D,setContainer:H}=pO({root:C,value:r,autoFocus:c,theme:h,height:f,minHeight:d,maxHeight:p,width:y,minWidth:w,maxWidth:m,basicSetup:g,placeholder:v,indentWithTab:x,editable:k,readOnly:b,selection:i,onChange:o,onStatistics:l,onCreateEditor:a,onUpdate:u,extensions:s,initialState:E});W.useImperativeHandle(e,()=>({editor:N.current,state:V,view:j}),[N,D,V,j]);var Y=W.useCallback(X=>{N.current=X,H(X)},[H]);if(typeof r!="string")throw new Error("value must be typeof string but got "+typeof r);var U=typeof h=="string"?"cm-theme-"+h:"cm-theme";return S.jsx("div",rf({ref:Y,className:""+U+(n?" "+n:"")},O))});gS.displayName="CodeMirror";function gO({shader:t,onChange:e,readOnly:n}){return S.jsxs("div",{className:"h-full flex flex-col",children:[S.jsxs("div",{className:"bg-gray-800 px-4 py-2 border-b border-gray-700 flex items-center justify-between",children:[S.jsx("h2",{className:"text-sm font-semibold",children:"Fragment Shader (WGSL)"}),S.jsx("button",{onClick:()=>{navigator.clipboard.writeText(t)},className:"text-xs px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded transition-colors",disabled:!t,children:"Copy"})]}),S.jsx("div",{className:"flex-1 overflow-auto",children:S.jsx(gS,{value:t,height:"100%",theme:"dark",extensions:[B.lineWrapping],onChange:e,readOnly:n,basicSetup:{lineNumbers:!0,highlightActiveLineGutter:!0,highlightActiveLine:!0,foldGutter:!0,dropCursor:!0,indentOnInput:!0,syntaxHighlighting:!0,bracketMatching:!0,autocompletion:!0},placeholder:"Your generated shader will appear here...",className:"code-editor"})})]})}function yO({shader:t,vertexShader:e,customUniforms:n}){const r=W.useRef(null),i=W.useRef(null),[s,o]=W.useState(null),[l,a]=W.useState(!1);return W.useEffect(()=>{const u=r.current;return u?((async()=>{try{i.current||(i.current=new qC,await i.current.initialize(u))}catch(h){o(h instanceof Error?h.message:"Failed to initialize WebGPU")}})(),()=>{i.current&&(i.current.destroy(),i.current=null)}):void 0},[]),W.useEffect(()=>{if(!t||!i.current)return;(async()=>{o(null),a(!0);try{await i.current.renderShader(e,t)}catch(c){o(c instanceof Error?c.message:"Failed to render shader")}finally{a(!1)}})()},[t,e]),W.useEffect(()=>{n&&i.current&&i.current.updateCustomUniforms(n)},[n]),W.useEffect(()=>{const u=r.current;if(!u)return;const c=new ResizeObserver(h=>{for(const f of h){const{width:d,height:p}=f.contentRect;u.width=d*devicePixelRatio,u.height=p*devicePixelRatio}});return c.observe(u),()=>{c.disconnect()}},[]),S.jsxs("div",{className:"relative w-full h-full",children:[S.jsx("canvas",{ref:r,className:"w-full h-full",style:{imageRendering:"pixelated"}}),!t&&S.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:S.jsx("p",{className:"text-gray-400",children:"Generate a shader to see preview"})}),l&&S.jsx("div",{className:"absolute top-4 right-4 bg-blue-600 text-white text-xs px-3 py-1 rounded-full",children:"Rendering..."}),s&&S.jsxs("div",{className:"absolute bottom-4 left-4 right-4 bg-red-900/90 border border-red-500 text-red-200 text-sm p-3 rounded",children:[S.jsx("strong",{children:"Render Error:"})," ",s]})]})}function vO({shader:t,onValuesChange:e}){const[n,r]=W.useState([]),[i,s]=W.useState({});W.useEffect(()=>{const u=w1(t);r(u);const c={};u.forEach(h=>{c[h.name]=h.defaultValue}),s(c),u.length>0&&e(c)},[t,e]);const o=(u,c)=>{const h={...i,[u]:c};s(h),e(h)},l=(u,c)=>{const h=parseFloat(c);isNaN(h)||o(u,h)},a=(u,c,h)=>{const f=parseFloat(h);if(!isNaN(f)){const p=[...i[u]];p[c]=f,o(u,p)}};return n.length===0?null:S.jsxs("div",{className:"p-4 bg-gray-800 border-b border-gray-700",children:[S.jsx("h3",{className:"text-sm font-semibold mb-3 text-gray-200",children:"Shader Uniforms"}),S.jsx("div",{className:"space-y-3 max-h-48 overflow-y-auto",children:n.map(u=>S.jsxs("div",{className:"space-y-1",children:[S.jsx("label",{className:"text-xs font-medium text-gray-300 capitalize",children:u.name.replace(/([A-Z])/g," $1").trim()}),(u.type==="f32"||u.type==="i32"||u.type==="u32")&&S.jsxs("div",{className:"flex items-center gap-2",children:[S.jsx("input",{type:"range",min:u.min,max:u.max,step:u.step,value:i[u.name],onChange:c=>l(u.name,c.target.value),className:"flex-1 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-blue-500"}),S.jsx("input",{type:"number",min:u.min,max:u.max,step:u.step,value:i[u.name],onChange:c=>l(u.name,c.target.value),className:"w-16 px-2 py-1 text-xs bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),u.type==="vec2<f32>"&&S.jsx("div",{className:"grid grid-cols-2 gap-2",children:["x","y"].map((c,h)=>S.jsxs("div",{children:[S.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:c}),S.jsx("input",{type:"number",min:u.min,max:u.max,step:u.step,value:i[u.name][h],onChange:f=>a(u.name,h,f.target.value),className:"w-full px-2 py-1 text-xs bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]},c))}),u.type==="vec3<f32>"&&S.jsx("div",{className:"grid grid-cols-3 gap-2",children:["x","y","z"].map((c,h)=>S.jsxs("div",{children:[S.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:c}),S.jsx("input",{type:"number",min:u.min,max:u.max,step:u.step,value:i[u.name][h],onChange:f=>a(u.name,h,f.target.value),className:"w-full px-2 py-1 text-xs bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]},c))}),u.type==="vec4<f32>"&&S.jsx("div",{className:"grid grid-cols-4 gap-2",children:["x","y","z","w"].map((c,h)=>S.jsxs("div",{children:[S.jsx("label",{className:"text-xs text-gray-400 block mb-1",children:c}),S.jsx("input",{type:"number",min:u.min,max:u.max,step:u.step,value:i[u.name][h],onChange:f=>a(u.name,h,f.target.value),className:"w-full px-2 py-1 text-xs bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]},c))})]},u.name))})]})}const wO="ShaderLM",xO=1,Ut="projects";let Il=null;async function Go(){return Il||new Promise((t,e)=>{const n=indexedDB.open(wO,xO);n.onerror=()=>{e(new Error("Failed to open IndexedDB"))},n.onsuccess=()=>{Il=n.result,t(Il)},n.onupgradeneeded=r=>{const i=r.target.result;if(!i.objectStoreNames.contains(Ut)){const s=i.createObjectStore(Ut,{keyPath:"id",autoIncrement:!0});s.createIndex("name","name",{unique:!1}),s.createIndex("createdAt","createdAt",{unique:!1}),s.createIndex("updatedAt","updatedAt",{unique:!1})}}})}async function j0(t){const e=await Go();return new Promise((n,r)=>{const s=e.transaction([Ut],"readwrite").objectStore(Ut),o={...t,updatedAt:Date.now()},l=s.add(o);l.onsuccess=()=>{n(l.result)},l.onerror=()=>{r(new Error("Failed to save project"))}})}async function SO(t){if(!t.id)throw new Error("Project ID is required for update");const e=await Go();return new Promise((n,r)=>{const s=e.transaction([Ut],"readwrite").objectStore(Ut),o={...t,updatedAt:Date.now()},l=s.put(o);l.onsuccess=()=>{n()},l.onerror=()=>{r(new Error("Failed to update project"))}})}async function kO(t){const e=await Go();return new Promise((n,r)=>{const o=e.transaction([Ut],"readonly").objectStore(Ut).get(t);o.onsuccess=()=>{n(o.result||null)},o.onerror=()=>{r(new Error("Failed to load project"))}})}async function bO(){const t=await Go();return new Promise((e,n)=>{const s=t.transaction([Ut],"readonly").objectStore(Ut).getAll();s.onsuccess=()=>{const o=s.result||[];o.sort((l,a)=>a.updatedAt-l.updatedAt),e(o)},s.onerror=()=>{n(new Error("Failed to load projects"))}})}async function CO(t){const e=await Go();return new Promise((n,r)=>{const o=e.transaction([Ut],"readwrite").objectStore(Ut).delete(t);o.onsuccess=()=>{n()},o.onerror=()=>{r(new Error("Failed to delete project"))}})}function MO(t){return JSON.stringify(t,null,2)}function AO(t){const e=JSON.parse(t),{id:n,...r}=e;if(!e.name||!e.shader||!e.messages)throw new Error("Invalid project format");return{...r,createdAt:Date.now(),updatedAt:Date.now()}}function EO({isOpen:t,onClose:e,currentShader:n,currentVertexShader:r,currentMessages:i,currentUniforms:s,onLoadProject:o,currentProjectId:l}){const[a,u]=W.useState([]),[c,h]=W.useState(!1),[f,d]=W.useState(!1),[p,y]=W.useState(!1),[w,m]=W.useState(""),[g,v]=W.useState(""),[x,k]=W.useState("");W.useEffect(()=>{t&&b()},[t]);const b=async()=>{h(!0);try{const D=await bO();u(D)}catch(D){console.error("Failed to load projects:",D)}finally{h(!1)}},C=async()=>{if(!w.trim()){alert("Please enter a project name");return}d(!0);try{const D={name:w.trim(),description:g.trim()||void 0,shader:n,vertexShader:r,messages:i,customUniforms:s,createdAt:Date.now(),updatedAt:Date.now()};l?await SO({...D,id:l}):await j0(D),y(!1),m(""),v(""),await b()}catch(D){console.error("Failed to save project:",D),alert("Failed to save project")}finally{d(!1)}},E=async D=>{try{const H=await kO(D);H&&(o(H),e())}catch(H){console.error("Failed to load project:",H),alert("Failed to load project")}},O=async D=>{if(window.confirm("Are you sure you want to delete this project?"))try{await CO(D),await b()}catch(H){console.error("Failed to delete project:",H),alert("Failed to delete project")}},N=D=>{const H=MO(D),Y=new Blob([H],{type:"application/json"}),U=URL.createObjectURL(Y),X=document.createElement("a");X.href=U,X.download=`${D.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.json`,X.click(),URL.revokeObjectURL(U)},V=()=>{const D=document.createElement("input");D.type="file",D.accept=".json",D.onchange=async H=>{var U;const Y=(U=H.target.files)==null?void 0:U[0];if(Y)try{const X=await Y.text(),T=AO(X);await j0(T),await b()}catch(X){console.error("Failed to import project:",X),alert("Failed to import project. Please check the file format.")}},D.click()},j=x?a.filter(D=>{var H;return D.name.toLowerCase().includes(x.toLowerCase())||((H=D.description)==null?void 0:H.toLowerCase().includes(x.toLowerCase()))}):a;return t?S.jsxs("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:[S.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[80vh] flex flex-col",children:[S.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[S.jsx("h2",{className:"text-xl font-bold text-white",children:"Project Manager"}),S.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:S.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),S.jsxs("div",{className:"p-4 border-b border-gray-700 space-y-3",children:[S.jsxs("div",{className:"flex gap-2",children:[S.jsx("button",{onClick:()=>y(!0),disabled:!n,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded font-medium transition-colors",children:"Save Current Project"}),S.jsx("button",{onClick:V,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded font-medium transition-colors",children:"Import"})]}),S.jsx("input",{type:"text",placeholder:"Search projects...",value:x,onChange:D=>k(D.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 text-white placeholder-gray-400"})]}),S.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:c?S.jsx("div",{className:"text-center text-gray-400 py-8",children:"Loading projects..."}):j.length===0?S.jsx("div",{className:"text-center text-gray-400 py-8",children:x?"No projects found":"No saved projects yet"}):S.jsx("div",{className:"space-y-3",children:j.map(D=>S.jsx("div",{className:"bg-gray-700 rounded-lg p-4 hover:bg-gray-600 transition-colors",children:S.jsxs("div",{className:"flex items-start justify-between",children:[S.jsxs("div",{className:"flex-1",children:[S.jsx("h3",{className:"font-semibold text-white",children:D.name}),D.description&&S.jsx("p",{className:"text-sm text-gray-400 mt-1",children:D.description}),S.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-gray-500",children:[S.jsxs("span",{children:["Created: ",new Date(D.createdAt).toLocaleDateString()]}),S.jsxs("span",{children:["Updated: ",new Date(D.updatedAt).toLocaleDateString()]}),S.jsxs("span",{children:[D.messages.length," messages"]})]})]}),S.jsxs("div",{className:"flex gap-2 ml-4",children:[S.jsx("button",{onClick:()=>E(D.id),className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-sm transition-colors",children:"Load"}),S.jsx("button",{onClick:()=>N(D),className:"px-3 py-1 bg-gray-800 hover:bg-gray-900 rounded text-sm transition-colors",title:"Export as JSON",children:"Export"}),S.jsx("button",{onClick:()=>O(D.id),className:"px-3 py-1 bg-red-600 hover:bg-red-700 rounded text-sm transition-colors",children:"Delete"})]})]})},D.id))})})]}),p&&S.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:S.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6",children:[S.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Save Project"}),S.jsxs("div",{className:"space-y-4",children:[S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Project Name *"}),S.jsx("input",{type:"text",value:w,onChange:D=>m(D.target.value),placeholder:"My Awesome Shader",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 text-white placeholder-gray-400",autoFocus:!0})]}),S.jsxs("div",{children:[S.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description (optional)"}),S.jsx("textarea",{value:g,onChange:D=>v(D.target.value),placeholder:"A beautiful animated gradient shader...",rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 text-white placeholder-gray-400 resize-none"})]}),S.jsxs("div",{className:"flex gap-2 justify-end",children:[S.jsx("button",{onClick:()=>{y(!1),m(""),v("")},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded font-medium transition-colors",children:"Cancel"}),S.jsx("button",{onClick:C,disabled:!w.trim()||f,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded font-medium transition-colors",children:f?"Saving...":"Save"})]})]})]})})]}):null}function F0({onResize:t}){const e=W.useRef(!1),n=W.useRef(0);W.useEffect(()=>{const i=o=>{if(!e.current)return;const l=o.clientX-n.current;n.current=o.clientX,t(l)},s=()=>{e.current=!1,document.body.style.cursor="",document.body.style.userSelect=""};return document.addEventListener("mousemove",i),document.addEventListener("mouseup",s),()=>{document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",s)}},[t]);const r=i=>{e.current=!0,n.current=i.clientX,document.body.style.cursor="col-resize",document.body.style.userSelect="none",i.preventDefault()};return S.jsx("div",{onMouseDown:r,className:"w-1 bg-gray-700 hover:bg-blue-500 cursor-col-resize transition-colors flex-shrink-0 group relative",children:S.jsx("div",{className:"absolute inset-y-0 -left-1 -right-1"})})}const ai="0.27.3";let z0=!1,Zs,yS,td,vS,wS,xS;function PO(t,e={auto:!1}){if(z0)throw new Error(`you must \`import '@anthropic-ai/sdk/shims/${t.kind}'\` before importing anything else from @anthropic-ai/sdk`);if(Zs)throw new Error(`can't \`import '@anthropic-ai/sdk/shims/${t.kind}'\` after \`import '@anthropic-ai/sdk/shims/${Zs}'\``);z0=e.auto,Zs=t.kind,yS=t.fetch,td=t.File,vS=t.ReadableStream,wS=t.getDefaultAgent,xS=t.fileFromPath}class DO{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function TO({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import  from '@anthropic-ai/sdk'`:\n- `import '@anthropic-ai/sdk/shims/node'` (if you're running on Node)\n- `import '@anthropic-ai/sdk/shims/web'` (otherwise)\n";let n,r,i,s;try{n=fetch,r=Request,i=Response,s=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:i,Headers:s,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new DO(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/anthropics/anthropic-sdk-typescript#file-uploads")},isFsReadStream:o=>!1}}Zs||PO(TO(),{auto:!0});class xn{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let s=!1;try{for await(const o of OO(e,n)){if(o.event==="completion")try{yield JSON.parse(o.data)}catch(l){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),l}if(o.event==="message_start"||o.event==="message_delta"||o.event==="message_stop"||o.event==="content_block_start"||o.event==="content_block_delta"||o.event==="content_block_stop")try{yield JSON.parse(o.data)}catch(l){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),l}if(o.event!=="ping"&&o.event==="error")throw Ye.generate(void 0,`SSE Error: ${o.data}`,o.data,bS(e.headers))}s=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{s||n.abort()}}return new xn(i,n)}static fromReadableStream(e,n){let r=!1;async function*i(){const o=new Zr,l=SS(e);for await(const a of l)for(const u of o.decode(a))yield u;for(const a of o.flush())yield a}async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const l of i())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||n.abort()}}return new xn(s,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),i=s=>({next:()=>{if(s.length===0){const o=r.next();e.push(o),n.push(o)}return s.shift()}});return[new xn(()=>i(e),this.controller),new xn(()=>i(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new vS({async start(){n=e[Symbol.asyncIterator]()},async pull(i){try{const{value:s,done:o}=await n.next();if(o)return i.close();const l=r.encode(JSON.stringify(s)+`
`);i.enqueue(l)}catch(s){i.error(s)}},async cancel(){var i;await((i=n.return)==null?void 0:i.call(n))}})}}async function*OO(t,e){if(!t.body)throw e.abort(),new se("Attempted to iterate over a response with no body");const n=new LO,r=new Zr,i=SS(t.body);for await(const s of RO(i))for(const o of r.decode(s)){const l=n.decode(o);l&&(yield l)}for(const s of r.flush()){const o=n.decode(s);o&&(yield o)}}async function*RO(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let i=new Uint8Array(e.length+r.length);i.set(e),i.set(r,e.length),e=i;let s;for(;(s=NO(e))!==-1;)yield e.slice(0,s),e=e.slice(s)}e.length>0&&(yield e)}function NO(t){for(let r=0;r<t.length-2;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}class LO{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,i]=BO(e,":");return i.startsWith(" ")&&(i=i.substring(1)),n==="event"?this.event=i:n==="data"&&this.data.push(i),null}}class Zr{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let n=this.decodeText(e);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=Zr.NEWLINE_CHARS.has(n[n.length-1]||"");let i=n.split(Zr.NEWLINE_REGEXP);return r&&i.pop(),i.length===1&&!r?(this.buffer.push(i[0]),[]):(this.buffer.length>0&&(i=[this.buffer.join("")+i[0],...i.slice(1)],this.buffer=[]),r||(this.buffer=[i.pop()||""]),i)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new se(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new se(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new se("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Zr.NEWLINE_CHARS=new Set([`
`,"\r"]);Zr.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function BO(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}function SS(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const _O=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",IO=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&$u(t),$u=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function";async function jO(t,e,n){var i;if(t=await t,IO(t))return t;if(_O(t)){const s=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=$u(s)?[await s.arrayBuffer()]:[s];return new td(o,e,n)}const r=await FO(t);if(e||(e=WO(t)??"unknown_file"),!(n!=null&&n.type)){const s=(i=r[0])==null?void 0:i.type;typeof s=="string"&&(n={...n,type:s})}return new td(r,e,n)}async function FO(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if($u(t))e.push(await t.arrayBuffer());else if(VO(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(n=t==null?void 0:t.constructor)==null?void 0:n.name}; props: ${zO(t)}`);return e}function zO(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function WO(t){var e;return Qc(t.name)||Qc(t.filename)||((e=Qc(t.path))==null?void 0:e.split(/[\\/]/).pop())}const Qc=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},VO=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",W0=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody";var _i={};async function kS(t){const{response:e}=t;if(t.options.stream)return Ii("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):xn.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type");if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.includes("application/vnd.api+json"))){const s=await e.json();return Ii("response",e.status,e.url,e.headers,s),s}const i=await e.text();return Ii("response",e.status,e.url,e.headers,i),i}class Ku extends Promise{constructor(e,n=kS){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new Ku(this.responsePromise,async n=>e(await this.parseResponse(n)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class HO{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:i,fetch:s}){this.baseURL=e,this.maxRetries=Jc("maxRetries",n),this.timeout=Jc("timeout",r),this.httpAgent=i,this.fetch=s??yS}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...qO(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${ZO()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(async i=>{const s=i&&$u(i==null?void 0:i.body)?new DataView(await i.body.arrayBuffer()):(i==null?void 0:i.body)instanceof DataView?i.body:(i==null?void 0:i.body)instanceof ArrayBuffer?new DataView(i.body):i&&ArrayBuffer.isView(i==null?void 0:i.body)?new DataView(i.body.buffer):i==null?void 0:i.body;return{method:e,path:n,...i,body:s}}))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e){var p;const{method:n,path:r,query:i,headers:s={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:W0(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,l=this.calculateContentLength(o),a=this.buildURL(r,i);"timeout"in e&&Jc("timeout",e.timeout);const u=e.timeout??this.timeout,c=e.httpAgent??this.httpAgent??wS(a),h=u+1e3;typeof((p=c==null?void 0:c.options)==null?void 0:p.timeout)=="number"&&h>(c.options.timeout??0)&&(c.options.timeout=h),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);const f=this.buildHeaders({options:e,headers:s,contentLength:l});return{req:{method:n,...o&&{body:o},headers:f,...c&&{agent:c},signal:e.signal??null},url:a,timeout:u}}buildHeaders({options:e,headers:n,contentLength:r}){const i={};r&&(i["content-length"]=r);const s=this.defaultHeaders(e);return $0(i,s),$0(i,n),W0(e.body)&&Zs!=="node"&&delete i["content-type"],this.validateHeaders(i,n),i}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,i){return Ye.generate(e,n,r,i)}request(e,n=null){return new Ku(this.makeRequest(e,n))}async makeRequest(e,n){var c,h;const r=await e;n==null&&(n=r.maxRetries??this.maxRetries),await this.prepareOptions(r);const{req:i,url:s,timeout:o}=this.buildRequest(r);if(await this.prepareRequest(i,{url:s,options:r}),Ii("request",s,r,i.headers),(c=r.signal)!=null&&c.aborted)throw new Qt;const l=new AbortController,a=await this.fetchWithTimeout(s,i,o,l).catch(nd);if(a instanceof Error){if((h=r.signal)!=null&&h.aborted)throw new Qt;if(n)return this.retryRequest(r,n);throw a.name==="AbortError"?new CS:new qu({cause:a})}const u=bS(a.headers);if(!a.ok){if(n&&this.shouldRetry(a)){const m=`retrying, ${n} attempts remaining`;return Ii(`response (error; ${m})`,a.status,s,u),this.retryRequest(r,n,u)}const f=await a.text().catch(m=>nd(m).message),d=GO(f),p=d?void 0:f;throw Ii(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,a.status,s,u,p),this.makeStatusError(a.status,d,p,u)}return{response:a,options:r,controller:l}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new UO(this,r,e)}buildURL(e,n){const r=YO(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return rd(i)||(n={...i,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new se(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,i){const{signal:s,...o}=n||{};s&&s.addEventListener("abort",()=>i.abort());const l=setTimeout(()=>i.abort(),r);return this.getRequestClient().fetch.call(void 0,e,{signal:i.signal,...o}).finally(()=>{clearTimeout(l)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let i;const s=r==null?void 0:r["retry-after-ms"];if(s){const l=parseFloat(s);Number.isNaN(l)||(i=l)}const o=r==null?void 0:r["retry-after"];if(o&&!i){const l=parseFloat(o);Number.isNaN(l)?i=Date.parse(o)-Date.now():i=l*1e3}if(!(i&&0<=i&&i<60*1e3)){const l=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(n,l)}return await QO(i),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const s=n-e,o=Math.min(.5*Math.pow(2,s),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${ai}`}}class UO extends Ku{constructor(e,n,r){super(n,async i=>new r(e,i.response,await kS(i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const bS=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),$O=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ai,"X-Stainless-OS":H0(Deno.build.os),"X-Stainless-Arch":V0(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ai,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ai,"X-Stainless-OS":H0(process.platform),"X-Stainless-Arch":V0(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=KO();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ai,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ai,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function KO(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const i=r[1]||0,s=r[2]||0,o=r[3]||0;return{browser:e,version:`${i}.${s}.${o}`}}}return null}const V0=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",H0=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let U0;const qO=()=>U0??(U0=$O()),GO=t=>{try{return JSON.parse(t)}catch{return}},XO=new RegExp("^(?:[a-z]+:)?//","i"),YO=t=>XO.test(t),QO=t=>new Promise(e=>setTimeout(e,t)),Jc=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new se(`${t} must be an integer`);if(e<0)throw new se(`${t} must be a positive integer`);return e},nd=t=>t instanceof Error?t:new Error(t),Zc=t=>{var e,n,r,i;if(typeof process<"u")return((e=_i==null?void 0:_i[t])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(i=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,t))==null?void 0:i.trim()};function rd(t){if(!t)return!0;for(const e in t)return!1;return!0}function JO(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $0(t,e){for(const n in e){if(!JO(e,n))continue;const r=n.toLowerCase();if(!r)continue;const i=e[n];i===null?delete t[r]:i!==void 0&&(t[r]=i)}}function Ii(t,...e){typeof process<"u"&&(_i==null?void 0:_i.DEBUG)==="true"&&console.log(`Anthropic:DEBUG:${t}`,...e)}const ZO=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),eR=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";class se extends Error{}class Ye extends se{constructor(e,n,r,i){super(`${Ye.makeMessage(e,n,r)}`),this.status=e,this.headers=i,this.request_id=i==null?void 0:i["request-id"],this.error=n}static makeMessage(e,n,r){const i=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,n,r,i){if(!e)return new qu({message:r,cause:nd(n)});const s=n;return e===400?new MS(e,s,r,i):e===401?new AS(e,s,r,i):e===403?new ES(e,s,r,i):e===404?new PS(e,s,r,i):e===409?new DS(e,s,r,i):e===422?new TS(e,s,r,i):e===429?new OS(e,s,r,i):e>=500?new RS(e,s,r,i):new Ye(e,s,r,i)}}class Qt extends Ye{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class qu extends Ye{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,n&&(this.cause=n)}}class CS extends qu{constructor({message:e}={}){super({message:e??"Request timed out."})}}class MS extends Ye{constructor(){super(...arguments),this.status=400}}class AS extends Ye{constructor(){super(...arguments),this.status=401}}class ES extends Ye{constructor(){super(...arguments),this.status=403}}class PS extends Ye{constructor(){super(...arguments),this.status=404}}class DS extends Ye{constructor(){super(...arguments),this.status=409}}class TS extends Ye{constructor(){super(...arguments),this.status=422}}class OS extends Ye{constructor(){super(...arguments),this.status=429}}class RS extends Ye{}class Xo{constructor(e){this._client=e}}const tR=t=>{let e=0,n=[];for(;e<t.length;){let r=t[e];if(r==="\\"){e++;continue}if(r==="{"){n.push({type:"brace",value:"{"}),e++;continue}if(r==="}"){n.push({type:"brace",value:"}"}),e++;continue}if(r==="["){n.push({type:"paren",value:"["}),e++;continue}if(r==="]"){n.push({type:"paren",value:"]"}),e++;continue}if(r===":"){n.push({type:"separator",value:":"}),e++;continue}if(r===","){n.push({type:"delimiter",value:","}),e++;continue}if(r==='"'){let l="",a=!1;for(r=t[++e];r!=='"';){if(e===t.length){a=!0;break}if(r==="\\"){if(e++,e===t.length){a=!0;break}l+=r+t[e],r=t[++e]}else l+=r,r=t[++e]}r=t[++e],a||n.push({type:"string",value:l});continue}if(r&&/\s/.test(r)){e++;continue}let s=/[0-9]/;if(r&&s.test(r)||r==="-"||r==="."){let l="";for(r==="-"&&(l+=r,r=t[++e]);r&&s.test(r)||r===".";)l+=r,r=t[++e];n.push({type:"number",value:l});continue}let o=/[a-z]/i;if(r&&o.test(r)){let l="";for(;r&&o.test(r)&&e!==t.length;)l+=r,r=t[++e];if(l=="true"||l=="false"||l==="null")n.push({type:"name",value:l});else{e++;continue}continue}e++}return n},ui=t=>{if(t.length===0)return t;let e=t[t.length-1];switch(e.type){case"separator":return t=t.slice(0,t.length-1),ui(t);case"number":let n=e.value[e.value.length-1];if(n==="."||n==="-")return t=t.slice(0,t.length-1),ui(t);case"string":let r=t[t.length-2];if((r==null?void 0:r.type)==="delimiter")return t=t.slice(0,t.length-1),ui(t);if((r==null?void 0:r.type)==="brace"&&r.value==="{")return t=t.slice(0,t.length-1),ui(t);break;case"delimiter":return t=t.slice(0,t.length-1),ui(t)}return t},nR=t=>{let e=[];return t.map(n=>{n.type==="brace"&&(n.value==="{"?e.push("}"):e.splice(e.lastIndexOf("}"),1)),n.type==="paren"&&(n.value==="["?e.push("]"):e.splice(e.lastIndexOf("]"),1))}),e.length>0&&e.reverse().map(n=>{n==="}"?t.push({type:"brace",value:"}"}):n==="]"&&t.push({type:"paren",value:"]"})}),t},rR=t=>{let e="";return t.map(n=>{switch(n.type){case"string":e+='"'+n.value+'"';break;default:e+=n.value;break}}),e},NS=t=>JSON.parse(rR(nR(ui(tR(t)))));var at=function(t,e,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n},J=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Dt,Kn,jl,Fl,xs,Ss,zl,ks,En,bs,Wl,Vl,ii,eh,K0,th,nh,rh,ih,q0;const G0="__json_buf";class au{constructor(){Dt.add(this),this.messages=[],this.receivedMessages=[],Kn.set(this,void 0),this.controller=new AbortController,jl.set(this,void 0),Fl.set(this,()=>{}),xs.set(this,()=>{}),Ss.set(this,void 0),zl.set(this,()=>{}),ks.set(this,()=>{}),En.set(this,{}),bs.set(this,!1),Wl.set(this,!1),Vl.set(this,!1),ii.set(this,!1),th.set(this,e=>{if(at(this,Wl,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Qt),e instanceof Qt)return at(this,Vl,!0,"f"),this._emit("abort",e);if(e instanceof se)return this._emit("error",e);if(e instanceof Error){const n=new se(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new se(String(e)))}),at(this,jl,new Promise((e,n)=>{at(this,Fl,e,"f"),at(this,xs,n,"f")}),"f"),at(this,Ss,new Promise((e,n)=>{at(this,zl,e,"f"),at(this,ks,n,"f")}),"f"),J(this,jl,"f").catch(()=>{}),J(this,Ss,"f").catch(()=>{})}static fromReadableStream(e){const n=new au;return n._run(()=>n._fromReadableStream(e)),n}static createMessage(e,n,r){const i=new au;for(const s of n.messages)i._addPromptCachingBetaMessageParam(s);return i._run(()=>i._createPromptCachingBetaMessage(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),i}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},J(this,th,"f"))}_addPromptCachingBetaMessageParam(e){this.messages.push(e)}_addPromptCachingBetaMessage(e,n=!0){this.receivedMessages.push(e),n&&this._emit("message",e)}async _createPromptCachingBetaMessage(e,n,r){var o;const i=r==null?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),J(this,Dt,"m",nh).call(this);const s=await e.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const l of s)J(this,Dt,"m",rh).call(this,l);if((o=s.controller.signal)!=null&&o.aborted)throw new Qt;J(this,Dt,"m",ih).call(this)}_connected(){this.ended||(J(this,Fl,"f").call(this),this._emit("connect"))}get ended(){return J(this,bs,"f")}get errored(){return J(this,Wl,"f")}get aborted(){return J(this,Vl,"f")}abort(){this.controller.abort()}on(e,n){return(J(this,En,"f")[e]||(J(this,En,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=J(this,En,"f")[e];if(!r)return this;const i=r.findIndex(s=>s.listener===n);return i>=0&&r.splice(i,1),this}once(e,n){return(J(this,En,"f")[e]||(J(this,En,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{at(this,ii,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){at(this,ii,!0,"f"),await J(this,Ss,"f")}get currentMessage(){return J(this,Kn,"f")}async finalMessage(){return await this.done(),J(this,Dt,"m",eh).call(this)}async finalText(){return await this.done(),J(this,Dt,"m",K0).call(this)}_emit(e,...n){if(J(this,bs,"f"))return;e==="end"&&(at(this,bs,!0,"f"),J(this,zl,"f").call(this));const r=J(this,En,"f")[e];if(r&&(J(this,En,"f")[e]=r.filter(i=>!i.once),r.forEach(({listener:i})=>i(...n))),e==="abort"){const i=n[0];!J(this,ii,"f")&&!(r!=null&&r.length)&&Promise.reject(i),J(this,xs,"f").call(this,i),J(this,ks,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=n[0];!J(this,ii,"f")&&!(r!=null&&r.length)&&Promise.reject(i),J(this,xs,"f").call(this,i),J(this,ks,"f").call(this,i),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalPromptCachingBetaMessage",J(this,Dt,"m",eh).call(this))}async _fromReadableStream(e,n){var s;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),J(this,Dt,"m",nh).call(this),this._connected();const i=xn.fromReadableStream(e,this.controller);for await(const o of i)J(this,Dt,"m",rh).call(this,o);if((s=i.controller.signal)!=null&&s.aborted)throw new Qt;J(this,Dt,"m",ih).call(this)}[(Kn=new WeakMap,jl=new WeakMap,Fl=new WeakMap,xs=new WeakMap,Ss=new WeakMap,zl=new WeakMap,ks=new WeakMap,En=new WeakMap,bs=new WeakMap,Wl=new WeakMap,Vl=new WeakMap,ii=new WeakMap,th=new WeakMap,Dt=new WeakSet,eh=function(){if(this.receivedMessages.length===0)throw new se("stream ended without producing a PromptCachingBetaMessage with role=assistant");return this.receivedMessages.at(-1)},K0=function(){if(this.receivedMessages.length===0)throw new se("stream ended without producing a PromptCachingBetaMessage with role=assistant");const n=this.receivedMessages.at(-1).content.filter(r=>r.type==="text").map(r=>r.text);if(n.length===0)throw new se("stream ended without producing a content block with type=text");return n.join(" ")},nh=function(){this.ended||at(this,Kn,void 0,"f")},rh=function(n){if(this.ended)return;const r=J(this,Dt,"m",q0).call(this,n);switch(this._emit("streamEvent",n,r),n.type){case"content_block_delta":{const i=r.content.at(-1);n.delta.type==="text_delta"&&i.type==="text"?this._emit("text",n.delta.text,i.text||""):n.delta.type==="input_json_delta"&&i.type==="tool_use"&&i.input&&this._emit("inputJson",n.delta.partial_json,i.input);break}case"message_stop":{this._addPromptCachingBetaMessageParam(r),this._addPromptCachingBetaMessage(r,!0);break}case"content_block_stop":{this._emit("contentBlock",r.content.at(-1));break}case"message_start":{at(this,Kn,r,"f");break}}},ih=function(){if(this.ended)throw new se("stream has ended, this shouldn't happen");const n=J(this,Kn,"f");if(!n)throw new se("request ended without sending any chunks");return at(this,Kn,void 0,"f"),n},q0=function(n){let r=J(this,Kn,"f");if(n.type==="message_start"){if(r)throw new se(`Unexpected event order, got ${n.type} before receiving "message_stop"`);return n.message}if(!r)throw new se(`Unexpected event order, got ${n.type} before "message_start"`);switch(n.type){case"message_stop":return r;case"message_delta":return r.stop_reason=n.delta.stop_reason,r.stop_sequence=n.delta.stop_sequence,r.usage.output_tokens=n.usage.output_tokens,r;case"content_block_start":return r.content.push(n.content_block),r;case"content_block_delta":{const i=r.content.at(n.index);if((i==null?void 0:i.type)==="text"&&n.delta.type==="text_delta")i.text+=n.delta.text;else if((i==null?void 0:i.type)==="tool_use"&&n.delta.type==="input_json_delta"){let s=i[G0]||"";s+=n.delta.partial_json,Object.defineProperty(i,G0,{value:s,enumerable:!1,writable:!0}),s&&(i.input=NS(s))}return r}case"content_block_stop":return r}},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("streamEvent",i=>{const s=n.shift();s?s.resolve(i):e.push(i)}),this.on("end",()=>{r=!0;for(const i of n)i.resolve(void 0);n.length=0}),this.on("abort",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),this.on("error",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,o)=>n.push({resolve:s,reject:o})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new xn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}let uu=class extends Xo{create(e,n){return this._client.post("/v1/messages?beta=prompt_caching",{body:e,timeout:this._client._options.timeout??6e5,...n,headers:{"anthropic-beta":"prompt-caching-2024-07-31",...n==null?void 0:n.headers},stream:e.stream??!1})}stream(e,n){return au.createMessage(this,e,n)}};uu||(uu={});class cu extends Xo{constructor(){super(...arguments),this.messages=new uu(this._client)}}(function(t){t.Messages=uu})(cu||(cu={}));class hu extends Xo{constructor(){super(...arguments),this.promptCaching=new cu(this._client)}}(function(t){t.PromptCaching=cu})(hu||(hu={}));class fu extends Xo{create(e,n){return this._client.post("/v1/complete",{body:e,timeout:this._client._options.timeout??6e5,...n,stream:e.stream??!1})}}fu||(fu={});var ut=function(t,e,n,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(t,n):i?i.value=n:e.set(t,n),n},Z=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Tt,qn,Hl,Ul,Cs,Ms,$l,As,Pn,Es,Kl,ql,si,sh,X0,oh,lh,ah,uh,Y0;const Q0="__json_buf";class du{constructor(){Tt.add(this),this.messages=[],this.receivedMessages=[],qn.set(this,void 0),this.controller=new AbortController,Hl.set(this,void 0),Ul.set(this,()=>{}),Cs.set(this,()=>{}),Ms.set(this,void 0),$l.set(this,()=>{}),As.set(this,()=>{}),Pn.set(this,{}),Es.set(this,!1),Kl.set(this,!1),ql.set(this,!1),si.set(this,!1),oh.set(this,e=>{if(ut(this,Kl,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Qt),e instanceof Qt)return ut(this,ql,!0,"f"),this._emit("abort",e);if(e instanceof se)return this._emit("error",e);if(e instanceof Error){const n=new se(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new se(String(e)))}),ut(this,Hl,new Promise((e,n)=>{ut(this,Ul,e,"f"),ut(this,Cs,n,"f")}),"f"),ut(this,Ms,new Promise((e,n)=>{ut(this,$l,e,"f"),ut(this,As,n,"f")}),"f"),Z(this,Hl,"f").catch(()=>{}),Z(this,Ms,"f").catch(()=>{})}static fromReadableStream(e){const n=new du;return n._run(()=>n._fromReadableStream(e)),n}static createMessage(e,n,r){const i=new du;for(const s of n.messages)i._addMessageParam(s);return i._run(()=>i._createMessage(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),i}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},Z(this,oh,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,n=!0){this.receivedMessages.push(e),n&&this._emit("message",e)}async _createMessage(e,n,r){var o;const i=r==null?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),Z(this,Tt,"m",lh).call(this);const s=await e.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const l of s)Z(this,Tt,"m",ah).call(this,l);if((o=s.controller.signal)!=null&&o.aborted)throw new Qt;Z(this,Tt,"m",uh).call(this)}_connected(){this.ended||(Z(this,Ul,"f").call(this),this._emit("connect"))}get ended(){return Z(this,Es,"f")}get errored(){return Z(this,Kl,"f")}get aborted(){return Z(this,ql,"f")}abort(){this.controller.abort()}on(e,n){return(Z(this,Pn,"f")[e]||(Z(this,Pn,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=Z(this,Pn,"f")[e];if(!r)return this;const i=r.findIndex(s=>s.listener===n);return i>=0&&r.splice(i,1),this}once(e,n){return(Z(this,Pn,"f")[e]||(Z(this,Pn,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{ut(this,si,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){ut(this,si,!0,"f"),await Z(this,Ms,"f")}get currentMessage(){return Z(this,qn,"f")}async finalMessage(){return await this.done(),Z(this,Tt,"m",sh).call(this)}async finalText(){return await this.done(),Z(this,Tt,"m",X0).call(this)}_emit(e,...n){if(Z(this,Es,"f"))return;e==="end"&&(ut(this,Es,!0,"f"),Z(this,$l,"f").call(this));const r=Z(this,Pn,"f")[e];if(r&&(Z(this,Pn,"f")[e]=r.filter(i=>!i.once),r.forEach(({listener:i})=>i(...n))),e==="abort"){const i=n[0];!Z(this,si,"f")&&!(r!=null&&r.length)&&Promise.reject(i),Z(this,Cs,"f").call(this,i),Z(this,As,"f").call(this,i),this._emit("end");return}if(e==="error"){const i=n[0];!Z(this,si,"f")&&!(r!=null&&r.length)&&Promise.reject(i),Z(this,Cs,"f").call(this,i),Z(this,As,"f").call(this,i),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",Z(this,Tt,"m",sh).call(this))}async _fromReadableStream(e,n){var s;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Z(this,Tt,"m",lh).call(this),this._connected();const i=xn.fromReadableStream(e,this.controller);for await(const o of i)Z(this,Tt,"m",ah).call(this,o);if((s=i.controller.signal)!=null&&s.aborted)throw new Qt;Z(this,Tt,"m",uh).call(this)}[(qn=new WeakMap,Hl=new WeakMap,Ul=new WeakMap,Cs=new WeakMap,Ms=new WeakMap,$l=new WeakMap,As=new WeakMap,Pn=new WeakMap,Es=new WeakMap,Kl=new WeakMap,ql=new WeakMap,si=new WeakMap,oh=new WeakMap,Tt=new WeakSet,sh=function(){if(this.receivedMessages.length===0)throw new se("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},X0=function(){if(this.receivedMessages.length===0)throw new se("stream ended without producing a Message with role=assistant");const n=this.receivedMessages.at(-1).content.filter(r=>r.type==="text").map(r=>r.text);if(n.length===0)throw new se("stream ended without producing a content block with type=text");return n.join(" ")},lh=function(){this.ended||ut(this,qn,void 0,"f")},ah=function(n){if(this.ended)return;const r=Z(this,Tt,"m",Y0).call(this,n);switch(this._emit("streamEvent",n,r),n.type){case"content_block_delta":{const i=r.content.at(-1);n.delta.type==="text_delta"&&i.type==="text"?this._emit("text",n.delta.text,i.text||""):n.delta.type==="input_json_delta"&&i.type==="tool_use"&&i.input&&this._emit("inputJson",n.delta.partial_json,i.input);break}case"message_stop":{this._addMessageParam(r),this._addMessage(r,!0);break}case"content_block_stop":{this._emit("contentBlock",r.content.at(-1));break}case"message_start":{ut(this,qn,r,"f");break}}},uh=function(){if(this.ended)throw new se("stream has ended, this shouldn't happen");const n=Z(this,qn,"f");if(!n)throw new se("request ended without sending any chunks");return ut(this,qn,void 0,"f"),n},Y0=function(n){let r=Z(this,qn,"f");if(n.type==="message_start"){if(r)throw new se(`Unexpected event order, got ${n.type} before receiving "message_stop"`);return n.message}if(!r)throw new se(`Unexpected event order, got ${n.type} before "message_start"`);switch(n.type){case"message_stop":return r;case"message_delta":return r.stop_reason=n.delta.stop_reason,r.stop_sequence=n.delta.stop_sequence,r.usage.output_tokens=n.usage.output_tokens,r;case"content_block_start":return r.content.push(n.content_block),r;case"content_block_delta":{const i=r.content.at(n.index);if((i==null?void 0:i.type)==="text"&&n.delta.type==="text_delta")i.text+=n.delta.text;else if((i==null?void 0:i.type)==="tool_use"&&n.delta.type==="input_json_delta"){let s=i[Q0]||"";s+=n.delta.partial_json,Object.defineProperty(i,Q0,{value:s,enumerable:!1,writable:!0}),s&&(i.input=NS(s))}return r}case"content_block_stop":return r}},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("streamEvent",i=>{const s=n.shift();s?s.resolve(i):e.push(i)}),this.on("end",()=>{r=!0;for(const i of n)i.resolve(void 0);n.length=0}),this.on("abort",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),this.on("error",i=>{r=!0;for(const s of n)s.reject(i);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((s,o)=>n.push({resolve:s,reject:o})).then(s=>s?{value:s,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new xn(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class pu extends Xo{create(e,n){return e.model in J0&&console.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${J0[e.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages",{body:e,timeout:this._client._options.timeout??6e5,...n,stream:e.stream??!1})}stream(e,n){return du.createMessage(this,e,n)}}const J0={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024"};pu||(pu={});var LS;class me extends HO{constructor({baseURL:e=Zc("ANTHROPIC_BASE_URL"),apiKey:n=Zc("ANTHROPIC_API_KEY")??null,authToken:r=Zc("ANTHROPIC_AUTH_TOKEN")??null,...i}={}){const s={apiKey:n,authToken:r,...i,baseURL:e||"https://api.anthropic.com"};if(!s.dangerouslyAllowBrowser&&eR())throw new se(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new Anthropic({ apiKey, dangerouslyAllowBrowser: true });

TODO: link!
`);super({baseURL:s.baseURL,timeout:s.timeout??6e5,httpAgent:s.httpAgent,maxRetries:s.maxRetries,fetch:s.fetch}),this.completions=new fu(this),this.messages=new pu(this),this.beta=new hu(this),this._options=s,this.apiKey=n,this.authToken=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01",...this._options.defaultHeaders}}validateHeaders(e,n){if(!(this.apiKey&&e["x-api-key"])&&n["x-api-key"]!==null&&!(this.authToken&&e.authorization)&&n.authorization!==null)throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){const n=this.apiKeyAuth(e),r=this.bearerAuth(e);return n!=null&&!rd(n)?n:r!=null&&!rd(r)?r:{}}apiKeyAuth(e){return this.apiKey==null?{}:{"X-Api-Key":this.apiKey}}bearerAuth(e){return this.authToken==null?{}:{Authorization:`Bearer ${this.authToken}`}}}LS=me;me.Anthropic=LS;me.HUMAN_PROMPT=`

Human:`;me.AI_PROMPT=`

Assistant:`;me.DEFAULT_TIMEOUT=6e5;me.AnthropicError=se;me.APIError=Ye;me.APIConnectionError=qu;me.APIConnectionTimeoutError=CS;me.APIUserAbortError=Qt;me.NotFoundError=PS;me.ConflictError=DS;me.RateLimitError=OS;me.BadRequestError=MS;me.AuthenticationError=AS;me.InternalServerError=RS;me.PermissionDeniedError=ES;me.UnprocessableEntityError=TS;me.toFile=jO;me.fileFromPath=xS;const{HUMAN_PROMPT:MR,AI_PROMPT:AR}=me;(function(t){t.Completions=fu,t.Messages=pu,t.Beta=hu})(me||(me={}));const iR=`You are an expert WebGPU shader developer specializing in WGSL (WebGPU Shading Language).

Key WGSL Rules:
- WGSL has STRICT typing with NO implicit conversions
- All functions must have explicit return types
- Entry points must use @vertex, @fragment, or @compute attributes
- Bindings use @group(N) @binding(M) decorations
- Built-in values use @builtin() attribute
- Workgroup size for compute: @workgroup_size(X, Y, Z)

Common WGSL Functions:
- Math: sin, cos, tan, sqrt, pow, abs, floor, ceil, round, clamp, mix, smoothstep
- Vector: dot, cross, length, normalize, distance, reflect
- Texture: textureSample, textureLoad, textureDimensions
- No function overloading - functions must have unique names

Type Syntax:
- Scalars: f32, i32, u32, bool
- Vectors: vec2<f32>, vec3<f32>, vec4<f32>
- Matrices: mat2x2<f32>, mat3x3<f32>, mat4x4<f32>
- Arrays: array<f32, 10> or array<f32>

IMPORTANT: Always use f32 literals with decimal point (e.g., 1.0, not 1)`,sR=`
Example 1: Simple Triangle Vertex + Fragment Shader
\`\`\`wgsl
@vertex
fn vs_main(@builtin(vertex_index) vertexIndex: u32) -> @builtin(position) vec4<f32> {
    var pos = array<vec2<f32>, 3>(
        vec2<f32>(0.0, 0.5),
        vec2<f32>(-0.5, -0.5),
        vec2<f32>(0.5, -0.5)
    );
    return vec4<f32>(pos[vertexIndex], 0.0, 1.0);
}

@fragment
fn fs_main() -> @location(0) vec4<f32> {
    return vec4<f32>(1.0, 0.0, 0.0, 1.0); // Red
}
\`\`\`

Example 2: Shader with Uniforms
\`\`\`wgsl
struct Uniforms {
    time: f32,
    resolution: vec2<f32>,
}

@group(0) @binding(0) var<uniform> uniforms: Uniforms;

@fragment
fn fs_main(@builtin(position) fragCoord: vec4<f32>) -> @location(0) vec4<f32> {
    let uv = fragCoord.xy / uniforms.resolution;
    let col = 0.5 + 0.5 * cos(uniforms.time + uv.xyx + vec3<f32>(0.0, 2.0, 4.0));
    return vec4<f32>(col, 1.0);
}
\`\`\`

Example 3: Compute Shader
\`\`\`wgsl
@group(0) @binding(0) var<storage, read_write> data: array<f32>;

@compute @workgroup_size(256)
fn cs_main(@builtin(global_invocation_id) global_id: vec3<u32>) {
    let index = global_id.x;
    data[index] = data[index] * 2.0;
}
\`\`\``;function oR(){return`${iR}

${sR}

You are helping users create and iteratively refine WebGPU shaders through conversation.

When users request a shader:
1. Generate complete WGSL shader code in a \`\`\`wgsl code block
2. Provide a brief explanation of how it works
3. Include any JavaScript setup code needed (in a \`\`\`javascript block)

When users request refinements or modifications:
1. Understand what they want to change
2. Modify the existing shader accordingly
3. Provide the complete updated shader code
4. Explain what you changed and why

If a shader has validation errors:
- The user will share the error message with you
- Fix the issue and provide the corrected shader
- Explain what was wrong and how you fixed it

Available uniforms (automatically provided):
- time: f32 - current time in seconds
- resolution: vec2<f32> - canvas resolution (width, height)

You can add custom uniforms to the Uniforms struct for user-controllable parameters:
- The UI will automatically detect and create sliders for custom uniform fields
- Good examples: rows, columns, speed, scale, radius, intensity, etc.
- Users can adjust these values in real-time via the UI

Default context:
- A full-screen triangle vertex shader is provided automatically
- You typically only need to write fragment shaders
- Fragment shaders receive @builtin(position) fragCoord which is screen coordinates

Remember:
- Use explicit f32 types (1.0 not 1)
- No implicit type conversions
- Always provide complete, working shader code
- Be conversational and helpful in your explanations`}const BS="shaderlm_api_key",lR=365;function aR(t,e,n){const r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);const i=`expires=${r.toUTCString()}`;document.cookie=`${t}=${e};${i};path=/;SameSite=Strict`}function uR(t){const e=`${t}=`,n=document.cookie.split(";");for(let r of n){let i=r.trim();if(i.indexOf(e)===0)return i.substring(e.length)}return null}function id(){return uR(BS)}function cR(t){aR(BS,t,lR)}let _S;function IS(t){const e=t||id();if(!e)throw new Error("No API key available. Please set your Claude API key.");_S=new me({apiKey:e,dangerouslyAllowBrowser:!0})}function hR(t){IS(t)}async function fR(t){try{return await new me({apiKey:t,dangerouslyAllowBrowser:!0}).messages.create({model:"claude-sonnet-4-20250514",max_tokens:10,messages:[{role:"user",content:"Hi"}]}),{valid:!0}}catch(e){return console.error("API key validation failed:",e),e instanceof Error?{valid:!1,error:e.message}:{valid:!1,error:"Unknown error occurred"}}}try{IS()}catch{console.warn("Claude client not initialized - API key required")}async function*dR(t,e){try{const n=await _S.messages.create({model:"claude-sonnet-4-20250514",max_tokens:4e3,system:t,messages:e,stream:!0});for await(const r of n)r.type==="content_block_delta"&&r.delta.type==="text_delta"&&(yield r.delta.text)}catch(n){throw console.error("Error in conversational shader generation:",n),new Error(`Failed to generate shader: ${n instanceof Error?n.message:"Unknown error"}`)}}function pR({isOpen:t,onClose:e,allowCancel:n=!1}){const[r,i]=W.useState(""),[s,o]=W.useState(!1),[l,a]=W.useState(null),u=async()=>{if(!r.trim()){a("Please enter an API key");return}o(!0),a(null);try{const f=await fR(r.trim());f.valid?(cR(r.trim()),hR(r.trim()),i(""),e()):a(f.error||"Invalid API key. Please check and try again.")}catch(f){a("Failed to validate API key. Please try again."),console.error("API key validation error:",f)}finally{o(!1)}},c=()=>{n&&(i(""),a(null),e())},h=f=>{f.key==="Enter"&&!s&&u()};return t?S.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:S.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[S.jsxs("div",{className:"mb-4",children:[S.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Enter Claude API Key"}),S.jsxs("p",{className:"text-gray-400 text-sm",children:["Your API key will be stored securely in your browser cookies. Get your key from"," ",S.jsx("a",{href:"https://console.anthropic.com/settings/keys",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 underline",children:"Anthropic Console"}),"."]})]}),S.jsxs("div",{className:"mb-4",children:[S.jsx("label",{htmlFor:"apiKey",className:"block text-sm font-medium text-gray-300 mb-2",children:"API Key"}),S.jsx("input",{id:"apiKey",type:"password",value:r,onChange:f=>i(f.target.value),onKeyPress:h,placeholder:"sk-ant-...",disabled:s,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed"})]}),l&&S.jsx("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-700 rounded-md",children:S.jsx("p",{className:"text-red-200 text-sm",children:l})}),S.jsxs("div",{className:"flex justify-end gap-3",children:[n&&S.jsx("button",{onClick:c,disabled:s,className:"px-4 py-2 bg-gray-700 text-white rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Cancel"}),S.jsx("button",{onClick:u,disabled:s||!r.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:s?S.jsxs(S.Fragment,{children:[S.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[S.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),S.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),S.jsx("span",{children:"Validating..."})]}):"Save"})]})]})}):null}async function mR(t){const e=t.match(/```wgsl\n([\s\S]*?)```/),n=e?e[1].trim():"",r=t.replace(/```[\s\S]*?```/g,"").trim();if(!n)return{shader:"",isValid:!1,error:"No shader code found in response",explanation:r};const i=await WC(n);return{shader:n,isValid:i.success,error:i.error,explanation:r}}function gR(){const{currentShader:t,vertexShader:e,isGenerating:n,messages:r,setCurrentShader:i,setVertexShader:s,setIsGenerating:o,setError:l,addMessage:a,updateLastMessage:u,loadFromStorage:c,clearConversation:h}=x1(),[f,d]=W.useState({}),[p,y]=W.useState(!1),[w,m]=W.useState(),[g,v]=W.useState(),[x,k]=W.useState(!1),[b,C]=W.useState(()=>{const U=localStorage.getItem("chatWidth");return U?parseInt(U,10):384}),[E,O]=W.useState(()=>{const U=localStorage.getItem("editorWidth");return U?parseInt(U,10):500});W.useEffect(()=>{id()||k(!0)},[]),W.useEffect(()=>{c()},[c]),W.useEffect(()=>{localStorage.setItem("chatWidth",b.toString())},[b]),W.useEffect(()=>{localStorage.setItem("editorWidth",E.toString())},[E]),W.useEffect(()=>{Hm().supported||l("WebGPU is not supported in your browser")},[l]);const N=W.useCallback(U=>{h(),i(U.shader),U.vertexShader&&s(U.vertexShader),U.messages.forEach(X=>{a({role:X.role,content:X.content,metadata:X.metadata})}),U.customUniforms&&d(U.customUniforms),m(U.id),v(U.name)},[h,i,s,a]),V=()=>{t&&!window.confirm("Starting a new project will clear the current conversation. Are you sure?")||(h(),m(void 0),v(void 0),d({}))},j=U=>{C(X=>Math.max(250,Math.min(800,X+U)))},D=U=>{O(X=>Math.max(300,Math.min(1e3,X+U)))},H=async U=>{var X;a({role:"user",content:U}),o(!0),l(null);try{const T=[...r.filter(q=>q.role!=="system").map(q=>({role:q.role,content:q.content})),{role:"user",content:U}],L=oR();a({role:"assistant",content:""});let z="";for await(const q of dR(L,T))z+=q,u(z);const K=await mR(z);K.shader&&(i(K.shader,(X=r[r.length-1])==null?void 0:X.id),!K.isValid&&K.error&&a({role:"system",content:`Validation Error: ${K.error}`,metadata:{validationError:K.error}}))}catch(T){const L=T instanceof Error?T.message:"Unknown error";l(L),a({role:"system",content:`Error: ${L}`})}finally{o(!1)}};return Hm().supported?S.jsxs("div",{className:"h-screen flex flex-col bg-gray-900 text-white",children:[S.jsx("header",{className:"bg-gray-800 border-b border-gray-700 p-4",children:S.jsxs("div",{className:"flex items-center justify-between",children:[S.jsxs("div",{children:[S.jsx("h1",{className:"text-2xl font-bold",children:"WebGPU Shader Generator"}),S.jsxs("p",{className:"text-sm text-gray-400",children:["AI-powered iterative WGSL shader creation",g&&S.jsxs("span",{className:"ml-2 text-blue-400",children:[" ",g]})]})]}),S.jsxs("div",{className:"flex gap-2",children:[S.jsx("button",{onClick:V,className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded text-sm font-medium transition-colors",title:"New Project",children:S.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),S.jsxs("button",{onClick:()=>y(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded text-sm font-medium transition-colors flex items-center gap-2",children:[S.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"})}),"Projects"]})]})]})}),S.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[S.jsx("div",{style:{width:`${b}px`},className:"flex-shrink-0 flex flex-col",children:S.jsx(QC,{onSendMessage:H,onOpenApiKeyDialog:()=>k(!0)})}),S.jsx(F0,{onResize:j}),S.jsx("div",{style:{width:`${E}px`},className:"flex-shrink-0 flex flex-col",children:S.jsx(gO,{shader:t,onChange:i,readOnly:n})}),S.jsx(F0,{onResize:D}),S.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[S.jsx(vO,{shader:t,onValuesChange:d}),S.jsx("div",{className:"flex-1 p-4 overflow-hidden",children:S.jsx("div",{className:"h-full bg-black rounded-lg overflow-hidden",children:S.jsx(yO,{shader:t,vertexShader:e,customUniforms:f})})})]})]}),S.jsx("footer",{className:"bg-gray-800 border-t border-gray-700 p-2 text-center text-xs text-gray-400",children:"Powered by Claude & WebGPU | Chat to iteratively refine your shader"}),S.jsx(EO,{isOpen:p,onClose:()=>y(!1),currentShader:t,currentVertexShader:e,currentMessages:r,currentUniforms:f,onLoadProject:N,currentProjectId:w}),S.jsx(pR,{isOpen:x,onClose:()=>k(!1),allowCancel:id()!==null})]}):S.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-900",children:S.jsxs("div",{className:"text-center p-8 bg-red-900/20 border border-red-500 rounded-lg max-w-md",children:[S.jsx("h1",{className:"text-2xl font-bold text-red-400 mb-4",children:"WebGPU Not Supported"}),S.jsx("p",{className:"text-gray-300",children:"Your browser doesn't support WebGPU. Please use Chrome 113+ or Edge 113+."})]})})}ch.createRoot(document.getElementById("root")).render(S.jsx(cy.StrictMode,{children:S.jsx(gR,{})}));
